<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Vowpal Wabbit: memory_tree_ns Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Vowpal Wabbit
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="https://github.com/JohnLangford/vowpal_wabbit/wiki"><span>Wiki</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">memory_tree_ns Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmemory__tree__ns_1_1node.html">node</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a14ff4f5be3189ba9833680815e243e9d"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a14ff4f5be3189ba9833680815e243e9d"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a14ff4f5be3189ba9833680815e243e9d">remove_at_index</a> (<a class="el" href="structv__array.html">v_array</a>&lt; T &gt; &amp;array, uint32_t index)</td></tr>
<tr class="separator:a14ff4f5be3189ba9833680815e243e9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e027e17860523e102f53e45d72ef302"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a0e027e17860523e102f53e45d72ef302">copy_example_data</a> (<a class="el" href="structexample.html">example</a> *dst, <a class="el" href="structexample.html">example</a> *src, bool oas=false)</td></tr>
<tr class="separator:a0e027e17860523e102f53e45d72ef302"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aa2fcb487cc8b75082470c1d4cf5697"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a1aa2fcb487cc8b75082470c1d4cf5697">free_example</a> (<a class="el" href="structexample.html">example</a> *ec)</td></tr>
<tr class="separator:a1aa2fcb487cc8b75082470c1d4cf5697"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa049a08b1b6161f43c86793e1f674821"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#aa049a08b1b6161f43c86793e1f674821">diag_kronecker_prod_fs_test</a> (<a class="el" href="structfeatures.html">features</a> &amp;f1, <a class="el" href="structfeatures.html">features</a> &amp;f2, <a class="el" href="structfeatures.html">features</a> &amp;prod_f, float &amp;total_sum_feat_sq, float norm_sq1, float norm_sq2)</td></tr>
<tr class="separator:aa049a08b1b6161f43c86793e1f674821"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4f682d65380d554ba2d52afc581d4a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#ae4f682d65380d554ba2d52afc581d4a7">cmpfunc</a> (const void *<a class="el" href="rand48_8cc.html#a591b56c87cb459191199d0ed6e4f5b9b">a</a>, const void *b)</td></tr>
<tr class="separator:ae4f682d65380d554ba2d52afc581d4a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad57d1c053bf5098292a4820b8f4af607"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#ad57d1c053bf5098292a4820b8f4af607">diag_kronecker_product_test</a> (<a class="el" href="structexample.html">example</a> &amp;ec1, <a class="el" href="structexample.html">example</a> &amp;ec2, <a class="el" href="structexample.html">example</a> &amp;ec, bool oas=false)</td></tr>
<tr class="separator:ad57d1c053bf5098292a4820b8f4af607"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a2e3abcc2803897c578669f3dab7329"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a7a2e3abcc2803897c578669f3dab7329">linear_kernel</a> (const <a class="el" href="structflat__example.html">flat_example</a> *fec1, const <a class="el" href="structflat__example.html">flat_example</a> *fec2)</td></tr>
<tr class="separator:a7a2e3abcc2803897c578669f3dab7329"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30cdcc95dfc069080971ca5fc83cc40b"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a30cdcc95dfc069080971ca5fc83cc40b">normalized_linear_prod</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, <a class="el" href="structexample.html">example</a> *ec1, <a class="el" href="structexample.html">example</a> *ec2)</td></tr>
<tr class="separator:a30cdcc95dfc069080971ca5fc83cc40b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a425ef2e5402c64f2813699f9c239d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a1a425ef2e5402c64f2813699f9c239d9">init_tree</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b)</td></tr>
<tr class="separator:a1a425ef2e5402c64f2813699f9c239d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa544f428dd64b385a63b962e9b1ed2a8"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#aa544f428dd64b385a63b962e9b1ed2a8">insert_descent</a> (<a class="el" href="structmemory__tree__ns_1_1node.html">node</a> &amp;n, const float prediction)</td></tr>
<tr class="separator:aa544f428dd64b385a63b962e9b1ed2a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4ce818bfbbc0ffeddea9fb7baa64f0d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#af4ce818bfbbc0ffeddea9fb7baa64f0d">random_sample_example_pop</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, uint64_t &amp;cn)</td></tr>
<tr class="separator:af4ce818bfbbc0ffeddea9fb7baa64f0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a393a4fb5d4ccfcdfb78af85c6cb79bc7"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a393a4fb5d4ccfcdfb78af85c6cb79bc7">train_node</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, <a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;base, <a class="el" href="structexample.html">example</a> &amp;ec, const uint64_t cn)</td></tr>
<tr class="separator:a393a4fb5d4ccfcdfb78af85c6cb79bc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86e4abca95dc1304004eac3b4648bd05"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a86e4abca95dc1304004eac3b4648bd05">split_leaf</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, <a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;base, const uint64_t cn)</td></tr>
<tr class="separator:a86e4abca95dc1304004eac3b4648bd05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87ff00a851488f590d4336b3d83f5e2e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a87ff00a851488f590d4336b3d83f5e2e">compare_label</a> (const void *<a class="el" href="rand48_8cc.html#a591b56c87cb459191199d0ed6e4f5b9b">a</a>, const void *b)</td></tr>
<tr class="separator:a87ff00a851488f590d4336b3d83f5e2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ba1ca9f54ed8baf4526e282d05bd149"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a9ba1ca9f54ed8baf4526e282d05bd149">over_lap</a> (<a class="el" href="structv__array.html">v_array</a>&lt; uint32_t &gt; &amp;array_1, <a class="el" href="structv__array.html">v_array</a>&lt; uint32_t &gt; &amp;array_2)</td></tr>
<tr class="separator:a9ba1ca9f54ed8baf4526e282d05bd149"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac9cb969cdb5e18468bb5f384ec80922"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#aac9cb969cdb5e18468bb5f384ec80922">hamming_loss</a> (<a class="el" href="structv__array.html">v_array</a>&lt; uint32_t &gt; &amp;array_1, <a class="el" href="structv__array.html">v_array</a>&lt; uint32_t &gt; &amp;array_2)</td></tr>
<tr class="separator:aac9cb969cdb5e18468bb5f384ec80922"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bcd8088fe4370c98134f0171a3bdc4d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a5bcd8088fe4370c98134f0171a3bdc4d">collect_labels_from_leaf</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, const uint64_t cn, <a class="el" href="structv__array.html">v_array</a>&lt; uint32_t &gt; &amp;leaf_labs)</td></tr>
<tr class="separator:a5bcd8088fe4370c98134f0171a3bdc4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27aad0e7fea7b74c8efa7961a6fd5a17"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a27aad0e7fea7b74c8efa7961a6fd5a17">train_one_against_some_at_leaf</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, <a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;base, const uint64_t cn, <a class="el" href="structexample.html">example</a> &amp;ec)</td></tr>
<tr class="separator:a27aad0e7fea7b74c8efa7961a6fd5a17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a4a4185acca6cca507e1461a06c45e1"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a4a4a4185acca6cca507e1461a06c45e1">compute_hamming_loss_via_oas</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, <a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;base, const uint64_t cn, <a class="el" href="structexample.html">example</a> &amp;ec, <a class="el" href="structv__array.html">v_array</a>&lt; uint32_t &gt; &amp;selected_labs)</td></tr>
<tr class="separator:a4a4a4185acca6cca507e1461a06c45e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8574c94638d3b4386ba0be942703575b"><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a8574c94638d3b4386ba0be942703575b">pick_nearest</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, <a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;base, const uint64_t cn, <a class="el" href="structexample.html">example</a> &amp;ec)</td></tr>
<tr class="separator:a8574c94638d3b4386ba0be942703575b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebeb62a432be8c48839c914334059a44"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#aebeb62a432be8c48839c914334059a44">get_overlap_from_two_examples</a> (<a class="el" href="structexample.html">example</a> &amp;ec1, <a class="el" href="structexample.html">example</a> &amp;ec2)</td></tr>
<tr class="separator:aebeb62a432be8c48839c914334059a44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad0642fc7ad41fc1bff3db10f6c7695c"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#aad0642fc7ad41fc1bff3db10f6c7695c">F1_score_for_two_examples</a> (<a class="el" href="structexample.html">example</a> &amp;ec1, <a class="el" href="structexample.html">example</a> &amp;ec2)</td></tr>
<tr class="separator:aad0642fc7ad41fc1bff3db10f6c7695c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9660af68688f6d780599a8237cd1b2a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a9660af68688f6d780599a8237cd1b2a8">predict</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, <a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;base, <a class="el" href="structexample.html">example</a> &amp;ec)</td></tr>
<tr class="separator:a9660af68688f6d780599a8237cd1b2a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37334ee454f980c3f87ad853ecb61413"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a37334ee454f980c3f87ad853ecb61413">return_reward_from_node</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, <a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;base, uint64_t cn, <a class="el" href="structexample.html">example</a> &amp;ec, float <a class="el" href="array__parameters__dense_8h.html#a4d04a2043fa7480d905108e63adb0bab">weight</a>=1.<a class="el" href="cache_8cc.html#af900396d7b72ff2a7002e8befe8cf8f1">f</a>)</td></tr>
<tr class="separator:a37334ee454f980c3f87ad853ecb61413"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a049fec021123c5ddfc9989582c24fa6e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a049fec021123c5ddfc9989582c24fa6e">learn_at_leaf_random</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, <a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;base, const uint64_t &amp;leaf_id, <a class="el" href="structexample.html">example</a> &amp;ec, const float &amp;<a class="el" href="array__parameters__dense_8h.html#a4d04a2043fa7480d905108e63adb0bab">weight</a>)</td></tr>
<tr class="separator:a049fec021123c5ddfc9989582c24fa6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28b68857ebf69c2e6cf472da206808ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a28b68857ebf69c2e6cf472da206808ca">route_to_leaf</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, <a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;base, const uint32_t &amp;ec_array_index, uint64_t cn, <a class="el" href="structv__array.html">v_array</a>&lt; uint64_t &gt; &amp;path, bool insertion)</td></tr>
<tr class="separator:a28b68857ebf69c2e6cf472da206808ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2765df994178ef7801e1b4b111884f14"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a2765df994178ef7801e1b4b111884f14">single_query_and_learn</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, <a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;base, const uint32_t &amp;ec_array_index, <a class="el" href="structexample.html">example</a> &amp;ec)</td></tr>
<tr class="separator:a2765df994178ef7801e1b4b111884f14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ab3b6859145c6e6dd81a902ccd05aad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a4ab3b6859145c6e6dd81a902ccd05aad">update_rew</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, <a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;base, const uint32_t &amp;ec_array_index, <a class="el" href="structexample.html">example</a> &amp;ec)</td></tr>
<tr class="separator:a4ab3b6859145c6e6dd81a902ccd05aad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa88d570e4879925f6a4ec8a31a5cea9a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#aa88d570e4879925f6a4ec8a31a5cea9a">insert_example</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, <a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;base, const uint32_t &amp;ec_array_index, bool fake_insert=false)</td></tr>
<tr class="separator:aa88d570e4879925f6a4ec8a31a5cea9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accdf4e058c8cf7b7b5deaf0935d34e3f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#accdf4e058c8cf7b7b5deaf0935d34e3f">experience_replay</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, <a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;base)</td></tr>
<tr class="separator:accdf4e058c8cf7b7b5deaf0935d34e3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03d2e3881caed7ba0a4721dc7b559dcb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a03d2e3881caed7ba0a4721dc7b559dcb">learn</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, <a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;base, <a class="el" href="structexample.html">example</a> &amp;ec)</td></tr>
<tr class="separator:a03d2e3881caed7ba0a4721dc7b559dcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a977e0a3fbd321817942f7d9e255c6a7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a977e0a3fbd321817942f7d9e255c6a7e">end_pass</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b)</td></tr>
<tr class="separator:a977e0a3fbd321817942f7d9e255c6a7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceee1ab2c3c2184c26d2b287edce1bcb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#aceee1ab2c3c2184c26d2b287edce1bcb">save_load_example</a> (<a class="el" href="structexample.html">example</a> *ec, <a class="el" href="classio__buf.html">io_buf</a> &amp;model_file, bool &amp;read, bool &amp;text, std::stringstream &amp;msg, bool &amp;oas)</td></tr>
<tr class="separator:aceee1ab2c3c2184c26d2b287edce1bcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8c15e175eed413d25967aa1021e594c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#ab8c15e175eed413d25967aa1021e594c">save_load_node</a> (<a class="el" href="structmemory__tree__ns_1_1node.html">node</a> &amp;cn, <a class="el" href="classio__buf.html">io_buf</a> &amp;model_file, bool &amp;read, bool &amp;text, std::stringstream &amp;msg)</td></tr>
<tr class="separator:ab8c15e175eed413d25967aa1021e594c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18c2c3b4cf88e6ad4d9addceb244115a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacememory__tree__ns.html#a18c2c3b4cf88e6ad4d9addceb244115a">save_load_memory_tree</a> (<a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;b, <a class="el" href="classio__buf.html">io_buf</a> &amp;model_file, bool read, bool text)</td></tr>
<tr class="separator:a18c2c3b4cf88e6ad4d9addceb244115a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ae4f682d65380d554ba2d52afc581d4a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int memory_tree_ns::cmpfunc </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00103">103</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00105">diag_kronecker_product_test()</a>.</p>
<div class="fragment"><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;{ <span class="keywordflow">return</span> *(<span class="keywordtype">char</span>*)<a class="code" href="rand48_8cc.html#a591b56c87cb459191199d0ed6e4f5b9b">a</a> - *(<span class="keywordtype">char</span>*)b; }</div><div class="ttc" id="rand48_8cc_html_a591b56c87cb459191199d0ed6e4f5b9b"><div class="ttname"><a href="rand48_8cc.html#a591b56c87cb459191199d0ed6e4f5b9b">a</a></div><div class="ttdeci">constexpr uint64_t a</div><div class="ttdef"><b>Definition:</b> <a href="rand48_8cc_source.html#l00015">rand48.cc:15</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5bcd8088fe4370c98134f0171a3bdc4d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::collect_labels_from_leaf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>cn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structv__array.html">v_array</a>&lt; uint32_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>leaf_labs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00559">559</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="v__array_8h_source.html#l00086">v_array&lt; T &gt;::clear()</a>, <a class="el" href="memory__tree_8cc_source.html#l00181">memory_tree_ns::memory_tree::examples</a>, <a class="el" href="memory__tree_8cc_source.html#l00180">memory_tree_ns::memory_tree::nodes</a>, <a class="el" href="v__array_8h_source.html#l00105">v_array&lt; T &gt;::push_back()</a>, <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>, and <a class="el" href="v__array_8h_source.html#l00244">v_array_contains()</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00594">compute_hamming_loss_via_oas()</a>, and <a class="el" href="memory__tree_8cc_source.html#l00576">train_one_against_some_at_leaf()</a>.</p>
<div class="fragment"><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;{</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].internal != -1)</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;something is wrong, it should be a leaf node&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  leaf_labs.<a class="code" href="structv__array.html#aab10f7f1ac8ad24a8dc0b112fed415ef">clear</a>();</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>(); i++)</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  {  <span class="comment">// scan through each memory in the leaf</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    uint32_t loc = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index[i];</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">for</span> (uint32_t lab : b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[loc]-&gt;l.multilabels.label_v)</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    {  <span class="comment">// scan through each label:</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="v__array_8h.html#a37ba1a7ee0f3f63f82e152532b9d3353">v_array_contains</a>(leaf_labs, lab) == <span class="keyword">false</span>)</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        leaf_labs.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(lab);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    }</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  }</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;}</div><div class="ttc" id="structv__array_html_afd6a4614f027ac5f786507552ce13f13"><div class="ttname"><a href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">v_array::push_back</a></div><div class="ttdeci">void push_back(const T &amp;new_ele)</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00105">v_array.h:105</a></div></div>
<div class="ttc" id="structv__array_html_aab10f7f1ac8ad24a8dc0b112fed415ef"><div class="ttname"><a href="structv__array.html#aab10f7f1ac8ad24a8dc0b112fed415ef">v_array::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00086">v_array.h:86</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a6f1e18de5dec701d3cbe87ef47204640"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">memory_tree_ns::memory_tree::nodes</a></div><div class="ttdeci">v_array&lt; node &gt; nodes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00180">memory_tree.cc:180</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a80ed4155bf29ce66809ab34e364c74b8"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">memory_tree_ns::memory_tree::examples</a></div><div class="ttdeci">v_array&lt; example * &gt; examples</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00181">memory_tree.cc:181</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
<div class="ttc" id="v__array_8h_html_a37ba1a7ee0f3f63f82e152532b9d3353"><div class="ttname"><a href="v__array_8h.html#a37ba1a7ee0f3f63f82e152532b9d3353">v_array_contains</a></div><div class="ttdeci">bool v_array_contains(v_array&lt; T &gt; &amp;A, T x)</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00244">v_array.h:244</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a87ff00a851488f590d4336b3d83f5e2e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int memory_tree_ns::compare_label </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00523">523</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00525">over_lap()</a>.</p>
<div class="fragment"><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;{ <span class="keywordflow">return</span> *(uint32_t*)<a class="code" href="rand48_8cc.html#a591b56c87cb459191199d0ed6e4f5b9b">a</a> - *(uint32_t*)b; }</div><div class="ttc" id="rand48_8cc_html_a591b56c87cb459191199d0ed6e4f5b9b"><div class="ttname"><a href="rand48_8cc.html#a591b56c87cb459191199d0ed6e4f5b9b">a</a></div><div class="ttdeci">constexpr uint64_t a</div><div class="ttdef"><b>Definition:</b> <a href="rand48_8cc_source.html#l00015">rand48.cc:15</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4a4a4185acca6cca507e1461a06c45e1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t memory_tree_ns::compute_hamming_loss_via_oas </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>cn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> &amp;&#160;</td>
          <td class="paramname"><em>ec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structv__array.html">v_array</a>&lt; uint32_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>selected_labs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00594">594</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00559">collect_labels_from_leaf()</a>, <a class="el" href="v__array_8h_source.html#l00096">v_array&lt; T &gt;::delete_v()</a>, <a class="el" href="memory__tree_8cc_source.html#l00553">hamming_loss()</a>, <a class="el" href="example_8h_source.html#l00058">example::l</a>, <a class="el" href="multilabel_8h_source.html#l00014">MULTILABEL::labels::label_v</a>, <a class="el" href="memory__tree_8cc_source.html#l00186">memory_tree_ns::memory_tree::max_routers</a>, <a class="el" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>, <a class="el" href="example_8h_source.html#l00034">polylabel::multilabels</a>, <a class="el" href="example_8h_source.html#l00050">polyprediction::multilabels</a>, <a class="el" href="example_8h_source.html#l00061">example::pred</a>, <a class="el" href="learner_8h_source.html#l00165">LEARNER::learner&lt; T, E &gt;::predict()</a>, <a class="el" href="v__array_8h_source.html#l00105">v_array&lt; T &gt;::push_back()</a>, <a class="el" href="example_8h_source.html#l00045">polyprediction::scalar</a>, <a class="el" href="example_8h_source.html#l00027">polylabel::simple</a>, and <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00672">predict()</a>.</p>
<div class="fragment"><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;{</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  selected_labs.<a class="code" href="structv__array.html#a81c7c9af1948bd97850eb06785f2254f">delete_v</a>();</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <a class="code" href="structv__array.html">v_array&lt;uint32_t&gt;</a> leaf_labs = v_init&lt;uint32_t&gt;();</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <a class="code" href="namespacememory__tree__ns.html#a5bcd8088fe4370c98134f0171a3bdc4d">collect_labels_from_leaf</a>(b, cn, leaf_labs);  <span class="comment">// unique labels stored in the leaf.</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <a class="code" href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a> <a class="code" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a> = ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <a class="code" href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a> preds = ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">multilabels</a>;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">simple</a> = {FLT_MAX, 1.f, 0.f};</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; leaf_labs.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>(); i++)</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  {</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    base.<a class="code" href="structLEARNER_1_1learner.html#a8b4f75763c0ec9a26eb5255780e782a8">predict</a>(ec, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aee12725de055582f62c270a2d5b4d7b3">max_routers</a> + 1 + leaf_labs[i]);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordtype">float</span> score = ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#ae29f42559acac5a2b08322a7fe887f04">scalar</a>;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">if</span> (score &gt; 0)</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      selected_labs.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(leaf_labs[i]);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  }</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">multilabels</a> = preds;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a> = <a class="code" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacememory__tree__ns.html#aac9cb969cdb5e18468bb5f384ec80922">hamming_loss</a>(ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>.<a class="code" href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">label_v</a>, selected_labs);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;}</div><div class="ttc" id="structLEARNER_1_1learner_html_a8b4f75763c0ec9a26eb5255780e782a8"><div class="ttname"><a href="structLEARNER_1_1learner.html#a8b4f75763c0ec9a26eb5255780e782a8">LEARNER::learner::predict</a></div><div class="ttdeci">void predict(E &amp;ec, size_t i=0)</div><div class="ttdef"><b>Definition:</b> <a href="learner_8h_source.html#l00165">learner.h:165</a></div></div>
<div class="ttc" id="unionpolyprediction_html_ae29f42559acac5a2b08322a7fe887f04"><div class="ttname"><a href="unionpolyprediction.html#ae29f42559acac5a2b08322a7fe887f04">polyprediction::scalar</a></div><div class="ttdeci">float scalar</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00045">example.h:45</a></div></div>
<div class="ttc" id="learner_8h_html_a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2"><div class="ttname"><a href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">prediction_type_t::multilabels</a></div></div>
<div class="ttc" id="unionpolylabel_html_a80ff268cb4e29afddaac58174d316297"><div class="ttname"><a href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">polylabel::simple</a></div><div class="ttdeci">label_data simple</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00027">example.h:27</a></div></div>
<div class="ttc" id="structMULTILABEL_1_1labels_html"><div class="ttname"><a href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a></div><div class="ttdef"><b>Definition:</b> <a href="multilabel_8h_source.html#l00012">multilabel.h:12</a></div></div>
<div class="ttc" id="structv__array_html_afd6a4614f027ac5f786507552ce13f13"><div class="ttname"><a href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">v_array::push_back</a></div><div class="ttdeci">void push_back(const T &amp;new_ele)</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00105">v_array.h:105</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a5bcd8088fe4370c98134f0171a3bdc4d"><div class="ttname"><a href="namespacememory__tree__ns.html#a5bcd8088fe4370c98134f0171a3bdc4d">memory_tree_ns::collect_labels_from_leaf</a></div><div class="ttdeci">void collect_labels_from_leaf(memory_tree &amp;b, const uint64_t cn, v_array&lt; uint32_t &gt; &amp;leaf_labs)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00559">memory_tree.cc:559</a></div></div>
<div class="ttc" id="structexample_html_a0c87f6e82d9c95ae42158bdbdab3acf5"><div class="ttname"><a href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">example::l</a></div><div class="ttdeci">polylabel l</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00058">example.h:58</a></div></div>
<div class="ttc" id="unionpolyprediction_html_a9f6a01eabbe81af8ec89f7af7ff5de3c"><div class="ttname"><a href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">polyprediction::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00050">example.h:50</a></div></div>
<div class="ttc" id="unionpolylabel_html_a999dc75a1e71967c36a817cead6bf3b2"><div class="ttname"><a href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">polylabel::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00034">example.h:34</a></div></div>
<div class="ttc" id="structMULTILABEL_1_1labels_html_ae9b968050adb2459463cffec3b4c38c4"><div class="ttname"><a href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">MULTILABEL::labels::label_v</a></div><div class="ttdeci">v_array&lt; uint32_t &gt; label_v</div><div class="ttdef"><b>Definition:</b> <a href="multilabel_8h_source.html#l00014">multilabel.h:14</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
<div class="ttc" id="structexample_html_ad1477e890371ed8253f1953d4190ba49"><div class="ttname"><a href="structexample.html#ad1477e890371ed8253f1953d4190ba49">example::pred</a></div><div class="ttdeci">polyprediction pred</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00061">example.h:61</a></div></div>
<div class="ttc" id="structv__array_html_a81c7c9af1948bd97850eb06785f2254f"><div class="ttname"><a href="structv__array.html#a81c7c9af1948bd97850eb06785f2254f">v_array::delete_v</a></div><div class="ttdeci">void delete_v()</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00096">v_array.h:96</a></div></div>
<div class="ttc" id="structv__array_html"><div class="ttname"><a href="structv__array.html">v_array&lt; uint32_t &gt;</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_aee12725de055582f62c270a2d5b4d7b3"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#aee12725de055582f62c270a2d5b4d7b3">memory_tree_ns::memory_tree::max_routers</a></div><div class="ttdeci">size_t max_routers</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00186">memory_tree.cc:186</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_aac9cb969cdb5e18468bb5f384ec80922"><div class="ttname"><a href="namespacememory__tree__ns.html#aac9cb969cdb5e18468bb5f384ec80922">memory_tree_ns::hamming_loss</a></div><div class="ttdeci">uint32_t hamming_loss(v_array&lt; uint32_t &gt; &amp;array_1, v_array&lt; uint32_t &gt; &amp;array_2)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00553">memory_tree.cc:553</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0e027e17860523e102f53e45d72ef302"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::copy_example_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>oas</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00047">47</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="v__array_8h_source.html#l00192">copy_array()</a>, <a class="el" href="example_8cc_source.html#l00069">VW::copy_example_data()</a>, <a class="el" href="v__array_8h_source.html#l00096">v_array&lt; T &gt;::delete_v()</a>, <a class="el" href="example_8h_source.html#l00058">example::l</a>, <a class="el" href="multiclass_8h_source.html#l00014">MULTICLASS::label_t::label</a>, <a class="el" href="multilabel_8h_source.html#l00014">MULTILABEL::labels::label_v</a>, <a class="el" href="example_8h_source.html#l00028">polylabel::multi</a>, and <a class="el" href="example_8h_source.html#l00034">polylabel::multilabels</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00105">diag_kronecker_product_test()</a>, and <a class="el" href="memory__tree_8cc_source.html#l01026">learn()</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordflow">if</span> (oas == <span class="keyword">false</span>)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    dst-&gt;<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a> = src-&gt;<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    dst-&gt;<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">multi</a>.<a class="code" href="structMULTICLASS_1_1label__t.html#aa8b080653e3c08b5363152009728453d">label</a> = src-&gt;<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">multi</a>.<a class="code" href="structMULTICLASS_1_1label__t.html#aa8b080653e3c08b5363152009728453d">label</a>;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  }</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  {</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    dst-&gt;<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>.<a class="code" href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">label_v</a>.<a class="code" href="structv__array.html#a81c7c9af1948bd97850eb06785f2254f">delete_v</a>();</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="v__array_8h.html#a986101d711024ed1e3f4f3f07d3d046c">copy_array</a>(dst-&gt;<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>.<a class="code" href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">label_v</a>, src-&gt;<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>.<a class="code" href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">label_v</a>);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="code" href="namespaceVW.html#a1b54ce218ed0b27cbedfc3fd0a87c14c">VW::copy_example_data</a>(<span class="keyword">false</span>, dst, src);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;}</div><div class="ttc" id="namespaceVW_html_a1b54ce218ed0b27cbedfc3fd0a87c14c"><div class="ttname"><a href="namespaceVW.html#a1b54ce218ed0b27cbedfc3fd0a87c14c">VW::copy_example_data</a></div><div class="ttdeci">void copy_example_data(bool audit, example *dst, example *src)</div><div class="ttdef"><b>Definition:</b> <a href="example_8cc_source.html#l00069">example.cc:69</a></div></div>
<div class="ttc" id="v__array_8h_html_a986101d711024ed1e3f4f3f07d3d046c"><div class="ttname"><a href="v__array_8h.html#a986101d711024ed1e3f4f3f07d3d046c">copy_array</a></div><div class="ttdeci">void copy_array(v_array&lt; T &gt; &amp;dst, const v_array&lt; T &gt; &amp;src)</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00192">v_array.h:192</a></div></div>
<div class="ttc" id="unionpolylabel_html_a68946a978546b21fc85fde38d6147399"><div class="ttname"><a href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">polylabel::multi</a></div><div class="ttdeci">MULTICLASS::label_t multi</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00028">example.h:28</a></div></div>
<div class="ttc" id="structMULTICLASS_1_1label__t_html_aa8b080653e3c08b5363152009728453d"><div class="ttname"><a href="structMULTICLASS_1_1label__t.html#aa8b080653e3c08b5363152009728453d">MULTICLASS::label_t::label</a></div><div class="ttdeci">uint32_t label</div><div class="ttdef"><b>Definition:</b> <a href="multiclass_8h_source.html#l00014">multiclass.h:14</a></div></div>
<div class="ttc" id="structexample_html_a0c87f6e82d9c95ae42158bdbdab3acf5"><div class="ttname"><a href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">example::l</a></div><div class="ttdeci">polylabel l</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00058">example.h:58</a></div></div>
<div class="ttc" id="unionpolylabel_html_a999dc75a1e71967c36a817cead6bf3b2"><div class="ttname"><a href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">polylabel::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00034">example.h:34</a></div></div>
<div class="ttc" id="structMULTILABEL_1_1labels_html_ae9b968050adb2459463cffec3b4c38c4"><div class="ttname"><a href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">MULTILABEL::labels::label_v</a></div><div class="ttdeci">v_array&lt; uint32_t &gt; label_v</div><div class="ttdef"><b>Definition:</b> <a href="multilabel_8h_source.html#l00014">multilabel.h:14</a></div></div>
<div class="ttc" id="structv__array_html_a81c7c9af1948bd97850eb06785f2254f"><div class="ttname"><a href="structv__array.html#a81c7c9af1948bd97850eb06785f2254f">v_array::delete_v</a></div><div class="ttdeci">void delete_v()</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00096">v_array.h:96</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa049a08b1b6161f43c86793e1f674821"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::diag_kronecker_prod_fs_test </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfeatures.html">features</a> &amp;&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfeatures.html">features</a> &amp;&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfeatures.html">features</a> &amp;&#160;</td>
          <td class="paramname"><em>prod_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &amp;&#160;</td>
          <td class="paramname"><em>total_sum_feat_sq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>norm_sq1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>norm_sq2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00071">71</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="feature__group_8h_source.html#l00355">features::clear()</a>, <a class="el" href="cache_8cc_source.html#l00039">f</a>, <a class="el" href="feature__group_8h_source.html#l00251">features::indicies</a>, <a class="el" href="feature__group_8h_source.html#l00388">features::push_back()</a>, <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>, <a class="el" href="feature__group_8h_source.html#l00339">features::size()</a>, and <a class="el" href="feature__group_8h_source.html#l00250">features::values</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00105">diag_kronecker_product_test()</a>.</p>
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;{</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">// originally called delete_v, but that doesn&#39;t seem right. Clearing instead</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">//prod_f.~features();</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  prod_f.<a class="code" href="structfeatures.html#a4bc967f302cfb466681a6b4c331bf33a">clear</a>();</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">if</span> (f2.<a class="code" href="structfeatures.html#a2d75751cdcc865b5e62031d40a770a6a">indicies</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() == 0)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordtype">float</span> denominator = std::pow(norm_sq1 * norm_sq2, 0.5<a class="code" href="cache_8cc.html#af900396d7b72ff2a7002e8befe8cf8f1">f</a>);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordtype">size_t</span> idx1 = 0;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordtype">size_t</span> idx2 = 0;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">while</span> (idx1 &lt; f1.<a class="code" href="structfeatures.html#a026320c3cb110571f0c07da05c8dbea3">size</a>() &amp;&amp; idx2 &lt; f2.<a class="code" href="structfeatures.html#a026320c3cb110571f0c07da05c8dbea3">size</a>())</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    uint64_t ec1pos = f1.<a class="code" href="structfeatures.html#a2d75751cdcc865b5e62031d40a770a6a">indicies</a>[idx1];</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    uint64_t ec2pos = f2.<a class="code" href="structfeatures.html#a2d75751cdcc865b5e62031d40a770a6a">indicies</a>[idx2];</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">if</span> (ec1pos &lt; ec2pos)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      idx1++;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ec1pos &gt; ec2pos)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      idx2++;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      prod_f.<a class="code" href="structfeatures.html#ad204b1a4e0ca9b16b5db3b6261c14423">push_back</a>(f1.<a class="code" href="structfeatures.html#a12befb364b2dcda6f052c9e794ac68e4">values</a>[idx1] * f2.<a class="code" href="structfeatures.html#a12befb364b2dcda6f052c9e794ac68e4">values</a>[idx2] / denominator, ec1pos);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      total_sum_feat_sq += f1.<a class="code" href="structfeatures.html#a12befb364b2dcda6f052c9e794ac68e4">values</a>[idx1] * f2.<a class="code" href="structfeatures.html#a12befb364b2dcda6f052c9e794ac68e4">values</a>[idx2] / denominator;  <span class="comment">// make this out of loop</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      idx1++;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      idx2++;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;}</div><div class="ttc" id="structfeatures_html_ad204b1a4e0ca9b16b5db3b6261c14423"><div class="ttname"><a href="structfeatures.html#ad204b1a4e0ca9b16b5db3b6261c14423">features::push_back</a></div><div class="ttdeci">void push_back(feature_value v, feature_index i)</div><div class="ttdef"><b>Definition:</b> <a href="feature__group_8h_source.html#l00388">feature_group.h:388</a></div></div>
<div class="ttc" id="structfeatures_html_a2d75751cdcc865b5e62031d40a770a6a"><div class="ttname"><a href="structfeatures.html#a2d75751cdcc865b5e62031d40a770a6a">features::indicies</a></div><div class="ttdeci">v_array&lt; feature_index &gt; indicies</div><div class="ttdef"><b>Definition:</b> <a href="feature__group_8h_source.html#l00251">feature_group.h:251</a></div></div>
<div class="ttc" id="structfeatures_html_a12befb364b2dcda6f052c9e794ac68e4"><div class="ttname"><a href="structfeatures.html#a12befb364b2dcda6f052c9e794ac68e4">features::values</a></div><div class="ttdeci">v_array&lt; feature_value &gt; values</div><div class="ttdef"><b>Definition:</b> <a href="feature__group_8h_source.html#l00250">feature_group.h:250</a></div></div>
<div class="ttc" id="structfeatures_html_a026320c3cb110571f0c07da05c8dbea3"><div class="ttname"><a href="structfeatures.html#a026320c3cb110571f0c07da05c8dbea3">features::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="feature__group_8h_source.html#l00339">feature_group.h:339</a></div></div>
<div class="ttc" id="structfeatures_html_a4bc967f302cfb466681a6b4c331bf33a"><div class="ttname"><a href="structfeatures.html#a4bc967f302cfb466681a6b4c331bf33a">features::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="feature__group_8h_source.html#l00355">feature_group.h:355</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
<div class="ttc" id="cache_8cc_html_af900396d7b72ff2a7002e8befe8cf8f1"><div class="ttname"><a href="cache_8cc.html#af900396d7b72ff2a7002e8befe8cf8f1">f</a></div><div class="ttdeci">float f</div><div class="ttdef"><b>Definition:</b> <a href="cache_8cc_source.html#l00039">cache.cc:39</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad57d1c053bf5098292a4820b8f4af607"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::diag_kronecker_product_test </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> &amp;&#160;</td>
          <td class="paramname"><em>ec1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> &amp;&#160;</td>
          <td class="paramname"><em>ec2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> &amp;&#160;</td>
          <td class="paramname"><em>ec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>oas</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00105">105</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="v__array_8h_source.html#l00040">v_array&lt; T &gt;::begin()</a>, <a class="el" href="memory__tree_8cc_source.html#l00103">cmpfunc()</a>, <a class="el" href="memory__tree_8cc_source.html#l00047">copy_example_data()</a>, <a class="el" href="example_8cc_source.html#l00215">VW::dealloc_example()</a>, <a class="el" href="memory__tree_8cc_source.html#l00071">diag_kronecker_prod_fs_test()</a>, <a class="el" href="example__predict_8h_source.html#l00039">example_predict::feature_space</a>, <a class="el" href="example__predict_8h_source.html#l00038">example_predict::indices</a>, <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>, and <a class="el" href="example_8h_source.html#l00072">example::total_sum_feat_sq</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00806">learn_at_leaf_random()</a>, <a class="el" href="memory__tree_8cc_source.html#l00617">pick_nearest()</a>, and <a class="el" href="memory__tree_8cc_source.html#l00739">return_reward_from_node()</a>.</p>
<div class="fragment"><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;{</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// copy_example_data(&amp;ec, &amp;ec1, oas); //no_feat false, oas: true</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="namespaceVW.html#adca7249949a43dd30ac1bf6d8a7185a5">VW::dealloc_example</a>(<span class="keyword">nullptr</span>, ec, <span class="keyword">nullptr</span>);  <span class="comment">// clear ec</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="namespacememory__tree__ns.html#a0e027e17860523e102f53e45d72ef302">copy_example_data</a>(&amp;ec, &amp;ec1, oas);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  ec.<a class="code" href="structexample.html#ad434838ba5443d5f6b5529558d5c1a8c">total_sum_feat_sq</a> = 0.0;  <span class="comment">// sort namespaces.  pass indices array into sort...template (leave this to the end)</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  qsort(ec1.<a class="code" href="structexample__predict.html#ab098b66eb3c24b20ca349b7908ef54f3">indices</a>.<a class="code" href="structv__array.html#af6abe7aa57bda75f23da3a4d4f6ba185">begin</a>(), ec1.<a class="code" href="structexample__predict.html#ab098b66eb3c24b20ca349b7908ef54f3">indices</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>(), <span class="keyword">sizeof</span>(<a class="code" href="example__predict_8h.html#a3302327c8e16f985dd6c4474bf279c40">namespace_index</a>), <a class="code" href="namespacememory__tree__ns.html#ae4f682d65380d554ba2d52afc581d4a7">cmpfunc</a>);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  qsort(ec2.<a class="code" href="structexample__predict.html#ab098b66eb3c24b20ca349b7908ef54f3">indices</a>.<a class="code" href="structv__array.html#af6abe7aa57bda75f23da3a4d4f6ba185">begin</a>(), ec2.<a class="code" href="structexample__predict.html#ab098b66eb3c24b20ca349b7908ef54f3">indices</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>(), <span class="keyword">sizeof</span>(<a class="code" href="example__predict_8h.html#a3302327c8e16f985dd6c4474bf279c40">namespace_index</a>), <a class="code" href="namespacememory__tree__ns.html#ae4f682d65380d554ba2d52afc581d4a7">cmpfunc</a>);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordtype">size_t</span> idx1 = 0;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordtype">size_t</span> idx2 = 0;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">while</span> (idx1 &lt; ec1.<a class="code" href="structexample__predict.html#ab098b66eb3c24b20ca349b7908ef54f3">indices</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() &amp;&amp; idx2 &lt; ec2.<a class="code" href="structexample__predict.html#ab098b66eb3c24b20ca349b7908ef54f3">indices</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>())</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">// for (size_t idx1 = 0, idx2 = 0; idx1 &lt; ec1.indices.size() &amp;&amp; idx2 &lt; ec2.indices.size(); idx1++)</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="example__predict_8h.html#a3302327c8e16f985dd6c4474bf279c40">namespace_index</a> c1 = ec1.<a class="code" href="structexample__predict.html#ab098b66eb3c24b20ca349b7908ef54f3">indices</a>[idx1];</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="example__predict_8h.html#a3302327c8e16f985dd6c4474bf279c40">namespace_index</a> c2 = ec2.<a class="code" href="structexample__predict.html#ab098b66eb3c24b20ca349b7908ef54f3">indices</a>[idx2];</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">if</span> (c1 &lt; c2)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      idx1++;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c1 &gt; c2)</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      idx2++;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <a class="code" href="namespacememory__tree__ns.html#aa049a08b1b6161f43c86793e1f674821">diag_kronecker_prod_fs_test</a>(ec1.<a class="code" href="structexample__predict.html#a59f24cbe1603a24ae5812b7d262f3668">feature_space</a>[c1], ec2.<a class="code" href="structexample__predict.html#a59f24cbe1603a24ae5812b7d262f3668">feature_space</a>[c2], ec.<a class="code" href="structexample__predict.html#a59f24cbe1603a24ae5812b7d262f3668">feature_space</a>[c1],</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;          ec.<a class="code" href="structexample.html#ad434838ba5443d5f6b5529558d5c1a8c">total_sum_feat_sq</a>, ec1.<a class="code" href="structexample.html#ad434838ba5443d5f6b5529558d5c1a8c">total_sum_feat_sq</a>, ec2.<a class="code" href="structexample.html#ad434838ba5443d5f6b5529558d5c1a8c">total_sum_feat_sq</a>);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      idx1++;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      idx2++;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;}</div><div class="ttc" id="structexample__predict_html_ab098b66eb3c24b20ca349b7908ef54f3"><div class="ttname"><a href="structexample__predict.html#ab098b66eb3c24b20ca349b7908ef54f3">example_predict::indices</a></div><div class="ttdeci">v_array&lt; namespace_index &gt; indices</div><div class="ttdef"><b>Definition:</b> <a href="example__predict_8h_source.html#l00038">example_predict.h:38</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_aa049a08b1b6161f43c86793e1f674821"><div class="ttname"><a href="namespacememory__tree__ns.html#aa049a08b1b6161f43c86793e1f674821">memory_tree_ns::diag_kronecker_prod_fs_test</a></div><div class="ttdeci">void diag_kronecker_prod_fs_test(features &amp;f1, features &amp;f2, features &amp;prod_f, float &amp;total_sum_feat_sq, float norm_sq1, float norm_sq2)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00071">memory_tree.cc:71</a></div></div>
<div class="ttc" id="namespaceVW_html_adca7249949a43dd30ac1bf6d8a7185a5"><div class="ttname"><a href="namespaceVW.html#adca7249949a43dd30ac1bf6d8a7185a5">VW::dealloc_example</a></div><div class="ttdeci">void dealloc_example(void(*delete_label)(void *), example &amp;ec, void(*delete_prediction)(void *))</div><div class="ttdef"><b>Definition:</b> <a href="example_8cc_source.html#l00215">example.cc:215</a></div></div>
<div class="ttc" id="structv__array_html_af6abe7aa57bda75f23da3a4d4f6ba185"><div class="ttname"><a href="structv__array.html#af6abe7aa57bda75f23da3a4d4f6ba185">v_array::begin</a></div><div class="ttdeci">T *&amp; begin()</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00040">v_array.h:40</a></div></div>
<div class="ttc" id="structexample__predict_html_a59f24cbe1603a24ae5812b7d262f3668"><div class="ttname"><a href="structexample__predict.html#a59f24cbe1603a24ae5812b7d262f3668">example_predict::feature_space</a></div><div class="ttdeci">std::array&lt; features, NUM_NAMESPACES &gt; feature_space</div><div class="ttdef"><b>Definition:</b> <a href="example__predict_8h_source.html#l00039">example_predict.h:39</a></div></div>
<div class="ttc" id="example__predict_8h_html_a3302327c8e16f985dd6c4474bf279c40"><div class="ttname"><a href="example__predict_8h.html#a3302327c8e16f985dd6c4474bf279c40">namespace_index</a></div><div class="ttdeci">unsigned char namespace_index</div><div class="ttdef"><b>Definition:</b> <a href="example__predict_8h_source.html#l00006">example_predict.h:6</a></div></div>
<div class="ttc" id="structexample_html_ad434838ba5443d5f6b5529558d5c1a8c"><div class="ttname"><a href="structexample.html#ad434838ba5443d5f6b5529558d5c1a8c">example::total_sum_feat_sq</a></div><div class="ttdeci">float total_sum_feat_sq</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00072">example.h:72</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a0e027e17860523e102f53e45d72ef302"><div class="ttname"><a href="namespacememory__tree__ns.html#a0e027e17860523e102f53e45d72ef302">memory_tree_ns::copy_example_data</a></div><div class="ttdeci">void copy_example_data(example *dst, example *src, bool oas=false)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00047">memory_tree.cc:47</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_ae4f682d65380d554ba2d52afc581d4a7"><div class="ttname"><a href="namespacememory__tree__ns.html#ae4f682d65380d554ba2d52afc581d4a7">memory_tree_ns::cmpfunc</a></div><div class="ttdeci">int cmpfunc(const void *a, const void *b)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00103">memory_tree.cc:103</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a977e0a3fbd321817942f7d9e255c6a7e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::end_pass </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l01080">1080</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00206">memory_tree_ns::memory_tree::current_pass</a>, <a class="el" href="memory__tree_8cc_source.html#l00181">memory_tree_ns::memory_tree::examples</a>, and <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>.</p>
<div class="fragment"><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;{</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab273d936adf6037b49b1590414df02dc">current_pass</a>++;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;######### Current Pass: &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab273d936adf6037b49b1590414df02dc">current_pass</a></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;, with number of memories strored so far: &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() &lt;&lt; std::endl;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;}</div><div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_ab273d936adf6037b49b1590414df02dc"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#ab273d936adf6037b49b1590414df02dc">memory_tree_ns::memory_tree::current_pass</a></div><div class="ttdeci">size_t current_pass</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00206">memory_tree.cc:206</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a80ed4155bf29ce66809ab34e364c74b8"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">memory_tree_ns::memory_tree::examples</a></div><div class="ttdeci">v_array&lt; example * &gt; examples</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00181">memory_tree.cc:181</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="accdf4e058c8cf7b7b5deaf0935d34e3f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::experience_replay </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;&#160;</td>
          <td class="paramname"><em>base</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l01000">1000</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00206">memory_tree_ns::memory_tree::current_pass</a>, <a class="el" href="v__array_8h_source.html#l00096">v_array&lt; T &gt;::delete_v()</a>, <a class="el" href="memory__tree_8cc_source.html#l00211">memory_tree_ns::memory_tree::dream_at_update</a>, <a class="el" href="memory__tree_8cc_source.html#l00967">insert_example()</a>, <a class="el" href="memory__tree_8cc_source.html#l00338">random_sample_example_pop()</a>, and <a class="el" href="memory__tree_8cc_source.html#l00830">route_to_leaf()</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l01026">learn()</a>.</p>
<div class="fragment"><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;{</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  uint64_t cn = 0;  <span class="comment">// start from root, randomly descent down!</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="keywordtype">int</span> ec_id = <a class="code" href="namespacememory__tree__ns.html#af4ce818bfbbc0ffeddea9fb7baa64f0d">random_sample_example_pop</a>(b, cn);</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <span class="keywordflow">if</span> (ec_id &gt;= 0)</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  {</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab273d936adf6037b49b1590414df02dc">current_pass</a> &lt; 1)</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      <a class="code" href="namespacememory__tree__ns.html#aa88d570e4879925f6a4ec8a31a5cea9a">insert_example</a>(b, base, ec_id);  <span class="comment">// unsupervised learning</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    {</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ac80117307e53a4f43939058d549e112b">dream_at_update</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      {</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <a class="code" href="structv__array.html">v_array&lt;uint64_t&gt;</a> tmp_path = v_init&lt;uint64_t&gt;();</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        <a class="code" href="namespacememory__tree__ns.html#a28b68857ebf69c2e6cf472da206808ca">route_to_leaf</a>(b, base, ec_id, 0, tmp_path, <span class="keyword">true</span>);</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        tmp_path.<a class="code" href="structv__array.html#a81c7c9af1948bd97850eb06785f2254f">delete_v</a>();</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      }</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      {</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <a class="code" href="namespacememory__tree__ns.html#aa88d570e4879925f6a4ec8a31a5cea9a">insert_example</a>(b, base, ec_id);</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      }</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    }</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  }</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;}</div><div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_ab273d936adf6037b49b1590414df02dc"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#ab273d936adf6037b49b1590414df02dc">memory_tree_ns::memory_tree::current_pass</a></div><div class="ttdeci">size_t current_pass</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00206">memory_tree.cc:206</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_ac80117307e53a4f43939058d549e112b"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#ac80117307e53a4f43939058d549e112b">memory_tree_ns::memory_tree::dream_at_update</a></div><div class="ttdeci">int dream_at_update</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00211">memory_tree.cc:211</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_aa88d570e4879925f6a4ec8a31a5cea9a"><div class="ttname"><a href="namespacememory__tree__ns.html#aa88d570e4879925f6a4ec8a31a5cea9a">memory_tree_ns::insert_example</a></div><div class="ttdeci">void insert_example(memory_tree &amp;b, single_learner &amp;base, const uint32_t &amp;ec_array_index, bool fake_insert=false)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00967">memory_tree.cc:967</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a28b68857ebf69c2e6cf472da206808ca"><div class="ttname"><a href="namespacememory__tree__ns.html#a28b68857ebf69c2e6cf472da206808ca">memory_tree_ns::route_to_leaf</a></div><div class="ttdeci">void route_to_leaf(memory_tree &amp;b, single_learner &amp;base, const uint32_t &amp;ec_array_index, uint64_t cn, v_array&lt; uint64_t &gt; &amp;path, bool insertion)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00830">memory_tree.cc:830</a></div></div>
<div class="ttc" id="structv__array_html_a81c7c9af1948bd97850eb06785f2254f"><div class="ttname"><a href="structv__array.html#a81c7c9af1948bd97850eb06785f2254f">v_array::delete_v</a></div><div class="ttdeci">void delete_v()</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00096">v_array.h:96</a></div></div>
<div class="ttc" id="structv__array_html"><div class="ttname"><a href="structv__array.html">v_array&lt; uint64_t &gt;</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_af4ce818bfbbc0ffeddea9fb7baa64f0d"><div class="ttname"><a href="namespacememory__tree__ns.html#af4ce818bfbbc0ffeddea9fb7baa64f0d">memory_tree_ns::random_sample_example_pop</a></div><div class="ttdeci">int random_sample_example_pop(memory_tree &amp;b, uint64_t &amp;cn)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00338">memory_tree.cc:338</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aad0642fc7ad41fc1bff3db10f6c7695c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float memory_tree_ns::F1_score_for_two_examples </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> &amp;&#160;</td>
          <td class="paramname"><em>ec1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> &amp;&#160;</td>
          <td class="paramname"><em>ec2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00660">660</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="cache_8cc_source.html#l00039">f</a>, <a class="el" href="memory__tree_8cc_source.html#l00654">get_overlap_from_two_examples()</a>, <a class="el" href="example_8h_source.html#l00058">example::l</a>, <a class="el" href="multilabel_8h_source.html#l00014">MULTILABEL::labels::label_v</a>, <a class="el" href="example_8h_source.html#l00034">polylabel::multilabels</a>, and <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00672">predict()</a>, and <a class="el" href="memory__tree_8cc_source.html#l00739">return_reward_from_node()</a>.</p>
<div class="fragment"><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;{</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keywordtype">float</span> num_overlaps = <a class="code" href="namespacememory__tree__ns.html#aebeb62a432be8c48839c914334059a44">get_overlap_from_two_examples</a>(ec1, ec2);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keywordtype">float</span> v1 = (float)(num_overlaps / (1e-7 + ec1.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>.<a class="code" href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">label_v</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() * 1.));</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="keywordtype">float</span> v2 = (float)(num_overlaps / (1e-7 + ec2.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>.<a class="code" href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">label_v</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() * 1.));</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="keywordflow">if</span> (num_overlaps == 0.<a class="code" href="cache_8cc.html#af900396d7b72ff2a7002e8befe8cf8f1">f</a>)</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">return</span> 0.f;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">// return v2; //only precision</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">return</span> 2.f * (v1 * v2 / (v1 + v2));</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;}</div><div class="ttc" id="namespacememory__tree__ns_html_aebeb62a432be8c48839c914334059a44"><div class="ttname"><a href="namespacememory__tree__ns.html#aebeb62a432be8c48839c914334059a44">memory_tree_ns::get_overlap_from_two_examples</a></div><div class="ttdeci">float get_overlap_from_two_examples(example &amp;ec1, example &amp;ec2)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00654">memory_tree.cc:654</a></div></div>
<div class="ttc" id="structexample_html_a0c87f6e82d9c95ae42158bdbdab3acf5"><div class="ttname"><a href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">example::l</a></div><div class="ttdeci">polylabel l</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00058">example.h:58</a></div></div>
<div class="ttc" id="unionpolylabel_html_a999dc75a1e71967c36a817cead6bf3b2"><div class="ttname"><a href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">polylabel::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00034">example.h:34</a></div></div>
<div class="ttc" id="structMULTILABEL_1_1labels_html_ae9b968050adb2459463cffec3b4c38c4"><div class="ttname"><a href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">MULTILABEL::labels::label_v</a></div><div class="ttdeci">v_array&lt; uint32_t &gt; label_v</div><div class="ttdef"><b>Definition:</b> <a href="multilabel_8h_source.html#l00014">multilabel.h:14</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
<div class="ttc" id="cache_8cc_html_af900396d7b72ff2a7002e8befe8cf8f1"><div class="ttname"><a href="cache_8cc.html#af900396d7b72ff2a7002e8befe8cf8f1">f</a></div><div class="ttdeci">float f</div><div class="ttdef"><b>Definition:</b> <a href="cache_8cc_source.html#l00039">cache.cc:39</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1aa2fcb487cc8b75082470c1d4cf5697"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::free_example </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> *&#160;</td>
          <td class="paramname"><em>ec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00062">62</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="example_8cc_source.html#l00215">VW::dealloc_example()</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00236">memory_tree_ns::memory_tree::~memory_tree()</a>.</p>
<div class="fragment"><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;{</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="namespaceVW.html#adca7249949a43dd30ac1bf6d8a7185a5">VW::dealloc_example</a>(<span class="keyword">nullptr</span>, *ec);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  free(ec);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div><div class="ttc" id="namespaceVW_html_adca7249949a43dd30ac1bf6d8a7185a5"><div class="ttname"><a href="namespaceVW.html#adca7249949a43dd30ac1bf6d8a7185a5">VW::dealloc_example</a></div><div class="ttdeci">void dealloc_example(void(*delete_label)(void *), example &amp;ec, void(*delete_prediction)(void *))</div><div class="ttdef"><b>Definition:</b> <a href="example_8cc_source.html#l00215">example.cc:215</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aebeb62a432be8c48839c914334059a44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float memory_tree_ns::get_overlap_from_two_examples </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> &amp;&#160;</td>
          <td class="paramname"><em>ec1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> &amp;&#160;</td>
          <td class="paramname"><em>ec2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00654">654</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="example_8h_source.html#l00058">example::l</a>, <a class="el" href="multilabel_8h_source.html#l00014">MULTILABEL::labels::label_v</a>, <a class="el" href="example_8h_source.html#l00034">polylabel::multilabels</a>, and <a class="el" href="memory__tree_8cc_source.html#l00525">over_lap()</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00660">F1_score_for_two_examples()</a>.</p>
<div class="fragment"><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;{</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)<a class="code" href="namespacememory__tree__ns.html#a9ba1ca9f54ed8baf4526e282d05bd149">over_lap</a>(ec1.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>.<a class="code" href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">label_v</a>, ec2.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>.<a class="code" href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">label_v</a>);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;}</div><div class="ttc" id="namespacememory__tree__ns_html_a9ba1ca9f54ed8baf4526e282d05bd149"><div class="ttname"><a href="namespacememory__tree__ns.html#a9ba1ca9f54ed8baf4526e282d05bd149">memory_tree_ns::over_lap</a></div><div class="ttdeci">uint32_t over_lap(v_array&lt; uint32_t &gt; &amp;array_1, v_array&lt; uint32_t &gt; &amp;array_2)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00525">memory_tree.cc:525</a></div></div>
<div class="ttc" id="structexample_html_a0c87f6e82d9c95ae42158bdbdab3acf5"><div class="ttname"><a href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">example::l</a></div><div class="ttdeci">polylabel l</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00058">example.h:58</a></div></div>
<div class="ttc" id="unionpolylabel_html_a999dc75a1e71967c36a817cead6bf3b2"><div class="ttname"><a href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">polylabel::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00034">example.h:34</a></div></div>
<div class="ttc" id="structMULTILABEL_1_1labels_html_ae9b968050adb2459463cffec3b4c38c4"><div class="ttname"><a href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">MULTILABEL::labels::label_v</a></div><div class="ttdeci">v_array&lt; uint32_t &gt; label_v</div><div class="ttdef"><b>Definition:</b> <a href="multilabel_8h_source.html#l00014">multilabel.h:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aac9cb969cdb5e18468bb5f384ec80922"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t memory_tree_ns::hamming_loss </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structv__array.html">v_array</a>&lt; uint32_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>array_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structv__array.html">v_array</a>&lt; uint32_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>array_2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00553">553</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00525">over_lap()</a>, and <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00594">compute_hamming_loss_via_oas()</a>.</p>
<div class="fragment"><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;{</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  uint32_t overlap = <a class="code" href="namespacememory__tree__ns.html#a9ba1ca9f54ed8baf4526e282d05bd149">over_lap</a>(array_1, array_2);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keywordflow">return</span> (uint32_t)(array_1.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() + array_2.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() - 2 * overlap);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;}</div><div class="ttc" id="namespacememory__tree__ns_html_a9ba1ca9f54ed8baf4526e282d05bd149"><div class="ttname"><a href="namespacememory__tree__ns.html#a9ba1ca9f54ed8baf4526e282d05bd149">memory_tree_ns::over_lap</a></div><div class="ttdeci">uint32_t over_lap(v_array&lt; uint32_t &gt; &amp;array_1, v_array&lt; uint32_t &gt; &amp;array_2)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00525">memory_tree.cc:525</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1a425ef2e5402c64f2813699f9c239d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::init_tree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00287">287</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00198">memory_tree_ns::memory_tree::construct_time</a>, <a class="el" href="memory__tree_8cc_source.html#l00206">memory_tree_ns::memory_tree::current_pass</a>, <a class="el" href="memory__tree_8cc_source.html#l00191">memory_tree_ns::memory_tree::dream_repeats</a>, <a class="el" href="memory__tree_8cc_source.html#l00215">memory_tree_ns::memory_tree::F1_score</a>, <a class="el" href="memory__tree_8cc_source.html#l00216">memory_tree_ns::memory_tree::hamming_loss</a>, <a class="el" href="memory__tree_8cc_source.html#l00190">memory_tree_ns::memory_tree::iter</a>, <a class="el" href="memory__tree_8cc_source.html#l00218">memory_tree_ns::memory_tree::kprod_ec</a>, <a class="el" href="memory__tree_8cc_source.html#l00202">memory_tree_ns::memory_tree::learn_at_leaf</a>, <a class="el" href="memory__tree_8cc_source.html#l00195">memory_tree_ns::memory_tree::max_depth</a>, <a class="el" href="memory__tree_8cc_source.html#l00196">memory_tree_ns::memory_tree::max_ex_in_leaf</a>, <a class="el" href="memory__tree_8cc_source.html#l00184">memory_tree_ns::memory_tree::max_nodes</a>, <a class="el" href="memory__tree_8cc_source.html#l00187">memory_tree_ns::memory_tree::max_num_labels</a>, <a class="el" href="memory__tree_8cc_source.html#l00186">memory_tree_ns::memory_tree::max_routers</a>, <a class="el" href="memory__tree_8cc_source.html#l00180">memory_tree_ns::memory_tree::nodes</a>, <a class="el" href="memory__tree_8cc_source.html#l00201">memory_tree_ns::memory_tree::num_mistakes</a>, <a class="el" href="memory__tree_8cc_source.html#l00210">memory_tree_ns::memory_tree::oas</a>, <a class="el" href="v__array_8h_source.html#l00105">v_array&lt; T &gt;::push_back()</a>, <a class="el" href="memory__tree_8cc_source.html#l00189">memory_tree_ns::memory_tree::routers_used</a>, <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>, <a class="el" href="memory__tree_8cc_source.html#l00204">memory_tree_ns::memory_tree::test_mode</a>, <a class="el" href="memory__tree_8cc_source.html#l00199">memory_tree_ns::memory_tree::test_time</a>, <a class="el" href="memory__tree_8cc_source.html#l00209">memory_tree_ns::memory_tree::top_K</a>, and <a class="el" href="memory__tree_8cc_source.html#l00193">memory_tree_ns::memory_tree::total_num_queries</a>.</p>
<div class="fragment"><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;{</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">// srand48(4000);</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="comment">// simple initilization: initilize the root only</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aa03cf2679358a90ef7cefde78789aa3d">iter</a> = 0;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#af030e33f21d4629b8c3c23128706f8b3">num_mistakes</a> = 0;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a97c53589756df3c45f9d32d3719a1925">routers_used</a> = 0;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a05c9f1597c8bbc63abeb04ee5405bde7">test_mode</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab51886feb1c63d2833d5db801938a59a">max_depth</a> = 0;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a61be1b7f33cb7a845fd5455b07d8f290">max_ex_in_leaf</a> = 0;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ac7e78856c6a29d8d726755651e92e4c5">construct_time</a> = 0;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a4bdbb26724a8c85708c84bdd545cf15c">test_time</a> = 0;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a5be6ce09e63bf1e5c8a155bb443d6546">top_K</a> = 1;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a2581cc6feac4eea08949cf7ef59041cf">hamming_loss</a> = 0.f;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aab0e2adb1091013caea371f9b887d8c0">F1_score</a> = 0.f;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(<a class="code" href="structmemory__tree__ns_1_1node.html">node</a>());</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[0].internal = -1;  <span class="comment">// mark the root as leaf</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[0].base_router = (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a97c53589756df3c45f9d32d3719a1925">routers_used</a>++);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aba4ccb0892bda7b4b1ffe37f4b9a2f11">kprod_ec</a> = &amp;calloc_or_throw&lt;example&gt;();  <span class="comment">// allocate space for kronecker product example</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a9bee7278ec707749e7b8eb40d9715892">total_num_queries</a> = 0;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aee12725de055582f62c270a2d5b4d7b3">max_routers</a> = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a070cc6088b8fd42530bb96c53e21aca7">max_nodes</a>;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;tree initiazliation is done....&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;max nodes &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a070cc6088b8fd42530bb96c53e21aca7">max_nodes</a> &lt;&lt; std::endl</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;tree size: &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() &lt;&lt; std::endl</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;max number of unique labels: &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a2842d0be85f1213b5d1b654e2ad1d63e">max_num_labels</a> &lt;&lt; std::endl</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;learn at leaf: &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab6b65098687f9c3bd37c925fd932f32a">learn_at_leaf</a> &lt;&lt; std::endl</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;num of dream operations per example: &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a07af3bb3676a97350d8c6064fd66840a">dream_repeats</a> &lt;&lt; std::endl</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;current_pass: &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab273d936adf6037b49b1590414df02dc">current_pass</a> &lt;&lt; std::endl</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;oas: &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div><div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_ab273d936adf6037b49b1590414df02dc"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#ab273d936adf6037b49b1590414df02dc">memory_tree_ns::memory_tree::current_pass</a></div><div class="ttdeci">size_t current_pass</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00206">memory_tree.cc:206</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a97c53589756df3c45f9d32d3719a1925"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a97c53589756df3c45f9d32d3719a1925">memory_tree_ns::memory_tree::routers_used</a></div><div class="ttdeci">uint64_t routers_used</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00189">memory_tree.cc:189</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a9bee7278ec707749e7b8eb40d9715892"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a9bee7278ec707749e7b8eb40d9715892">memory_tree_ns::memory_tree::total_num_queries</a></div><div class="ttdeci">uint32_t total_num_queries</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00193">memory_tree.cc:193</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a05c9f1597c8bbc63abeb04ee5405bde7"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a05c9f1597c8bbc63abeb04ee5405bde7">memory_tree_ns::memory_tree::test_mode</a></div><div class="ttdeci">bool test_mode</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00204">memory_tree.cc:204</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a07af3bb3676a97350d8c6064fd66840a"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a07af3bb3676a97350d8c6064fd66840a">memory_tree_ns::memory_tree::dream_repeats</a></div><div class="ttdeci">uint32_t dream_repeats</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00191">memory_tree.cc:191</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a4bdbb26724a8c85708c84bdd545cf15c"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a4bdbb26724a8c85708c84bdd545cf15c">memory_tree_ns::memory_tree::test_time</a></div><div class="ttdeci">float test_time</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00199">memory_tree.cc:199</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_af030e33f21d4629b8c3c23128706f8b3"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#af030e33f21d4629b8c3c23128706f8b3">memory_tree_ns::memory_tree::num_mistakes</a></div><div class="ttdeci">uint32_t num_mistakes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00201">memory_tree.cc:201</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a5be6ce09e63bf1e5c8a155bb443d6546"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a5be6ce09e63bf1e5c8a155bb443d6546">memory_tree_ns::memory_tree::top_K</a></div><div class="ttdeci">int top_K</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00209">memory_tree.cc:209</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a2581cc6feac4eea08949cf7ef59041cf"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a2581cc6feac4eea08949cf7ef59041cf">memory_tree_ns::memory_tree::hamming_loss</a></div><div class="ttdeci">float hamming_loss</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00216">memory_tree.cc:216</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_ab51886feb1c63d2833d5db801938a59a"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#ab51886feb1c63d2833d5db801938a59a">memory_tree_ns::memory_tree::max_depth</a></div><div class="ttdeci">size_t max_depth</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00195">memory_tree.cc:195</a></div></div>
<div class="ttc" id="structv__array_html_afd6a4614f027ac5f786507552ce13f13"><div class="ttname"><a href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">v_array::push_back</a></div><div class="ttdeci">void push_back(const T &amp;new_ele)</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00105">v_array.h:105</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1node_html"><div class="ttname"><a href="structmemory__tree__ns_1_1node.html">memory_tree_ns::node</a></div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00144">memory_tree.cc:144</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a6f1e18de5dec701d3cbe87ef47204640"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">memory_tree_ns::memory_tree::nodes</a></div><div class="ttdeci">v_array&lt; node &gt; nodes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00180">memory_tree.cc:180</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_aa03cf2679358a90ef7cefde78789aa3d"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#aa03cf2679358a90ef7cefde78789aa3d">memory_tree_ns::memory_tree::iter</a></div><div class="ttdeci">int iter</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00190">memory_tree.cc:190</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a61be1b7f33cb7a845fd5455b07d8f290"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a61be1b7f33cb7a845fd5455b07d8f290">memory_tree_ns::memory_tree::max_ex_in_leaf</a></div><div class="ttdeci">size_t max_ex_in_leaf</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00196">memory_tree.cc:196</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a2842d0be85f1213b5d1b654e2ad1d63e"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a2842d0be85f1213b5d1b654e2ad1d63e">memory_tree_ns::memory_tree::max_num_labels</a></div><div class="ttdeci">size_t max_num_labels</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00187">memory_tree.cc:187</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_ab6b65098687f9c3bd37c925fd932f32a"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#ab6b65098687f9c3bd37c925fd932f32a">memory_tree_ns::memory_tree::learn_at_leaf</a></div><div class="ttdeci">bool learn_at_leaf</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00202">memory_tree.cc:202</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a070cc6088b8fd42530bb96c53e21aca7"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a070cc6088b8fd42530bb96c53e21aca7">memory_tree_ns::memory_tree::max_nodes</a></div><div class="ttdeci">size_t max_nodes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00184">memory_tree.cc:184</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a83fcd57ae88e0cf7551df6a2ea81bb46"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">memory_tree_ns::memory_tree::oas</a></div><div class="ttdeci">bool oas</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00210">memory_tree.cc:210</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_aba4ccb0892bda7b4b1ffe37f4b9a2f11"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#aba4ccb0892bda7b4b1ffe37f4b9a2f11">memory_tree_ns::memory_tree::kprod_ec</a></div><div class="ttdeci">example * kprod_ec</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00218">memory_tree.cc:218</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_ac7e78856c6a29d8d726755651e92e4c5"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#ac7e78856c6a29d8d726755651e92e4c5">memory_tree_ns::memory_tree::construct_time</a></div><div class="ttdeci">float construct_time</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00198">memory_tree.cc:198</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_aab0e2adb1091013caea371f9b887d8c0"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#aab0e2adb1091013caea371f9b887d8c0">memory_tree_ns::memory_tree::F1_score</a></div><div class="ttdeci">float F1_score</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00215">memory_tree.cc:215</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_aee12725de055582f62c270a2d5b4d7b3"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#aee12725de055582f62c270a2d5b4d7b3">memory_tree_ns::memory_tree::max_routers</a></div><div class="ttdeci">size_t max_routers</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00186">memory_tree.cc:186</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa544f428dd64b385a63b962e9b1ed2a8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t memory_tree_ns::insert_descent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1node.html">node</a> &amp;&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float&#160;</td>
          <td class="paramname"><em>prediction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00322">322</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00151">memory_tree_ns::node::left</a>, <a class="el" href="memory__tree_8cc_source.html#l00154">memory_tree_ns::node::nl</a>, <a class="el" href="memory__tree_8cc_source.html#l00155">memory_tree_ns::node::nr</a>, and <a class="el" href="memory__tree_8cc_source.html#l00152">memory_tree_ns::node::right</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00967">insert_example()</a>, <a class="el" href="memory__tree_8cc_source.html#l00830">route_to_leaf()</a>, and <a class="el" href="memory__tree_8cc_source.html#l00437">split_leaf()</a>.</p>
<div class="fragment"><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;{</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">// prediction &lt;0 go left, otherwise go right</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">if</span> (prediction &lt; 0)</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    n.<a class="code" href="structmemory__tree__ns_1_1node.html#afbdc727abc0305bc7d6294bcc5e62a08">nl</a>++;  <span class="comment">// increment the number of examples routed to the left.</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">return</span> n.<a class="code" href="structmemory__tree__ns_1_1node.html#aabe30f1c22342caa41c8ca9b801c383e">left</a>;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  }</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  {          <span class="comment">// otherwise go right.</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    n.<a class="code" href="structmemory__tree__ns_1_1node.html#a38af2224a12f108dc578f3c69d90cedd">nr</a>++;  <span class="comment">// increment the number of examples routed to the right.</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">return</span> n.<a class="code" href="structmemory__tree__ns_1_1node.html#ab020d85a089bc9c233aa5f6157d897f9">right</a>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div><div class="ttc" id="structmemory__tree__ns_1_1node_html_afbdc727abc0305bc7d6294bcc5e62a08"><div class="ttname"><a href="structmemory__tree__ns_1_1node.html#afbdc727abc0305bc7d6294bcc5e62a08">memory_tree_ns::node::nl</a></div><div class="ttdeci">double nl</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00154">memory_tree.cc:154</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1node_html_aabe30f1c22342caa41c8ca9b801c383e"><div class="ttname"><a href="structmemory__tree__ns_1_1node.html#aabe30f1c22342caa41c8ca9b801c383e">memory_tree_ns::node::left</a></div><div class="ttdeci">uint64_t left</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00151">memory_tree.cc:151</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1node_html_a38af2224a12f108dc578f3c69d90cedd"><div class="ttname"><a href="structmemory__tree__ns_1_1node.html#a38af2224a12f108dc578f3c69d90cedd">memory_tree_ns::node::nr</a></div><div class="ttdeci">double nr</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00155">memory_tree.cc:155</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1node_html_ab020d85a089bc9c233aa5f6157d897f9"><div class="ttname"><a href="structmemory__tree__ns_1_1node.html#ab020d85a089bc9c233aa5f6157d897f9">memory_tree_ns::node::right</a></div><div class="ttdeci">uint64_t right</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00152">memory_tree.cc:152</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa88d570e4879925f6a4ec8a31a5cea9a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::insert_example </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t &amp;&#160;</td>
          <td class="paramname"><em>ec_array_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>fake_insert</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00967">967</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00181">memory_tree_ns::memory_tree::examples</a>, <a class="el" href="memory__tree_8cc_source.html#l00322">insert_descent()</a>, <a class="el" href="memory__tree_8cc_source.html#l00196">memory_tree_ns::memory_tree::max_ex_in_leaf</a>, <a class="el" href="memory__tree_8cc_source.html#l00183">memory_tree_ns::memory_tree::max_leaf_examples</a>, <a class="el" href="memory__tree_8cc_source.html#l00184">memory_tree_ns::memory_tree::max_nodes</a>, <a class="el" href="memory__tree_8cc_source.html#l00180">memory_tree_ns::memory_tree::nodes</a>, <a class="el" href="memory__tree_8cc_source.html#l00210">memory_tree_ns::memory_tree::oas</a>, <a class="el" href="v__array_8h_source.html#l00105">v_array&lt; T &gt;::push_back()</a>, <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>, <a class="el" href="memory__tree_8cc_source.html#l00437">split_leaf()</a>, <a class="el" href="log__multi_8cc_source.html#l00250">train_node()</a>, and <a class="el" href="memory__tree_8cc_source.html#l00576">train_one_against_some_at_leaf()</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l01000">experience_replay()</a>, and <a class="el" href="memory__tree_8cc_source.html#l01026">learn()</a>.</p>
<div class="fragment"><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;{</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  uint64_t cn = 0;                   <span class="comment">// start from the root.</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <span class="keywordflow">while</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].internal == 1)  <span class="comment">// if it&#39;s internal node:</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  {</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="comment">// predict and train the node at cn.</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keywordtype">float</span> router_pred = <a class="code" href="log__multi_8cc.html#a968fdae7c02e90fe10245115a53aa640">train_node</a>(b, base, *b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_array_index], cn);</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    uint64_t newcn = <a class="code" href="namespacememory__tree__ns.html#aa544f428dd64b385a63b962e9b1ed2a8">insert_descent</a>(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn], router_pred);  <span class="comment">// updated nr or nl</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    cn = newcn;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  }</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">true</span>)  <span class="comment">// if useing oas as inference procedure, we just train oas here, as it&#39;s independent of the memory</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                      <span class="comment">// unit anyway&#39;</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <a class="code" href="namespacememory__tree__ns.html#a27aad0e7fea7b74c8efa7961a6fd5a17">train_one_against_some_at_leaf</a>(b, base, cn, *b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_array_index]);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keywordflow">if</span> ((b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].internal == -1) &amp;&amp; (fake_insert == <span class="keyword">false</span>))  <span class="comment">// get to leaf:</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  {</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(ec_array_index);</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() &gt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a61be1b7f33cb7a845fd5455b07d8f290">max_ex_in_leaf</a>)</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    {</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a61be1b7f33cb7a845fd5455b07d8f290">max_ex_in_leaf</a> = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>();</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    }</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordtype">float</span> leaf_pred = <a class="code" href="log__multi_8cc.html#a968fdae7c02e90fe10245115a53aa640">train_node</a>(b, base, *b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_array_index], cn);  <span class="comment">// tain the leaf as well.</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <a class="code" href="namespacememory__tree__ns.html#aa544f428dd64b385a63b962e9b1ed2a8">insert_descent</a>(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn], leaf_pred);  <span class="comment">// this is a faked descent, the purpose is only to update nl and nr of cn</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="comment">// if the number of examples exceeds the max_leaf_examples, and not reach the max_nodes - 2 yet, we split:</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">if</span> ((b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() &gt;= b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aa13cd8947a499ed9c33af3d58fbb4993">max_leaf_examples</a>) &amp;&amp; (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() + 2 &lt;= b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a070cc6088b8fd42530bb96c53e21aca7">max_nodes</a>))</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    {</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <a class="code" href="namespacememory__tree__ns.html#a86e4abca95dc1304004eac3b4648bd05">split_leaf</a>(b, base, cn);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    }</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  }</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;}</div><div class="ttc" id="namespacememory__tree__ns_html_a86e4abca95dc1304004eac3b4648bd05"><div class="ttname"><a href="namespacememory__tree__ns.html#a86e4abca95dc1304004eac3b4648bd05">memory_tree_ns::split_leaf</a></div><div class="ttdeci">void split_leaf(memory_tree &amp;b, single_learner &amp;base, const uint64_t cn)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00437">memory_tree.cc:437</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_aa544f428dd64b385a63b962e9b1ed2a8"><div class="ttname"><a href="namespacememory__tree__ns.html#aa544f428dd64b385a63b962e9b1ed2a8">memory_tree_ns::insert_descent</a></div><div class="ttdeci">uint64_t insert_descent(node &amp;n, const float prediction)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00322">memory_tree.cc:322</a></div></div>
<div class="ttc" id="log__multi_8cc_html_a968fdae7c02e90fe10245115a53aa640"><div class="ttname"><a href="log__multi_8cc.html#a968fdae7c02e90fe10245115a53aa640">train_node</a></div><div class="ttdeci">void train_node(log_multi &amp;b, single_learner &amp;base, example &amp;ec, uint32_t &amp;current, uint32_t &amp;class_index, uint32_t)</div><div class="ttdef"><b>Definition:</b> <a href="log__multi_8cc_source.html#l00250">log_multi.cc:250</a></div></div>
<div class="ttc" id="structv__array_html_afd6a4614f027ac5f786507552ce13f13"><div class="ttname"><a href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">v_array::push_back</a></div><div class="ttdeci">void push_back(const T &amp;new_ele)</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00105">v_array.h:105</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a6f1e18de5dec701d3cbe87ef47204640"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">memory_tree_ns::memory_tree::nodes</a></div><div class="ttdeci">v_array&lt; node &gt; nodes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00180">memory_tree.cc:180</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_aa13cd8947a499ed9c33af3d58fbb4993"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#aa13cd8947a499ed9c33af3d58fbb4993">memory_tree_ns::memory_tree::max_leaf_examples</a></div><div class="ttdeci">size_t max_leaf_examples</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00183">memory_tree.cc:183</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a61be1b7f33cb7a845fd5455b07d8f290"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a61be1b7f33cb7a845fd5455b07d8f290">memory_tree_ns::memory_tree::max_ex_in_leaf</a></div><div class="ttdeci">size_t max_ex_in_leaf</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00196">memory_tree.cc:196</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a80ed4155bf29ce66809ab34e364c74b8"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">memory_tree_ns::memory_tree::examples</a></div><div class="ttdeci">v_array&lt; example * &gt; examples</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00181">memory_tree.cc:181</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a070cc6088b8fd42530bb96c53e21aca7"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a070cc6088b8fd42530bb96c53e21aca7">memory_tree_ns::memory_tree::max_nodes</a></div><div class="ttdeci">size_t max_nodes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00184">memory_tree.cc:184</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a83fcd57ae88e0cf7551df6a2ea81bb46"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">memory_tree_ns::memory_tree::oas</a></div><div class="ttdeci">bool oas</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00210">memory_tree.cc:210</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a27aad0e7fea7b74c8efa7961a6fd5a17"><div class="ttname"><a href="namespacememory__tree__ns.html#a27aad0e7fea7b74c8efa7961a6fd5a17">memory_tree_ns::train_one_against_some_at_leaf</a></div><div class="ttdeci">void train_one_against_some_at_leaf(memory_tree &amp;b, single_learner &amp;base, const uint64_t cn, example &amp;ec)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00576">memory_tree.cc:576</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a03d2e3881caed7ba0a4721dc7b559dcb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::learn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> &amp;&#160;</td>
          <td class="paramname"><em>ec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l01026">1026</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00198">memory_tree_ns::memory_tree::construct_time</a>, <a class="el" href="memory__tree_8cc_source.html#l00047">copy_example_data()</a>, <a class="el" href="memory__tree_8cc_source.html#l00206">memory_tree_ns::memory_tree::current_pass</a>, <a class="el" href="memory__tree_8cc_source.html#l00191">memory_tree_ns::memory_tree::dream_repeats</a>, <a class="el" href="memory__tree_8cc_source.html#l00181">memory_tree_ns::memory_tree::examples</a>, <a class="el" href="memory__tree_8cc_source.html#l01000">experience_replay()</a>, <a class="el" href="memory__tree_8cc_source.html#l00216">memory_tree_ns::memory_tree::hamming_loss</a>, <a class="el" href="memory__tree_8cc_source.html#l00967">insert_example()</a>, <a class="el" href="memory__tree_8cc_source.html#l00190">memory_tree_ns::memory_tree::iter</a>, <a class="el" href="memory__tree_8cc_source.html#l00195">memory_tree_ns::memory_tree::max_depth</a>, <a class="el" href="memory__tree_8cc_source.html#l00196">memory_tree_ns::memory_tree::max_ex_in_leaf</a>, <a class="el" href="memory__tree_8cc_source.html#l00201">memory_tree_ns::memory_tree::num_mistakes</a>, <a class="el" href="memory__tree_8cc_source.html#l00210">memory_tree_ns::memory_tree::oas</a>, <a class="el" href="memory__tree_8cc_source.html#l00213">memory_tree_ns::memory_tree::online</a>, <a class="el" href="memory__tree_8cc_source.html#l00672">predict()</a>, <a class="el" href="v__array_8h_source.html#l00105">v_array&lt; T &gt;::push_back()</a>, <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>, <a class="el" href="memory__tree_8cc_source.html#l00204">memory_tree_ns::memory_tree::test_mode</a>, <a class="el" href="memory__tree_8cc_source.html#l00199">memory_tree_ns::memory_tree::test_time</a>, <a class="el" href="memory__tree_8cc_source.html#l00209">memory_tree_ns::memory_tree::top_K</a>, <a class="el" href="memory__tree_8cc_source.html#l00193">memory_tree_ns::memory_tree::total_num_queries</a>, and <a class="el" href="memory__tree_8cc_source.html#l00960">update_rew()</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l01229">memory_tree_setup()</a>.</p>
<div class="fragment"><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;{</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a05c9f1597c8bbc63abeb04ee5405bde7">test_mode</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  {</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aa03cf2679358a90ef7cefde78789aa3d">iter</a>++;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <a class="code" href="namespacememory__tree__ns.html#a9660af68688f6d780599a8237cd1b2a8">predict</a>(b, base, ec);</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aa03cf2679358a90ef7cefde78789aa3d">iter</a> % 5000 == 0)</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    {</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;at iter &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aa03cf2679358a90ef7cefde78789aa3d">iter</a> &lt;&lt; <span class="stringliteral">&quot;, top(&quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a5be6ce09e63bf1e5c8a155bb443d6546">top_K</a> &lt;&lt; <span class="stringliteral">&quot;) pred error: &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#af030e33f21d4629b8c3c23128706f8b3">num_mistakes</a> * 1. / b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aa03cf2679358a90ef7cefde78789aa3d">iter</a></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;, total num queries so far: &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a9bee7278ec707749e7b8eb40d9715892">total_num_queries</a> &lt;&lt; <span class="stringliteral">&quot;, max depth: &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab51886feb1c63d2833d5db801938a59a">max_depth</a></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;, max exp in leaf: &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a61be1b7f33cb7a845fd5455b07d8f290">max_ex_in_leaf</a> &lt;&lt; std::endl;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;at iter &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aa03cf2679358a90ef7cefde78789aa3d">iter</a> &lt;&lt; <span class="stringliteral">&quot;, avg hamming loss: &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a2581cc6feac4eea08949cf7ef59041cf">hamming_loss</a> * 1. / b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aa03cf2679358a90ef7cefde78789aa3d">iter</a> &lt;&lt; std::endl;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    }</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    clock_t begin = clock();</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab273d936adf6037b49b1590414df02dc">current_pass</a> &lt; 1)</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    {  <span class="comment">// in the first pass, we need to store the memory:</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      <a class="code" href="structexample.html">example</a>* new_ec = &amp;calloc_or_throw&lt;example&gt;();</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      <a class="code" href="namespacememory__tree__ns.html#a0e027e17860523e102f53e45d72ef302">copy_example_data</a>(new_ec, &amp;ec, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a>);</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(new_ec);</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ac455f3430e18b8df8afd49c0e74d6fd5">online</a> == <span class="keyword">true</span>)</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <a class="code" href="namespacememory__tree__ns.html#a4ab3b6859145c6e6dd81a902ccd05aad">update_rew</a>(b, base, (uint32_t)(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() - 1), *b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() - 1]);  <span class="comment">// query and learn</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <a class="code" href="namespacememory__tree__ns.html#aa88d570e4879925f6a4ec8a31a5cea9a">insert_example</a>(b, base, (uint32_t)(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() - 1));  <span class="comment">// unsupervised learning.</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a07af3bb3676a97350d8c6064fd66840a">dream_repeats</a>; i++) <a class="code" href="namespacememory__tree__ns.html#accdf4e058c8cf7b7b5deaf0935d34e3f">experience_replay</a>(b, base);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    }</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    {  <span class="comment">// starting from the current pass, we just learn using reinforcement signal, no insertion needed:</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <span class="keywordtype">size_t</span> ec_id = (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aa03cf2679358a90ef7cefde78789aa3d">iter</a>) % b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>();</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <a class="code" href="namespacememory__tree__ns.html#a4ab3b6859145c6e6dd81a902ccd05aad">update_rew</a>(b, base, (uint32_t)ec_id, *b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_id]);  <span class="comment">// no insertion will happen in this call</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a07af3bb3676a97350d8c6064fd66840a">dream_repeats</a>; i++) <a class="code" href="namespacememory__tree__ns.html#accdf4e058c8cf7b7b5deaf0935d34e3f">experience_replay</a>(b, base);</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    }</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ac7e78856c6a29d8d726755651e92e4c5">construct_time</a> += float(clock() - begin) / CLOCKS_PER_SEC;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  }</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a05c9f1597c8bbc63abeb04ee5405bde7">test_mode</a> == <span class="keyword">true</span>)</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  {</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aa03cf2679358a90ef7cefde78789aa3d">iter</a>++;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aa03cf2679358a90ef7cefde78789aa3d">iter</a> % 5000 == 0)</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    {</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;at iter &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aa03cf2679358a90ef7cefde78789aa3d">iter</a> &lt;&lt; <span class="stringliteral">&quot;, pred error: &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#af030e33f21d4629b8c3c23128706f8b3">num_mistakes</a> * 1. / b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aa03cf2679358a90ef7cefde78789aa3d">iter</a> &lt;&lt; std::endl;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;at iter &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aa03cf2679358a90ef7cefde78789aa3d">iter</a> &lt;&lt; <span class="stringliteral">&quot;, avg hamming loss: &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a2581cc6feac4eea08949cf7ef59041cf">hamming_loss</a> * 1. / b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aa03cf2679358a90ef7cefde78789aa3d">iter</a> &lt;&lt; std::endl;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    }</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    clock_t begin = clock();</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <a class="code" href="namespacememory__tree__ns.html#a9660af68688f6d780599a8237cd1b2a8">predict</a>(b, base, ec);</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a4bdbb26724a8c85708c84bdd545cf15c">test_time</a> += float(clock() - begin) / CLOCKS_PER_SEC;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  }</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;}</div><div class="ttc" id="namespacememory__tree__ns_html_a4ab3b6859145c6e6dd81a902ccd05aad"><div class="ttname"><a href="namespacememory__tree__ns.html#a4ab3b6859145c6e6dd81a902ccd05aad">memory_tree_ns::update_rew</a></div><div class="ttdeci">void update_rew(memory_tree &amp;b, single_learner &amp;base, const uint32_t &amp;ec_array_index, example &amp;ec)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00960">memory_tree.cc:960</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_ab273d936adf6037b49b1590414df02dc"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#ab273d936adf6037b49b1590414df02dc">memory_tree_ns::memory_tree::current_pass</a></div><div class="ttdeci">size_t current_pass</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00206">memory_tree.cc:206</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a9bee7278ec707749e7b8eb40d9715892"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a9bee7278ec707749e7b8eb40d9715892">memory_tree_ns::memory_tree::total_num_queries</a></div><div class="ttdeci">uint32_t total_num_queries</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00193">memory_tree.cc:193</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a9660af68688f6d780599a8237cd1b2a8"><div class="ttname"><a href="namespacememory__tree__ns.html#a9660af68688f6d780599a8237cd1b2a8">memory_tree_ns::predict</a></div><div class="ttdeci">void predict(memory_tree &amp;b, single_learner &amp;base, example &amp;ec)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00672">memory_tree.cc:672</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a05c9f1597c8bbc63abeb04ee5405bde7"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a05c9f1597c8bbc63abeb04ee5405bde7">memory_tree_ns::memory_tree::test_mode</a></div><div class="ttdeci">bool test_mode</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00204">memory_tree.cc:204</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a07af3bb3676a97350d8c6064fd66840a"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a07af3bb3676a97350d8c6064fd66840a">memory_tree_ns::memory_tree::dream_repeats</a></div><div class="ttdeci">uint32_t dream_repeats</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00191">memory_tree.cc:191</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a4bdbb26724a8c85708c84bdd545cf15c"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a4bdbb26724a8c85708c84bdd545cf15c">memory_tree_ns::memory_tree::test_time</a></div><div class="ttdeci">float test_time</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00199">memory_tree.cc:199</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_ac455f3430e18b8df8afd49c0e74d6fd5"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#ac455f3430e18b8df8afd49c0e74d6fd5">memory_tree_ns::memory_tree::online</a></div><div class="ttdeci">bool online</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00213">memory_tree.cc:213</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_af030e33f21d4629b8c3c23128706f8b3"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#af030e33f21d4629b8c3c23128706f8b3">memory_tree_ns::memory_tree::num_mistakes</a></div><div class="ttdeci">uint32_t num_mistakes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00201">memory_tree.cc:201</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a5be6ce09e63bf1e5c8a155bb443d6546"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a5be6ce09e63bf1e5c8a155bb443d6546">memory_tree_ns::memory_tree::top_K</a></div><div class="ttdeci">int top_K</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00209">memory_tree.cc:209</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a2581cc6feac4eea08949cf7ef59041cf"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a2581cc6feac4eea08949cf7ef59041cf">memory_tree_ns::memory_tree::hamming_loss</a></div><div class="ttdeci">float hamming_loss</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00216">memory_tree.cc:216</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_aa88d570e4879925f6a4ec8a31a5cea9a"><div class="ttname"><a href="namespacememory__tree__ns.html#aa88d570e4879925f6a4ec8a31a5cea9a">memory_tree_ns::insert_example</a></div><div class="ttdeci">void insert_example(memory_tree &amp;b, single_learner &amp;base, const uint32_t &amp;ec_array_index, bool fake_insert=false)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00967">memory_tree.cc:967</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_ab51886feb1c63d2833d5db801938a59a"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#ab51886feb1c63d2833d5db801938a59a">memory_tree_ns::memory_tree::max_depth</a></div><div class="ttdeci">size_t max_depth</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00195">memory_tree.cc:195</a></div></div>
<div class="ttc" id="structv__array_html_afd6a4614f027ac5f786507552ce13f13"><div class="ttname"><a href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">v_array::push_back</a></div><div class="ttdeci">void push_back(const T &amp;new_ele)</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00105">v_array.h:105</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_aa03cf2679358a90ef7cefde78789aa3d"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#aa03cf2679358a90ef7cefde78789aa3d">memory_tree_ns::memory_tree::iter</a></div><div class="ttdeci">int iter</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00190">memory_tree.cc:190</a></div></div>
<div class="ttc" id="structexample_html"><div class="ttname"><a href="structexample.html">example</a></div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00055">example.h:55</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_accdf4e058c8cf7b7b5deaf0935d34e3f"><div class="ttname"><a href="namespacememory__tree__ns.html#accdf4e058c8cf7b7b5deaf0935d34e3f">memory_tree_ns::experience_replay</a></div><div class="ttdeci">void experience_replay(memory_tree &amp;b, single_learner &amp;base)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l01000">memory_tree.cc:1000</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a61be1b7f33cb7a845fd5455b07d8f290"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a61be1b7f33cb7a845fd5455b07d8f290">memory_tree_ns::memory_tree::max_ex_in_leaf</a></div><div class="ttdeci">size_t max_ex_in_leaf</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00196">memory_tree.cc:196</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a80ed4155bf29ce66809ab34e364c74b8"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">memory_tree_ns::memory_tree::examples</a></div><div class="ttdeci">v_array&lt; example * &gt; examples</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00181">memory_tree.cc:181</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a83fcd57ae88e0cf7551df6a2ea81bb46"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">memory_tree_ns::memory_tree::oas</a></div><div class="ttdeci">bool oas</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00210">memory_tree.cc:210</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_ac7e78856c6a29d8d726755651e92e4c5"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#ac7e78856c6a29d8d726755651e92e4c5">memory_tree_ns::memory_tree::construct_time</a></div><div class="ttdeci">float construct_time</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00198">memory_tree.cc:198</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a0e027e17860523e102f53e45d72ef302"><div class="ttname"><a href="namespacememory__tree__ns.html#a0e027e17860523e102f53e45d72ef302">memory_tree_ns::copy_example_data</a></div><div class="ttdeci">void copy_example_data(example *dst, example *src, bool oas=false)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00047">memory_tree.cc:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a049fec021123c5ddfc9989582c24fa6e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::learn_at_leaf_random </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t &amp;&#160;</td>
          <td class="paramname"><em>leaf_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> &amp;&#160;</td>
          <td class="paramname"><em>ec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const float &amp;&#160;</td>
          <td class="paramname"><em>weight</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00806">806</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00178">memory_tree_ns::memory_tree::_random_state</a>, <a class="el" href="memory__tree_8cc_source.html#l00105">diag_kronecker_product_test()</a>, <a class="el" href="memory__tree_8cc_source.html#l00181">memory_tree_ns::memory_tree::examples</a>, <a class="el" href="memory__tree_8cc_source.html#l00218">memory_tree_ns::memory_tree::kprod_ec</a>, <a class="el" href="example_8h_source.html#l00058">example::l</a>, <a class="el" href="multiclass_8h_source.html#l00014">MULTICLASS::label_t::label</a>, <a class="el" href="learner_8h_source.html#l00156">LEARNER::learner&lt; T, E &gt;::learn()</a>, <a class="el" href="memory__tree_8cc_source.html#l00186">memory_tree_ns::memory_tree::max_routers</a>, <a class="el" href="example_8h_source.html#l00028">polylabel::multi</a>, <a class="el" href="memory__tree_8cc_source.html#l00180">memory_tree_ns::memory_tree::nodes</a>, <a class="el" href="memory__tree_8cc_source.html#l00274">normalized_linear_prod()</a>, <a class="el" href="memory__tree_8cc_source.html#l00210">memory_tree_ns::memory_tree::oas</a>, <a class="el" href="example_8h_source.html#l00027">polylabel::simple</a>, <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>, <a class="el" href="memory__tree_8cc_source.html#l00193">memory_tree_ns::memory_tree::total_num_queries</a>, and <a class="el" href="example_8h_source.html#l00063">example::weight</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00885">single_query_and_learn()</a>.</p>
<div class="fragment"><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;{</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a9bee7278ec707749e7b8eb40d9715892">total_num_queries</a>++;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  int32_t ec_id = -1;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keywordtype">float</span> reward = 0.f;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[leaf_id].examples_index.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() &gt; 0)</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  {</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    uint32_t pos = uint32_t(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a43960ae6e6fe6bca0b4d94ec783d658b">_random_state</a>-&gt;get_and_update_random() * b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[leaf_id].examples_index.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>());</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    ec_id = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[leaf_id].examples_index[pos];</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  }</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="keywordflow">if</span> (ec_id != -1)</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_id]-&gt;l.multi.label == ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">multi</a>.<a class="code" href="structMULTICLASS_1_1label__t.html#aa8b080653e3c08b5363152009728453d">label</a>)</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      reward = 1.f;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordtype">float</span> score = <a class="code" href="namespacememory__tree__ns.html#a30cdcc95dfc069080971ca5fc83cc40b">normalized_linear_prod</a>(b, &amp;ec, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_id]);</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <a class="code" href="namespacememory__tree__ns.html#ad57d1c053bf5098292a4820b8f4af607">diag_kronecker_product_test</a>(ec, *b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_id], *b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aba4ccb0892bda7b4b1ffe37f4b9a2f11">kprod_ec</a>, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a>);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aba4ccb0892bda7b4b1ffe37f4b9a2f11">kprod_ec</a>-&gt;<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">simple</a> = {reward, 1.f, -score};</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aba4ccb0892bda7b4b1ffe37f4b9a2f11">kprod_ec</a>-&gt;<a class="code" href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">weight</a> = <a class="code" href="array__parameters__dense_8h.html#a4d04a2043fa7480d905108e63adb0bab">weight</a>;  <span class="comment">//* b.nodes[leaf_id].examples_index.size();</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    base.<a class="code" href="structLEARNER_1_1learner.html#a9984332080a6ee4730a5762e9be3a3f6">learn</a>(*b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aba4ccb0892bda7b4b1ffe37f4b9a2f11">kprod_ec</a>, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aee12725de055582f62c270a2d5b4d7b3">max_routers</a>);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  }</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;}</div><div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a9bee7278ec707749e7b8eb40d9715892"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a9bee7278ec707749e7b8eb40d9715892">memory_tree_ns::memory_tree::total_num_queries</a></div><div class="ttdeci">uint32_t total_num_queries</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00193">memory_tree.cc:193</a></div></div>
<div class="ttc" id="unionpolylabel_html_a80ff268cb4e29afddaac58174d316297"><div class="ttname"><a href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">polylabel::simple</a></div><div class="ttdeci">label_data simple</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00027">example.h:27</a></div></div>
<div class="ttc" id="unionpolylabel_html_a68946a978546b21fc85fde38d6147399"><div class="ttname"><a href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">polylabel::multi</a></div><div class="ttdeci">MULTICLASS::label_t multi</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00028">example.h:28</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_ad57d1c053bf5098292a4820b8f4af607"><div class="ttname"><a href="namespacememory__tree__ns.html#ad57d1c053bf5098292a4820b8f4af607">memory_tree_ns::diag_kronecker_product_test</a></div><div class="ttdeci">void diag_kronecker_product_test(example &amp;ec1, example &amp;ec2, example &amp;ec, bool oas=false)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00105">memory_tree.cc:105</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a30cdcc95dfc069080971ca5fc83cc40b"><div class="ttname"><a href="namespacememory__tree__ns.html#a30cdcc95dfc069080971ca5fc83cc40b">memory_tree_ns::normalized_linear_prod</a></div><div class="ttdeci">float normalized_linear_prod(memory_tree &amp;b, example *ec1, example *ec2)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00274">memory_tree.cc:274</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a6f1e18de5dec701d3cbe87ef47204640"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">memory_tree_ns::memory_tree::nodes</a></div><div class="ttdeci">v_array&lt; node &gt; nodes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00180">memory_tree.cc:180</a></div></div>
<div class="ttc" id="structMULTICLASS_1_1label__t_html_aa8b080653e3c08b5363152009728453d"><div class="ttname"><a href="structMULTICLASS_1_1label__t.html#aa8b080653e3c08b5363152009728453d">MULTICLASS::label_t::label</a></div><div class="ttdeci">uint32_t label</div><div class="ttdef"><b>Definition:</b> <a href="multiclass_8h_source.html#l00014">multiclass.h:14</a></div></div>
<div class="ttc" id="array__parameters__dense_8h_html_a4d04a2043fa7480d905108e63adb0bab"><div class="ttname"><a href="array__parameters__dense_8h.html#a4d04a2043fa7480d905108e63adb0bab">weight</a></div><div class="ttdeci">float weight</div><div class="ttdef"><b>Definition:</b> <a href="array__parameters__dense_8h_source.html#l00010">array_parameters_dense.h:10</a></div></div>
<div class="ttc" id="structexample_html_a0c87f6e82d9c95ae42158bdbdab3acf5"><div class="ttname"><a href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">example::l</a></div><div class="ttdeci">polylabel l</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00058">example.h:58</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a80ed4155bf29ce66809ab34e364c74b8"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">memory_tree_ns::memory_tree::examples</a></div><div class="ttdeci">v_array&lt; example * &gt; examples</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00181">memory_tree.cc:181</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a83fcd57ae88e0cf7551df6a2ea81bb46"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">memory_tree_ns::memory_tree::oas</a></div><div class="ttdeci">bool oas</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00210">memory_tree.cc:210</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_aba4ccb0892bda7b4b1ffe37f4b9a2f11"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#aba4ccb0892bda7b4b1ffe37f4b9a2f11">memory_tree_ns::memory_tree::kprod_ec</a></div><div class="ttdeci">example * kprod_ec</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00218">memory_tree.cc:218</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a43960ae6e6fe6bca0b4d94ec783d658b"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a43960ae6e6fe6bca0b4d94ec783d658b">memory_tree_ns::memory_tree::_random_state</a></div><div class="ttdeci">std::shared_ptr&lt; rand_state &gt; _random_state</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00178">memory_tree.cc:178</a></div></div>
<div class="ttc" id="structLEARNER_1_1learner_html_a9984332080a6ee4730a5762e9be3a3f6"><div class="ttname"><a href="structLEARNER_1_1learner.html#a9984332080a6ee4730a5762e9be3a3f6">LEARNER::learner::learn</a></div><div class="ttdeci">void learn(E &amp;ec, size_t i=0)</div><div class="ttdef"><b>Definition:</b> <a href="learner_8h_source.html#l00156">learner.h:156</a></div></div>
<div class="ttc" id="structexample_html_a403be75fc4fdd058e4f7c1baf39be11a"><div class="ttname"><a href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">example::weight</a></div><div class="ttdeci">float weight</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00063">example.h:63</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_aee12725de055582f62c270a2d5b4d7b3"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#aee12725de055582f62c270a2d5b4d7b3">memory_tree_ns::memory_tree::max_routers</a></div><div class="ttdeci">size_t max_routers</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00186">memory_tree.cc:186</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7a2e3abcc2803897c578669f3dab7329"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float memory_tree_ns::linear_kernel </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structflat__example.html">flat_example</a> *&#160;</td>
          <td class="paramname"><em>fec1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structflat__example.html">flat_example</a> *&#160;</td>
          <td class="paramname"><em>fec2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00247">247</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="cache_8cc_source.html#l00039">f</a>, <a class="el" href="example_8h_source.html#l00101">flat_example::fs</a>, <a class="el" href="feature__group_8h_source.html#l00251">features::indicies</a>, <a class="el" href="feature__group_8h_source.html#l00339">features::size()</a>, and <a class="el" href="feature__group_8h_source.html#l00250">features::values</a>.</p>
<div class="fragment"><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;{</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordtype">float</span> dotprod = 0;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <a class="code" href="structfeatures.html">features</a>&amp; fs_1 = (<a class="code" href="structfeatures.html">features</a>&amp;)fec1-&gt;<a class="code" href="structflat__example.html#a77947dfb239fd7487b88e3842a8f0594">fs</a>;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <a class="code" href="structfeatures.html">features</a>&amp; fs_2 = (<a class="code" href="structfeatures.html">features</a>&amp;)fec2-&gt;<a class="code" href="structflat__example.html#a77947dfb239fd7487b88e3842a8f0594">fs</a>;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">if</span> (fs_2.indicies.size() == 0)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">return</span> 0.<a class="code" href="cache_8cc.html#af900396d7b72ff2a7002e8befe8cf8f1">f</a>;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> idx1 = 0, idx2 = 0; idx1 &lt; fs_1.<a class="code" href="structfeatures.html#a026320c3cb110571f0c07da05c8dbea3">size</a>() &amp;&amp; idx2 &lt; fs_2.size(); idx1++)</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    uint64_t ec1pos = fs_1.<a class="code" href="structfeatures.html#a2d75751cdcc865b5e62031d40a770a6a">indicies</a>[idx1];</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    uint64_t ec2pos = fs_2.indicies[idx2];</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">if</span> (ec1pos &lt; ec2pos)</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">while</span> (ec1pos &gt; ec2pos &amp;&amp; ++idx2 &lt; fs_2.size()) ec2pos = fs_2.indicies[idx2];</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    if (ec1pos == ec2pos)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      dotprod += fs_1.<a class="code" href="structfeatures.html#a12befb364b2dcda6f052c9e794ac68e4">values</a>[idx1] * fs_2.values[idx2];</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      ++idx2;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordflow">return</span> dotprod;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;}</div><div class="ttc" id="structfeatures_html_a2d75751cdcc865b5e62031d40a770a6a"><div class="ttname"><a href="structfeatures.html#a2d75751cdcc865b5e62031d40a770a6a">features::indicies</a></div><div class="ttdeci">v_array&lt; feature_index &gt; indicies</div><div class="ttdef"><b>Definition:</b> <a href="feature__group_8h_source.html#l00251">feature_group.h:251</a></div></div>
<div class="ttc" id="structfeatures_html"><div class="ttname"><a href="structfeatures.html">features</a></div><div class="ttdoc">the core definition of a set of features. </div><div class="ttdef"><b>Definition:</b> <a href="feature__group_8h_source.html#l00248">feature_group.h:248</a></div></div>
<div class="ttc" id="structfeatures_html_a12befb364b2dcda6f052c9e794ac68e4"><div class="ttname"><a href="structfeatures.html#a12befb364b2dcda6f052c9e794ac68e4">features::values</a></div><div class="ttdeci">v_array&lt; feature_value &gt; values</div><div class="ttdef"><b>Definition:</b> <a href="feature__group_8h_source.html#l00250">feature_group.h:250</a></div></div>
<div class="ttc" id="structflat__example_html_a77947dfb239fd7487b88e3842a8f0594"><div class="ttname"><a href="structflat__example.html#a77947dfb239fd7487b88e3842a8f0594">flat_example::fs</a></div><div class="ttdeci">features fs</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00101">example.h:101</a></div></div>
<div class="ttc" id="structfeatures_html_a026320c3cb110571f0c07da05c8dbea3"><div class="ttname"><a href="structfeatures.html#a026320c3cb110571f0c07da05c8dbea3">features::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="feature__group_8h_source.html#l00339">feature_group.h:339</a></div></div>
<div class="ttc" id="cache_8cc_html_af900396d7b72ff2a7002e8befe8cf8f1"><div class="ttname"><a href="cache_8cc.html#af900396d7b72ff2a7002e8befe8cf8f1">f</a></div><div class="ttdeci">float f</div><div class="ttdef"><b>Definition:</b> <a href="cache_8cc_source.html#l00039">cache.cc:39</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a30cdcc95dfc069080971ca5fc83cc40b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float memory_tree_ns::normalized_linear_prod </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> *&#160;</td>
          <td class="paramname"><em>ec1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> *&#160;</td>
          <td class="paramname"><em>ec2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00274">274</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00177">memory_tree_ns::memory_tree::all</a>, <a class="el" href="example_8cc_source.html#l00179">flatten_sort_example()</a>, <a class="el" href="example_8cc_source.html#l00187">free_flatten_example()</a>, <a class="el" href="kernel__svm_8cc_source.html#l00381">linear_kernel()</a>, and <a class="el" href="example_8h_source.html#l00100">flat_example::total_sum_feat_sq</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00806">learn_at_leaf_random()</a>, <a class="el" href="memory__tree_8cc_source.html#l00617">pick_nearest()</a>, and <a class="el" href="memory__tree_8cc_source.html#l00739">return_reward_from_node()</a>.</p>
<div class="fragment"><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;{</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <a class="code" href="structflat__example.html">flat_example</a>* fec1 = <a class="code" href="example_8cc.html#a5c55851c4a2c558e4d8f27ee17b5567c">flatten_sort_example</a>(*b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a1973c6606ab20af9f30c58b93410cf03">all</a>, ec1);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <a class="code" href="structflat__example.html">flat_example</a>* fec2 = <a class="code" href="example_8cc.html#a5c55851c4a2c558e4d8f27ee17b5567c">flatten_sort_example</a>(*b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a1973c6606ab20af9f30c58b93410cf03">all</a>, ec2);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordtype">float</span> norm_sqrt = std::pow(fec1-&gt;<a class="code" href="structflat__example.html#aa233932b8fedfd4092068bee8779cd6a">total_sum_feat_sq</a> * fec2-&gt;<a class="code" href="structflat__example.html#aa233932b8fedfd4092068bee8779cd6a">total_sum_feat_sq</a>, 0.5f);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordtype">float</span> linear_prod = <a class="code" href="kernel__svm_8cc.html#a7db3a3bb10b479f3bdb889fba80943b5">linear_kernel</a>(fec1, fec2);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="comment">// fec1-&gt;fs.delete_v();</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">// fec2-&gt;fs.delete_v();</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="example_8cc.html#a43e653fb1e820bef507e28a6d1debe75">free_flatten_example</a>(fec1);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <a class="code" href="example_8cc.html#a43e653fb1e820bef507e28a6d1debe75">free_flatten_example</a>(fec2);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordflow">return</span> linear_prod / norm_sqrt;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;}</div><div class="ttc" id="structflat__example_html_aa233932b8fedfd4092068bee8779cd6a"><div class="ttname"><a href="structflat__example.html#aa233932b8fedfd4092068bee8779cd6a">flat_example::total_sum_feat_sq</a></div><div class="ttdeci">float total_sum_feat_sq</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00100">example.h:100</a></div></div>
<div class="ttc" id="example_8cc_html_a43e653fb1e820bef507e28a6d1debe75"><div class="ttname"><a href="example_8cc.html#a43e653fb1e820bef507e28a6d1debe75">free_flatten_example</a></div><div class="ttdeci">void free_flatten_example(flat_example *fec)</div><div class="ttdef"><b>Definition:</b> <a href="example_8cc_source.html#l00187">example.cc:187</a></div></div>
<div class="ttc" id="kernel__svm_8cc_html_a7db3a3bb10b479f3bdb889fba80943b5"><div class="ttname"><a href="kernel__svm_8cc.html#a7db3a3bb10b479f3bdb889fba80943b5">linear_kernel</a></div><div class="ttdeci">float linear_kernel(const flat_example *fec1, const flat_example *fec2)</div><div class="ttdef"><b>Definition:</b> <a href="kernel__svm_8cc_source.html#l00381">kernel_svm.cc:381</a></div></div>
<div class="ttc" id="example_8cc_html_a5c55851c4a2c558e4d8f27ee17b5567c"><div class="ttname"><a href="example_8cc.html#a5c55851c4a2c558e4d8f27ee17b5567c">flatten_sort_example</a></div><div class="ttdeci">flat_example * flatten_sort_example(vw &amp;all, example *ec)</div><div class="ttdef"><b>Definition:</b> <a href="example_8cc_source.html#l00179">example.cc:179</a></div></div>
<div class="ttc" id="structflat__example_html"><div class="ttname"><a href="structflat__example.html">flat_example</a></div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00088">example.h:88</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a1973c6606ab20af9f30c58b93410cf03"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a1973c6606ab20af9f30c58b93410cf03">memory_tree_ns::memory_tree::all</a></div><div class="ttdeci">vw * all</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00177">memory_tree.cc:177</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9ba1ca9f54ed8baf4526e282d05bd149"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t memory_tree_ns::over_lap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structv__array.html">v_array</a>&lt; uint32_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>array_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structv__array.html">v_array</a>&lt; uint32_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>array_2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00525">525</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="v__array_8h_source.html#l00040">v_array&lt; T &gt;::begin()</a>, <a class="el" href="memory__tree_8cc_source.html#l00523">compare_label()</a>, and <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00654">get_overlap_from_two_examples()</a>, and <a class="el" href="memory__tree_8cc_source.html#l00553">hamming_loss()</a>.</p>
<div class="fragment"><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;{</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  uint32_t num_overlap = 0;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  qsort(array_1.<a class="code" href="structv__array.html#af6abe7aa57bda75f23da3a4d4f6ba185">begin</a>(), array_1.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>(), <span class="keyword">sizeof</span>(uint32_t), <a class="code" href="namespacememory__tree__ns.html#a87ff00a851488f590d4336b3d83f5e2e">compare_label</a>);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  qsort(array_2.<a class="code" href="structv__array.html#af6abe7aa57bda75f23da3a4d4f6ba185">begin</a>(), array_2.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>(), <span class="keyword">sizeof</span>(uint32_t), <a class="code" href="namespacememory__tree__ns.html#a87ff00a851488f590d4336b3d83f5e2e">compare_label</a>);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  uint32_t idx1 = 0;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  uint32_t idx2 = 0;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">while</span> (idx1 &lt; array_1.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() &amp;&amp; idx2 &lt; array_2.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>())</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  {</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    uint32_t c1 = array_1[idx1];</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    uint32_t c2 = array_2[idx2];</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">if</span> (c1 &lt; c2)</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      idx1++;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c1 &gt; c2)</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      idx2++;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    {</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      num_overlap++;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      idx1++;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      idx2++;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  }</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordflow">return</span> num_overlap;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;}</div><div class="ttc" id="structv__array_html_af6abe7aa57bda75f23da3a4d4f6ba185"><div class="ttname"><a href="structv__array.html#af6abe7aa57bda75f23da3a4d4f6ba185">v_array::begin</a></div><div class="ttdeci">T *&amp; begin()</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00040">v_array.h:40</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a87ff00a851488f590d4336b3d83f5e2e"><div class="ttname"><a href="namespacememory__tree__ns.html#a87ff00a851488f590d4336b3d83f5e2e">memory_tree_ns::compare_label</a></div><div class="ttdeci">int compare_label(const void *a, const void *b)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00523">memory_tree.cc:523</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8574c94638d3b4386ba0be942703575b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t memory_tree_ns::pick_nearest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>cn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> &amp;&#160;</td>
          <td class="paramname"><em>ec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00617">617</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00206">memory_tree_ns::memory_tree::current_pass</a>, <a class="el" href="memory__tree_8cc_source.html#l00105">diag_kronecker_product_test()</a>, <a class="el" href="memory__tree_8cc_source.html#l00181">memory_tree_ns::memory_tree::examples</a>, <a class="el" href="memory__tree_8cc_source.html#l00218">memory_tree_ns::memory_tree::kprod_ec</a>, <a class="el" href="example_8h_source.html#l00058">example::l</a>, <a class="el" href="memory__tree_8cc_source.html#l00202">memory_tree_ns::memory_tree::learn_at_leaf</a>, <a class="el" href="memory__tree_8cc_source.html#l00186">memory_tree_ns::memory_tree::max_routers</a>, <a class="el" href="memory__tree_8cc_source.html#l00180">memory_tree_ns::memory_tree::nodes</a>, <a class="el" href="memory__tree_8cc_source.html#l00274">normalized_linear_prod()</a>, <a class="el" href="memory__tree_8cc_source.html#l00210">memory_tree_ns::memory_tree::oas</a>, <a class="el" href="example_8h_source.html#l00069">example::partial_prediction</a>, <a class="el" href="learner_8h_source.html#l00165">LEARNER::learner&lt; T, E &gt;::predict()</a>, <a class="el" href="example_8h_source.html#l00027">polylabel::simple</a>, and <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00672">predict()</a>, and <a class="el" href="memory__tree_8cc_source.html#l00739">return_reward_from_node()</a>.</p>
<div class="fragment"><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;{</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() &gt; 0)</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordtype">float</span> max_score = -FLT_MAX;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    int64_t max_pos = -1;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>(); i++)</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <span class="keywordtype">float</span> score = 0.f;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      uint32_t loc = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index[i];</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <span class="comment">// do not use reward to update memory tree during the very first pass</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="comment">//(which is for unsupervised training for memory tree)</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab6b65098687f9c3bd37c925fd932f32a">learn_at_leaf</a> == <span class="keyword">true</span> &amp;&amp; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab273d936adf6037b49b1590414df02dc">current_pass</a> &gt;= 1)</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keywordtype">float</span> tmp_s = <a class="code" href="namespacememory__tree__ns.html#a30cdcc95dfc069080971ca5fc83cc40b">normalized_linear_prod</a>(b, &amp;ec, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[loc]);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <a class="code" href="namespacememory__tree__ns.html#ad57d1c053bf5098292a4820b8f4af607">diag_kronecker_product_test</a>(ec, *b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[loc], *b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aba4ccb0892bda7b4b1ffe37f4b9a2f11">kprod_ec</a>, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a>);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aba4ccb0892bda7b4b1ffe37f4b9a2f11">kprod_ec</a>-&gt;<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">simple</a> = {FLT_MAX, 0., tmp_s};</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        base.<a class="code" href="structLEARNER_1_1learner.html#a8b4f75763c0ec9a26eb5255780e782a8">predict</a>(*b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aba4ccb0892bda7b4b1ffe37f4b9a2f11">kprod_ec</a>, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aee12725de055582f62c270a2d5b4d7b3">max_routers</a>);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        score = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aba4ccb0892bda7b4b1ffe37f4b9a2f11">kprod_ec</a>-&gt;<a class="code" href="structexample.html#a3e4e427253321a8867a27827a3dd59c1">partial_prediction</a>;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      }</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        score = <a class="code" href="namespacememory__tree__ns.html#a30cdcc95dfc069080971ca5fc83cc40b">normalized_linear_prod</a>(b, &amp;ec, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[loc]);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="keywordflow">if</span> (score &gt; max_score)</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      {</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        max_score = score;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        max_pos = (int64_t)loc;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      }</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    }</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordflow">return</span> max_pos;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;}</div><div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_ab273d936adf6037b49b1590414df02dc"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#ab273d936adf6037b49b1590414df02dc">memory_tree_ns::memory_tree::current_pass</a></div><div class="ttdeci">size_t current_pass</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00206">memory_tree.cc:206</a></div></div>
<div class="ttc" id="structLEARNER_1_1learner_html_a8b4f75763c0ec9a26eb5255780e782a8"><div class="ttname"><a href="structLEARNER_1_1learner.html#a8b4f75763c0ec9a26eb5255780e782a8">LEARNER::learner::predict</a></div><div class="ttdeci">void predict(E &amp;ec, size_t i=0)</div><div class="ttdef"><b>Definition:</b> <a href="learner_8h_source.html#l00165">learner.h:165</a></div></div>
<div class="ttc" id="structexample_html_a3e4e427253321a8867a27827a3dd59c1"><div class="ttname"><a href="structexample.html#a3e4e427253321a8867a27827a3dd59c1">example::partial_prediction</a></div><div class="ttdeci">float partial_prediction</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00069">example.h:69</a></div></div>
<div class="ttc" id="unionpolylabel_html_a80ff268cb4e29afddaac58174d316297"><div class="ttname"><a href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">polylabel::simple</a></div><div class="ttdeci">label_data simple</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00027">example.h:27</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_ad57d1c053bf5098292a4820b8f4af607"><div class="ttname"><a href="namespacememory__tree__ns.html#ad57d1c053bf5098292a4820b8f4af607">memory_tree_ns::diag_kronecker_product_test</a></div><div class="ttdeci">void diag_kronecker_product_test(example &amp;ec1, example &amp;ec2, example &amp;ec, bool oas=false)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00105">memory_tree.cc:105</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a30cdcc95dfc069080971ca5fc83cc40b"><div class="ttname"><a href="namespacememory__tree__ns.html#a30cdcc95dfc069080971ca5fc83cc40b">memory_tree_ns::normalized_linear_prod</a></div><div class="ttdeci">float normalized_linear_prod(memory_tree &amp;b, example *ec1, example *ec2)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00274">memory_tree.cc:274</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a6f1e18de5dec701d3cbe87ef47204640"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">memory_tree_ns::memory_tree::nodes</a></div><div class="ttdeci">v_array&lt; node &gt; nodes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00180">memory_tree.cc:180</a></div></div>
<div class="ttc" id="structexample_html_a0c87f6e82d9c95ae42158bdbdab3acf5"><div class="ttname"><a href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">example::l</a></div><div class="ttdeci">polylabel l</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00058">example.h:58</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_ab6b65098687f9c3bd37c925fd932f32a"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#ab6b65098687f9c3bd37c925fd932f32a">memory_tree_ns::memory_tree::learn_at_leaf</a></div><div class="ttdeci">bool learn_at_leaf</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00202">memory_tree.cc:202</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a80ed4155bf29ce66809ab34e364c74b8"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">memory_tree_ns::memory_tree::examples</a></div><div class="ttdeci">v_array&lt; example * &gt; examples</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00181">memory_tree.cc:181</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a83fcd57ae88e0cf7551df6a2ea81bb46"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">memory_tree_ns::memory_tree::oas</a></div><div class="ttdeci">bool oas</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00210">memory_tree.cc:210</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_aba4ccb0892bda7b4b1ffe37f4b9a2f11"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#aba4ccb0892bda7b4b1ffe37f4b9a2f11">memory_tree_ns::memory_tree::kprod_ec</a></div><div class="ttdeci">example * kprod_ec</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00218">memory_tree.cc:218</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_aee12725de055582f62c270a2d5b4d7b3"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#aee12725de055582f62c270a2d5b4d7b3">memory_tree_ns::memory_tree::max_routers</a></div><div class="ttdeci">size_t max_routers</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00186">memory_tree.cc:186</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9660af68688f6d780599a8237cd1b2a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::predict </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> &amp;&#160;</td>
          <td class="paramname"><em>ec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00672">672</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00594">compute_hamming_loss_via_oas()</a>, <a class="el" href="memory__tree_8cc_source.html#l00181">memory_tree_ns::memory_tree::examples</a>, <a class="el" href="memory__tree_8cc_source.html#l00215">memory_tree_ns::memory_tree::F1_score</a>, <a class="el" href="memory__tree_8cc_source.html#l00660">F1_score_for_two_examples()</a>, <a class="el" href="memory__tree_8cc_source.html#l00216">memory_tree_ns::memory_tree::hamming_loss</a>, <a class="el" href="example_8h_source.html#l00058">example::l</a>, <a class="el" href="multiclass_8h_source.html#l00014">MULTICLASS::label_t::label</a>, <a class="el" href="example_8h_source.html#l00071">example::loss</a>, <a class="el" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>, <a class="el" href="example_8h_source.html#l00028">polylabel::multi</a>, <a class="el" href="example_8h_source.html#l00049">polyprediction::multiclass</a>, <a class="el" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>, <a class="el" href="example_8h_source.html#l00034">polylabel::multilabels</a>, <a class="el" href="example_8h_source.html#l00050">polyprediction::multilabels</a>, <a class="el" href="memory__tree_8cc_source.html#l00180">memory_tree_ns::memory_tree::nodes</a>, <a class="el" href="memory__tree_8cc_source.html#l00201">memory_tree_ns::memory_tree::num_mistakes</a>, <a class="el" href="memory__tree_8cc_source.html#l00210">memory_tree_ns::memory_tree::oas</a>, <a class="el" href="memory__tree_8cc_source.html#l00617">pick_nearest()</a>, <a class="el" href="example_8h_source.html#l00061">example::pred</a>, <a class="el" href="learner_8h_source.html#l00165">LEARNER::learner&lt; T, E &gt;::predict()</a>, <a class="el" href="example_8h_source.html#l00045">polyprediction::scalar</a>, <a class="el" href="example_8h_source.html#l00027">polylabel::simple</a>, and <a class="el" href="example_8h_source.html#l00063">example::weight</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l01026">learn()</a>, and <a class="el" href="memory__tree_8cc_source.html#l01229">memory_tree_setup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;{</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <a class="code" href="structMULTICLASS_1_1label__t.html">MULTICLASS::label_t</a> <a class="code" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  uint32_t save_multi_pred = 0;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <a class="code" href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a> <a class="code" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <a class="code" href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a> preds;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  {</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    mc = ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">multi</a>;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    save_multi_pred = ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#abc57dae8f83df4756ff4f8ec910f0fd1">multiclass</a>;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  }</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  {</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    multilabels = ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    preds = ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">multilabels</a>;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  }</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  uint64_t cn = 0;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">simple</a> = {-1.f, 1.f, 0.};</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="keywordflow">while</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].internal == 1)</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  {  <span class="comment">// if it&#39;s internal{</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    base.<a class="code" href="structLEARNER_1_1learner.html#a8b4f75763c0ec9a26eb5255780e782a8">predict</a>(ec, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].base_router);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    uint64_t newcn = ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#ae29f42559acac5a2b08322a7fe887f04">scalar</a> &lt; 0 ? b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].left : b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].right;  <span class="comment">// do not need to increment nl and nr.</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    cn = newcn;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  }</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">multi</a> = <a class="code" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#abc57dae8f83df4756ff4f8ec910f0fd1">multiclass</a> = save_multi_pred;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  }</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  {</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">multilabels</a> = preds;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a> = <a class="code" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  }</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  int64_t closest_ec = 0;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  {</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    closest_ec = <a class="code" href="namespacememory__tree__ns.html#a8574c94638d3b4386ba0be942703575b">pick_nearest</a>(b, base, cn, ec);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">if</span> (closest_ec != -1)</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#abc57dae8f83df4756ff4f8ec910f0fd1">multiclass</a> = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[closest_ec]-&gt;l.multi.label;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#abc57dae8f83df4756ff4f8ec910f0fd1">multiclass</a> = 0;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">if</span> (ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">multi</a>.<a class="code" href="structMULTICLASS_1_1label__t.html#aa8b080653e3c08b5363152009728453d">label</a> != ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#abc57dae8f83df4756ff4f8ec910f0fd1">multiclass</a>)</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      ec.<a class="code" href="structexample.html#aec82f8fecc8ad2a13e54ecf83dfbc5c9">loss</a> = ec.<a class="code" href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">weight</a>;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#af030e33f21d4629b8c3c23128706f8b3">num_mistakes</a>++;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  }</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  {</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordtype">float</span> reward = 0.f;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    closest_ec = <a class="code" href="namespacememory__tree__ns.html#a8574c94638d3b4386ba0be942703575b">pick_nearest</a>(b, base, cn, ec);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordflow">if</span> (closest_ec != -1)</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    {</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      reward = <a class="code" href="namespacememory__tree__ns.html#aad0642fc7ad41fc1bff3db10f6c7695c">F1_score_for_two_examples</a>(ec, *b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[closest_ec]);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aab0e2adb1091013caea371f9b887d8c0">F1_score</a> += reward;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    }</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <a class="code" href="structv__array.html">v_array&lt;uint32_t&gt;</a> selected_labs = v_init&lt;uint32_t&gt;();</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    ec.<a class="code" href="structexample.html#aec82f8fecc8ad2a13e54ecf83dfbc5c9">loss</a> = (float)<a class="code" href="namespacememory__tree__ns.html#a4a4a4185acca6cca507e1461a06c45e1">compute_hamming_loss_via_oas</a>(b, base, cn, ec, selected_labs);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a2581cc6feac4eea08949cf7ef59041cf">hamming_loss</a> += ec.<a class="code" href="structexample.html#aec82f8fecc8ad2a13e54ecf83dfbc5c9">loss</a>;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  }</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;}</div><div class="ttc" id="unionpolyprediction_html_abc57dae8f83df4756ff4f8ec910f0fd1"><div class="ttname"><a href="unionpolyprediction.html#abc57dae8f83df4756ff4f8ec910f0fd1">polyprediction::multiclass</a></div><div class="ttdeci">uint32_t multiclass</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00049">example.h:49</a></div></div>
<div class="ttc" id="structLEARNER_1_1learner_html_a8b4f75763c0ec9a26eb5255780e782a8"><div class="ttname"><a href="structLEARNER_1_1learner.html#a8b4f75763c0ec9a26eb5255780e782a8">LEARNER::learner::predict</a></div><div class="ttdeci">void predict(E &amp;ec, size_t i=0)</div><div class="ttdef"><b>Definition:</b> <a href="learner_8h_source.html#l00165">learner.h:165</a></div></div>
<div class="ttc" id="unionpolyprediction_html_ae29f42559acac5a2b08322a7fe887f04"><div class="ttname"><a href="unionpolyprediction.html#ae29f42559acac5a2b08322a7fe887f04">polyprediction::scalar</a></div><div class="ttdeci">float scalar</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00045">example.h:45</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_af030e33f21d4629b8c3c23128706f8b3"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#af030e33f21d4629b8c3c23128706f8b3">memory_tree_ns::memory_tree::num_mistakes</a></div><div class="ttdeci">uint32_t num_mistakes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00201">memory_tree.cc:201</a></div></div>
<div class="ttc" id="learner_8h_html_a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2"><div class="ttname"><a href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">prediction_type_t::multilabels</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a2581cc6feac4eea08949cf7ef59041cf"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a2581cc6feac4eea08949cf7ef59041cf">memory_tree_ns::memory_tree::hamming_loss</a></div><div class="ttdeci">float hamming_loss</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00216">memory_tree.cc:216</a></div></div>
<div class="ttc" id="unionpolylabel_html_a80ff268cb4e29afddaac58174d316297"><div class="ttname"><a href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">polylabel::simple</a></div><div class="ttdeci">label_data simple</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00027">example.h:27</a></div></div>
<div class="ttc" id="unionpolylabel_html_a68946a978546b21fc85fde38d6147399"><div class="ttname"><a href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">polylabel::multi</a></div><div class="ttdeci">MULTICLASS::label_t multi</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00028">example.h:28</a></div></div>
<div class="ttc" id="structMULTILABEL_1_1labels_html"><div class="ttname"><a href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a></div><div class="ttdef"><b>Definition:</b> <a href="multilabel_8h_source.html#l00012">multilabel.h:12</a></div></div>
<div class="ttc" id="global__data_8h_html_ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567"><div class="ttname"><a href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">label_type_t::mc</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a4a4a4185acca6cca507e1461a06c45e1"><div class="ttname"><a href="namespacememory__tree__ns.html#a4a4a4185acca6cca507e1461a06c45e1">memory_tree_ns::compute_hamming_loss_via_oas</a></div><div class="ttdeci">uint32_t compute_hamming_loss_via_oas(memory_tree &amp;b, single_learner &amp;base, const uint64_t cn, example &amp;ec, v_array&lt; uint32_t &gt; &amp;selected_labs)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00594">memory_tree.cc:594</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a6f1e18de5dec701d3cbe87ef47204640"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">memory_tree_ns::memory_tree::nodes</a></div><div class="ttdeci">v_array&lt; node &gt; nodes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00180">memory_tree.cc:180</a></div></div>
<div class="ttc" id="structMULTICLASS_1_1label__t_html_aa8b080653e3c08b5363152009728453d"><div class="ttname"><a href="structMULTICLASS_1_1label__t.html#aa8b080653e3c08b5363152009728453d">MULTICLASS::label_t::label</a></div><div class="ttdeci">uint32_t label</div><div class="ttdef"><b>Definition:</b> <a href="multiclass_8h_source.html#l00014">multiclass.h:14</a></div></div>
<div class="ttc" id="structexample_html_aec82f8fecc8ad2a13e54ecf83dfbc5c9"><div class="ttname"><a href="structexample.html#aec82f8fecc8ad2a13e54ecf83dfbc5c9">example::loss</a></div><div class="ttdeci">float loss</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00071">example.h:71</a></div></div>
<div class="ttc" id="structexample_html_a0c87f6e82d9c95ae42158bdbdab3acf5"><div class="ttname"><a href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">example::l</a></div><div class="ttdeci">polylabel l</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00058">example.h:58</a></div></div>
<div class="ttc" id="unionpolyprediction_html_a9f6a01eabbe81af8ec89f7af7ff5de3c"><div class="ttname"><a href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">polyprediction::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00050">example.h:50</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a80ed4155bf29ce66809ab34e364c74b8"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">memory_tree_ns::memory_tree::examples</a></div><div class="ttdeci">v_array&lt; example * &gt; examples</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00181">memory_tree.cc:181</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a83fcd57ae88e0cf7551df6a2ea81bb46"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">memory_tree_ns::memory_tree::oas</a></div><div class="ttdeci">bool oas</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00210">memory_tree.cc:210</a></div></div>
<div class="ttc" id="unionpolylabel_html_a999dc75a1e71967c36a817cead6bf3b2"><div class="ttname"><a href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">polylabel::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00034">example.h:34</a></div></div>
<div class="ttc" id="structMULTICLASS_1_1label__t_html"><div class="ttname"><a href="structMULTICLASS_1_1label__t.html">MULTICLASS::label_t</a></div><div class="ttdef"><b>Definition:</b> <a href="multiclass_8h_source.html#l00012">multiclass.h:12</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a8574c94638d3b4386ba0be942703575b"><div class="ttname"><a href="namespacememory__tree__ns.html#a8574c94638d3b4386ba0be942703575b">memory_tree_ns::pick_nearest</a></div><div class="ttdeci">int64_t pick_nearest(memory_tree &amp;b, single_learner &amp;base, const uint64_t cn, example &amp;ec)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00617">memory_tree.cc:617</a></div></div>
<div class="ttc" id="structexample_html_ad1477e890371ed8253f1953d4190ba49"><div class="ttname"><a href="structexample.html#ad1477e890371ed8253f1953d4190ba49">example::pred</a></div><div class="ttdeci">polyprediction pred</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00061">example.h:61</a></div></div>
<div class="ttc" id="structexample_html_a403be75fc4fdd058e4f7c1baf39be11a"><div class="ttname"><a href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">example::weight</a></div><div class="ttdeci">float weight</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00063">example.h:63</a></div></div>
<div class="ttc" id="structv__array_html"><div class="ttname"><a href="structv__array.html">v_array&lt; uint32_t &gt;</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_aab0e2adb1091013caea371f9b887d8c0"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#aab0e2adb1091013caea371f9b887d8c0">memory_tree_ns::memory_tree::F1_score</a></div><div class="ttdeci">float F1_score</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00215">memory_tree.cc:215</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_aad0642fc7ad41fc1bff3db10f6c7695c"><div class="ttname"><a href="namespacememory__tree__ns.html#aad0642fc7ad41fc1bff3db10f6c7695c">memory_tree_ns::F1_score_for_two_examples</a></div><div class="ttdeci">float F1_score_for_two_examples(example &amp;ec1, example &amp;ec2)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00660">memory_tree.cc:660</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af4ce818bfbbc0ffeddea9fb7baa64f0d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int memory_tree_ns::random_sample_example_pop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t &amp;&#160;</td>
          <td class="paramname"><em>cn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00338">338</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00178">memory_tree_ns::memory_tree::_random_state</a>, <a class="el" href="memory__tree_8cc_source.html#l00180">memory_tree_ns::memory_tree::nodes</a>, <a class="el" href="memory__tree_8cc_source.html#l00027">remove_at_index()</a>, and <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l01000">experience_replay()</a>.</p>
<div class="fragment"><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;{</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  cn = 0;  <span class="comment">// always start from the root:</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordflow">while</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].internal == 1)</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordtype">float</span> pred = 0.;              <span class="comment">// deal with some edge cases:</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nl &lt; 1)       <span class="comment">// no examples routed to left ever:</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      pred = 1.f;                 <span class="comment">// go right.</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nr &lt; 1)  <span class="comment">// no examples routed to right ever:</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      pred = -1.f;                <span class="comment">// go left.</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nl &gt;= 1) &amp;&amp; (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nr &gt;= 1))</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      pred = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a43960ae6e6fe6bca0b4d94ec783d658b">_random_state</a>-&gt;get_and_update_random() &lt; (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nl * 1. / (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nr + b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nl)) ? -1.f</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                                                                                                  : 1.f;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      std::cout &lt;&lt; cn &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nl &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nr &lt;&lt; std::endl;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Error:  nl = 0, and nr = 0, exit...&quot;</span>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      exit(0);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    }</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">if</span> (pred &lt; 0)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nl--;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      cn = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].left;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nr--;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      cn = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].right;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  }</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() &gt;= 1)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordtype">int</span> loc_at_leaf = int(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a43960ae6e6fe6bca0b4d94ec783d658b">_random_state</a>-&gt;get_and_update_random() * b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>());</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    uint32_t ec_id = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index[loc_at_leaf];</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <a class="code" href="namespacememory__tree__ns.html#a14ff4f5be3189ba9833680815e243e9d">remove_at_index</a>(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index, loc_at_leaf);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">return</span> ec_id;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;}</div><div class="ttc" id="namespacememory__tree__ns_html_a14ff4f5be3189ba9833680815e243e9d"><div class="ttname"><a href="namespacememory__tree__ns.html#a14ff4f5be3189ba9833680815e243e9d">memory_tree_ns::remove_at_index</a></div><div class="ttdeci">void remove_at_index(v_array&lt; T &gt; &amp;array, uint32_t index)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00027">memory_tree.cc:27</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a6f1e18de5dec701d3cbe87ef47204640"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">memory_tree_ns::memory_tree::nodes</a></div><div class="ttdeci">v_array&lt; node &gt; nodes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00180">memory_tree.cc:180</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a43960ae6e6fe6bca0b4d94ec783d658b"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a43960ae6e6fe6bca0b4d94ec783d658b">memory_tree_ns::memory_tree::_random_state</a></div><div class="ttdeci">std::shared_ptr&lt; rand_state &gt; _random_state</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00178">memory_tree.cc:178</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a14ff4f5be3189ba9833680815e243e9d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::remove_at_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structv__array.html">v_array</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00027">27</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="v__array_8h_source.html#l00056">v_array&lt; T &gt;::pop()</a>, and <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00338">random_sample_example_pop()</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordflow">if</span> (index &gt;= array.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>())</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  {</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;ERROR: index is larger than the size&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  }</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordflow">if</span> (index == array.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() - 1)</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  {</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    array.<a class="code" href="structv__array.html#aab57c8e60560b774715c19e95cf76c8f">pop</a>();</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  }</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = index + 1; i &lt; array.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>(); i++)</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    array[i - 1] = array[i];</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  }</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  array.<a class="code" href="structv__array.html#aab57c8e60560b774715c19e95cf76c8f">pop</a>();</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div><div class="ttc" id="structv__array_html_aab57c8e60560b774715c19e95cf76c8f"><div class="ttname"><a href="structv__array.html#aab57c8e60560b774715c19e95cf76c8f">v_array::pop</a></div><div class="ttdeci">T pop()</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00056">v_array.h:56</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a37334ee454f980c3f87ad853ecb61413"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float memory_tree_ns::return_reward_from_node </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>cn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> &amp;&#160;</td>
          <td class="paramname"><em>ec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>weight</em> = <code>1.<a class="el" href="cache_8cc.html#af900396d7b72ff2a7002e8befe8cf8f1">f</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>learn the inference procedure anyway </p>

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00739">739</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00105">diag_kronecker_product_test()</a>, <a class="el" href="memory__tree_8cc_source.html#l00181">memory_tree_ns::memory_tree::examples</a>, <a class="el" href="memory__tree_8cc_source.html#l00660">F1_score_for_two_examples()</a>, <a class="el" href="memory__tree_8cc_source.html#l00218">memory_tree_ns::memory_tree::kprod_ec</a>, <a class="el" href="example_8h_source.html#l00058">example::l</a>, <a class="el" href="multiclass_8h_source.html#l00014">MULTICLASS::label_t::label</a>, <a class="el" href="learner_8h_source.html#l00156">LEARNER::learner&lt; T, E &gt;::learn()</a>, <a class="el" href="memory__tree_8cc_source.html#l00202">memory_tree_ns::memory_tree::learn_at_leaf</a>, <a class="el" href="memory__tree_8cc_source.html#l00186">memory_tree_ns::memory_tree::max_routers</a>, <a class="el" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>, <a class="el" href="example_8h_source.html#l00028">polylabel::multi</a>, <a class="el" href="example_8h_source.html#l00049">polyprediction::multiclass</a>, <a class="el" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>, <a class="el" href="example_8h_source.html#l00034">polylabel::multilabels</a>, <a class="el" href="example_8h_source.html#l00050">polyprediction::multilabels</a>, <a class="el" href="memory__tree_8cc_source.html#l00180">memory_tree_ns::memory_tree::nodes</a>, <a class="el" href="memory__tree_8cc_source.html#l00274">normalized_linear_prod()</a>, <a class="el" href="memory__tree_8cc_source.html#l00210">memory_tree_ns::memory_tree::oas</a>, <a class="el" href="memory__tree_8cc_source.html#l00617">pick_nearest()</a>, <a class="el" href="example_8h_source.html#l00061">example::pred</a>, <a class="el" href="learner_8h_source.html#l00165">LEARNER::learner&lt; T, E &gt;::predict()</a>, <a class="el" href="example_8h_source.html#l00045">polyprediction::scalar</a>, <a class="el" href="example_8h_source.html#l00027">polylabel::simple</a>, <a class="el" href="memory__tree_8cc_source.html#l00193">memory_tree_ns::memory_tree::total_num_queries</a>, <a class="el" href="memory__tree_8cc_source.html#l00576">train_one_against_some_at_leaf()</a>, and <a class="el" href="example_8h_source.html#l00063">example::weight</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00885">single_query_and_learn()</a>.</p>
<div class="fragment"><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;{</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="comment">// example&amp; ec = *b.examples[ec_array_index];</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <a class="code" href="structMULTICLASS_1_1label__t.html">MULTICLASS::label_t</a> <a class="code" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  uint32_t save_multi_pred = 0;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <a class="code" href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a> <a class="code" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <a class="code" href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a> preds;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    mc = ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">multi</a>;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    save_multi_pred = ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#abc57dae8f83df4756ff4f8ec910f0fd1">multiclass</a>;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  }</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  {</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    multilabels = ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    preds = ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">multilabels</a>;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  }</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">simple</a> = {FLT_MAX, 1., 0.0};</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="keywordflow">while</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].internal != -1)</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  {</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    base.<a class="code" href="structLEARNER_1_1learner.html#a8b4f75763c0ec9a26eb5255780e782a8">predict</a>(ec, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].base_router);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordtype">float</span> prediction = ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#ae29f42559acac5a2b08322a7fe887f04">scalar</a>;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    cn = prediction &lt; 0 ? b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].left : b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].right;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  }</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  {</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">multi</a> = <a class="code" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#abc57dae8f83df4756ff4f8ec910f0fd1">multiclass</a> = save_multi_pred;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  }</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  {</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">multilabels</a> = preds;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a> = <a class="code" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="comment">// get to leaf now:</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  int64_t closest_ec = 0;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="keywordtype">float</span> reward = 0.f;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  closest_ec = <a class="code" href="namespacememory__tree__ns.html#a8574c94638d3b4386ba0be942703575b">pick_nearest</a>(b, base, cn, ec);  <span class="comment">// no randomness for picking example.</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  {</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">if</span> ((closest_ec != -1) &amp;&amp; (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[closest_ec]-&gt;l.multi.label == ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">multi</a>.<a class="code" href="structMULTICLASS_1_1label__t.html#aa8b080653e3c08b5363152009728453d">label</a>))</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      reward = 1.f;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  }</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  {</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordflow">if</span> (closest_ec != -1)</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      reward = <a class="code" href="namespacememory__tree__ns.html#aad0642fc7ad41fc1bff3db10f6c7695c">F1_score_for_two_examples</a>(ec, *b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[closest_ec]);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  }</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a9bee7278ec707749e7b8eb40d9715892">total_num_queries</a>++;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab6b65098687f9c3bd37c925fd932f32a">learn_at_leaf</a> == <span class="keyword">true</span> &amp;&amp; closest_ec != -1)</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  {</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordtype">float</span> score = <a class="code" href="namespacememory__tree__ns.html#a30cdcc95dfc069080971ca5fc83cc40b">normalized_linear_prod</a>(b, &amp;ec, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[closest_ec]);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <a class="code" href="namespacememory__tree__ns.html#ad57d1c053bf5098292a4820b8f4af607">diag_kronecker_product_test</a>(ec, *b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[closest_ec], *b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aba4ccb0892bda7b4b1ffe37f4b9a2f11">kprod_ec</a>, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a>);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aba4ccb0892bda7b4b1ffe37f4b9a2f11">kprod_ec</a>-&gt;<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">simple</a> = {reward, 1.f, -score};</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aba4ccb0892bda7b4b1ffe37f4b9a2f11">kprod_ec</a>-&gt;<a class="code" href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">weight</a> = <a class="code" href="array__parameters__dense_8h.html#a4d04a2043fa7480d905108e63adb0bab">weight</a>;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    base.<a class="code" href="structLEARNER_1_1learner.html#a9984332080a6ee4730a5762e9be3a3f6">learn</a>(*b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aba4ccb0892bda7b4b1ffe37f4b9a2f11">kprod_ec</a>, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aee12725de055582f62c270a2d5b4d7b3">max_routers</a>);</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  }</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">true</span>)</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <a class="code" href="namespacememory__tree__ns.html#a27aad0e7fea7b74c8efa7961a6fd5a17">train_one_against_some_at_leaf</a>(b, base, cn, ec);  </div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="keywordflow">return</span> reward;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;}</div><div class="ttc" id="unionpolyprediction_html_abc57dae8f83df4756ff4f8ec910f0fd1"><div class="ttname"><a href="unionpolyprediction.html#abc57dae8f83df4756ff4f8ec910f0fd1">polyprediction::multiclass</a></div><div class="ttdeci">uint32_t multiclass</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00049">example.h:49</a></div></div>
<div class="ttc" id="structLEARNER_1_1learner_html_a8b4f75763c0ec9a26eb5255780e782a8"><div class="ttname"><a href="structLEARNER_1_1learner.html#a8b4f75763c0ec9a26eb5255780e782a8">LEARNER::learner::predict</a></div><div class="ttdeci">void predict(E &amp;ec, size_t i=0)</div><div class="ttdef"><b>Definition:</b> <a href="learner_8h_source.html#l00165">learner.h:165</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a9bee7278ec707749e7b8eb40d9715892"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a9bee7278ec707749e7b8eb40d9715892">memory_tree_ns::memory_tree::total_num_queries</a></div><div class="ttdeci">uint32_t total_num_queries</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00193">memory_tree.cc:193</a></div></div>
<div class="ttc" id="unionpolyprediction_html_ae29f42559acac5a2b08322a7fe887f04"><div class="ttname"><a href="unionpolyprediction.html#ae29f42559acac5a2b08322a7fe887f04">polyprediction::scalar</a></div><div class="ttdeci">float scalar</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00045">example.h:45</a></div></div>
<div class="ttc" id="learner_8h_html_a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2"><div class="ttname"><a href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">prediction_type_t::multilabels</a></div></div>
<div class="ttc" id="unionpolylabel_html_a80ff268cb4e29afddaac58174d316297"><div class="ttname"><a href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">polylabel::simple</a></div><div class="ttdeci">label_data simple</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00027">example.h:27</a></div></div>
<div class="ttc" id="unionpolylabel_html_a68946a978546b21fc85fde38d6147399"><div class="ttname"><a href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">polylabel::multi</a></div><div class="ttdeci">MULTICLASS::label_t multi</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00028">example.h:28</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_ad57d1c053bf5098292a4820b8f4af607"><div class="ttname"><a href="namespacememory__tree__ns.html#ad57d1c053bf5098292a4820b8f4af607">memory_tree_ns::diag_kronecker_product_test</a></div><div class="ttdeci">void diag_kronecker_product_test(example &amp;ec1, example &amp;ec2, example &amp;ec, bool oas=false)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00105">memory_tree.cc:105</a></div></div>
<div class="ttc" id="structMULTILABEL_1_1labels_html"><div class="ttname"><a href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a></div><div class="ttdef"><b>Definition:</b> <a href="multilabel_8h_source.html#l00012">multilabel.h:12</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a30cdcc95dfc069080971ca5fc83cc40b"><div class="ttname"><a href="namespacememory__tree__ns.html#a30cdcc95dfc069080971ca5fc83cc40b">memory_tree_ns::normalized_linear_prod</a></div><div class="ttdeci">float normalized_linear_prod(memory_tree &amp;b, example *ec1, example *ec2)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00274">memory_tree.cc:274</a></div></div>
<div class="ttc" id="global__data_8h_html_ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567"><div class="ttname"><a href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">label_type_t::mc</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a6f1e18de5dec701d3cbe87ef47204640"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">memory_tree_ns::memory_tree::nodes</a></div><div class="ttdeci">v_array&lt; node &gt; nodes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00180">memory_tree.cc:180</a></div></div>
<div class="ttc" id="structMULTICLASS_1_1label__t_html_aa8b080653e3c08b5363152009728453d"><div class="ttname"><a href="structMULTICLASS_1_1label__t.html#aa8b080653e3c08b5363152009728453d">MULTICLASS::label_t::label</a></div><div class="ttdeci">uint32_t label</div><div class="ttdef"><b>Definition:</b> <a href="multiclass_8h_source.html#l00014">multiclass.h:14</a></div></div>
<div class="ttc" id="array__parameters__dense_8h_html_a4d04a2043fa7480d905108e63adb0bab"><div class="ttname"><a href="array__parameters__dense_8h.html#a4d04a2043fa7480d905108e63adb0bab">weight</a></div><div class="ttdeci">float weight</div><div class="ttdef"><b>Definition:</b> <a href="array__parameters__dense_8h_source.html#l00010">array_parameters_dense.h:10</a></div></div>
<div class="ttc" id="structexample_html_a0c87f6e82d9c95ae42158bdbdab3acf5"><div class="ttname"><a href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">example::l</a></div><div class="ttdeci">polylabel l</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00058">example.h:58</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_ab6b65098687f9c3bd37c925fd932f32a"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#ab6b65098687f9c3bd37c925fd932f32a">memory_tree_ns::memory_tree::learn_at_leaf</a></div><div class="ttdeci">bool learn_at_leaf</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00202">memory_tree.cc:202</a></div></div>
<div class="ttc" id="unionpolyprediction_html_a9f6a01eabbe81af8ec89f7af7ff5de3c"><div class="ttname"><a href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">polyprediction::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00050">example.h:50</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a80ed4155bf29ce66809ab34e364c74b8"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">memory_tree_ns::memory_tree::examples</a></div><div class="ttdeci">v_array&lt; example * &gt; examples</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00181">memory_tree.cc:181</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a83fcd57ae88e0cf7551df6a2ea81bb46"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">memory_tree_ns::memory_tree::oas</a></div><div class="ttdeci">bool oas</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00210">memory_tree.cc:210</a></div></div>
<div class="ttc" id="unionpolylabel_html_a999dc75a1e71967c36a817cead6bf3b2"><div class="ttname"><a href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">polylabel::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00034">example.h:34</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a27aad0e7fea7b74c8efa7961a6fd5a17"><div class="ttname"><a href="namespacememory__tree__ns.html#a27aad0e7fea7b74c8efa7961a6fd5a17">memory_tree_ns::train_one_against_some_at_leaf</a></div><div class="ttdeci">void train_one_against_some_at_leaf(memory_tree &amp;b, single_learner &amp;base, const uint64_t cn, example &amp;ec)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00576">memory_tree.cc:576</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_aba4ccb0892bda7b4b1ffe37f4b9a2f11"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#aba4ccb0892bda7b4b1ffe37f4b9a2f11">memory_tree_ns::memory_tree::kprod_ec</a></div><div class="ttdeci">example * kprod_ec</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00218">memory_tree.cc:218</a></div></div>
<div class="ttc" id="structMULTICLASS_1_1label__t_html"><div class="ttname"><a href="structMULTICLASS_1_1label__t.html">MULTICLASS::label_t</a></div><div class="ttdef"><b>Definition:</b> <a href="multiclass_8h_source.html#l00012">multiclass.h:12</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a8574c94638d3b4386ba0be942703575b"><div class="ttname"><a href="namespacememory__tree__ns.html#a8574c94638d3b4386ba0be942703575b">memory_tree_ns::pick_nearest</a></div><div class="ttdeci">int64_t pick_nearest(memory_tree &amp;b, single_learner &amp;base, const uint64_t cn, example &amp;ec)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00617">memory_tree.cc:617</a></div></div>
<div class="ttc" id="structexample_html_ad1477e890371ed8253f1953d4190ba49"><div class="ttname"><a href="structexample.html#ad1477e890371ed8253f1953d4190ba49">example::pred</a></div><div class="ttdeci">polyprediction pred</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00061">example.h:61</a></div></div>
<div class="ttc" id="structLEARNER_1_1learner_html_a9984332080a6ee4730a5762e9be3a3f6"><div class="ttname"><a href="structLEARNER_1_1learner.html#a9984332080a6ee4730a5762e9be3a3f6">LEARNER::learner::learn</a></div><div class="ttdeci">void learn(E &amp;ec, size_t i=0)</div><div class="ttdef"><b>Definition:</b> <a href="learner_8h_source.html#l00156">learner.h:156</a></div></div>
<div class="ttc" id="structexample_html_a403be75fc4fdd058e4f7c1baf39be11a"><div class="ttname"><a href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">example::weight</a></div><div class="ttdeci">float weight</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00063">example.h:63</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_aee12725de055582f62c270a2d5b4d7b3"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#aee12725de055582f62c270a2d5b4d7b3">memory_tree_ns::memory_tree::max_routers</a></div><div class="ttdeci">size_t max_routers</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00186">memory_tree.cc:186</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_aad0642fc7ad41fc1bff3db10f6c7695c"><div class="ttname"><a href="namespacememory__tree__ns.html#aad0642fc7ad41fc1bff3db10f6c7695c">memory_tree_ns::F1_score_for_two_examples</a></div><div class="ttdeci">float F1_score_for_two_examples(example &amp;ec1, example &amp;ec2)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00660">memory_tree.cc:660</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a28b68857ebf69c2e6cf472da206808ca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::route_to_leaf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t &amp;&#160;</td>
          <td class="paramname"><em>ec_array_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>cn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structv__array.html">v_array</a>&lt; uint64_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>insertion</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00830">830</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="v__array_8h_source.html#l00086">v_array&lt; T &gt;::clear()</a>, <a class="el" href="memory__tree_8cc_source.html#l00181">memory_tree_ns::memory_tree::examples</a>, <a class="el" href="memory__tree_8cc_source.html#l00322">insert_descent()</a>, <a class="el" href="example_8h_source.html#l00058">example::l</a>, <a class="el" href="memory__tree_8cc_source.html#l00183">memory_tree_ns::memory_tree::max_leaf_examples</a>, <a class="el" href="memory__tree_8cc_source.html#l00184">memory_tree_ns::memory_tree::max_nodes</a>, <a class="el" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>, <a class="el" href="example_8h_source.html#l00028">polylabel::multi</a>, <a class="el" href="example_8h_source.html#l00049">polyprediction::multiclass</a>, <a class="el" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>, <a class="el" href="example_8h_source.html#l00034">polylabel::multilabels</a>, <a class="el" href="example_8h_source.html#l00050">polyprediction::multilabels</a>, <a class="el" href="memory__tree_8cc_source.html#l00180">memory_tree_ns::memory_tree::nodes</a>, <a class="el" href="memory__tree_8cc_source.html#l00210">memory_tree_ns::memory_tree::oas</a>, <a class="el" href="example_8h_source.html#l00061">example::pred</a>, <a class="el" href="learner_8h_source.html#l00165">LEARNER::learner&lt; T, E &gt;::predict()</a>, <a class="el" href="v__array_8h_source.html#l00105">v_array&lt; T &gt;::push_back()</a>, <a class="el" href="example_8h_source.html#l00045">polyprediction::scalar</a>, <a class="el" href="example_8h_source.html#l00027">polylabel::simple</a>, <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>, and <a class="el" href="memory__tree_8cc_source.html#l00437">split_leaf()</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l01000">experience_replay()</a>, and <a class="el" href="memory__tree_8cc_source.html#l00885">single_query_and_learn()</a>.</p>
<div class="fragment"><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;{</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <a class="code" href="structexample.html">example</a>&amp; ec = *b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_array_index];</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <a class="code" href="structMULTICLASS_1_1label__t.html">MULTICLASS::label_t</a> <a class="code" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  uint32_t save_multi_pred = 0;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <a class="code" href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a> <a class="code" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <a class="code" href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a> preds;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  {</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    mc = ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">multi</a>;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    save_multi_pred = ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#abc57dae8f83df4756ff4f8ec910f0fd1">multiclass</a>;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  }</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  {</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    multilabels = ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    preds = ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">multilabels</a>;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  }</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  path.<a class="code" href="structv__array.html#aab10f7f1ac8ad24a8dc0b112fed415ef">clear</a>();</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">simple</a> = {FLT_MAX, 1.0, 0.0};</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="keywordflow">while</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].internal != -1)</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  {</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    path.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(cn);  <span class="comment">// path stores node id from the root to the leaf</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    base.<a class="code" href="structLEARNER_1_1learner.html#a8b4f75763c0ec9a26eb5255780e782a8">predict</a>(ec, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].base_router);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordtype">float</span> prediction = ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#ae29f42559acac5a2b08322a7fe887f04">scalar</a>;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordflow">if</span> (insertion == <span class="keyword">false</span>)</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      cn = prediction &lt; 0 ? b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].left : b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].right;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      cn = <a class="code" href="namespacememory__tree__ns.html#aa544f428dd64b385a63b962e9b1ed2a8">insert_descent</a>(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn], prediction);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  }</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  path.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(cn);  <span class="comment">// push back the leaf</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  {</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">multi</a> = <a class="code" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#abc57dae8f83df4756ff4f8ec910f0fd1">multiclass</a> = save_multi_pred;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  }</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  {</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">multilabels</a> = preds;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a> = <a class="code" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  }</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="comment">// std::cout&lt;&lt;&quot;at route to leaf: &quot;&lt;&lt;path.size()&lt;&lt; std::endl;</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keywordflow">if</span> (insertion == <span class="keyword">true</span>)</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  {</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(ec_array_index);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordflow">if</span> ((b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() &gt;= b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aa13cd8947a499ed9c33af3d58fbb4993">max_leaf_examples</a>) &amp;&amp; (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() + 2 &lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a070cc6088b8fd42530bb96c53e21aca7">max_nodes</a>))</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      <a class="code" href="namespacememory__tree__ns.html#a86e4abca95dc1304004eac3b4648bd05">split_leaf</a>(b, base, cn);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  }</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;}</div><div class="ttc" id="unionpolyprediction_html_abc57dae8f83df4756ff4f8ec910f0fd1"><div class="ttname"><a href="unionpolyprediction.html#abc57dae8f83df4756ff4f8ec910f0fd1">polyprediction::multiclass</a></div><div class="ttdeci">uint32_t multiclass</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00049">example.h:49</a></div></div>
<div class="ttc" id="structLEARNER_1_1learner_html_a8b4f75763c0ec9a26eb5255780e782a8"><div class="ttname"><a href="structLEARNER_1_1learner.html#a8b4f75763c0ec9a26eb5255780e782a8">LEARNER::learner::predict</a></div><div class="ttdeci">void predict(E &amp;ec, size_t i=0)</div><div class="ttdef"><b>Definition:</b> <a href="learner_8h_source.html#l00165">learner.h:165</a></div></div>
<div class="ttc" id="unionpolyprediction_html_ae29f42559acac5a2b08322a7fe887f04"><div class="ttname"><a href="unionpolyprediction.html#ae29f42559acac5a2b08322a7fe887f04">polyprediction::scalar</a></div><div class="ttdeci">float scalar</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00045">example.h:45</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a86e4abca95dc1304004eac3b4648bd05"><div class="ttname"><a href="namespacememory__tree__ns.html#a86e4abca95dc1304004eac3b4648bd05">memory_tree_ns::split_leaf</a></div><div class="ttdeci">void split_leaf(memory_tree &amp;b, single_learner &amp;base, const uint64_t cn)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00437">memory_tree.cc:437</a></div></div>
<div class="ttc" id="learner_8h_html_a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2"><div class="ttname"><a href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">prediction_type_t::multilabels</a></div></div>
<div class="ttc" id="unionpolylabel_html_a80ff268cb4e29afddaac58174d316297"><div class="ttname"><a href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">polylabel::simple</a></div><div class="ttdeci">label_data simple</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00027">example.h:27</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_aa544f428dd64b385a63b962e9b1ed2a8"><div class="ttname"><a href="namespacememory__tree__ns.html#aa544f428dd64b385a63b962e9b1ed2a8">memory_tree_ns::insert_descent</a></div><div class="ttdeci">uint64_t insert_descent(node &amp;n, const float prediction)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00322">memory_tree.cc:322</a></div></div>
<div class="ttc" id="unionpolylabel_html_a68946a978546b21fc85fde38d6147399"><div class="ttname"><a href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">polylabel::multi</a></div><div class="ttdeci">MULTICLASS::label_t multi</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00028">example.h:28</a></div></div>
<div class="ttc" id="structMULTILABEL_1_1labels_html"><div class="ttname"><a href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a></div><div class="ttdef"><b>Definition:</b> <a href="multilabel_8h_source.html#l00012">multilabel.h:12</a></div></div>
<div class="ttc" id="structv__array_html_afd6a4614f027ac5f786507552ce13f13"><div class="ttname"><a href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">v_array::push_back</a></div><div class="ttdeci">void push_back(const T &amp;new_ele)</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00105">v_array.h:105</a></div></div>
<div class="ttc" id="global__data_8h_html_ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567"><div class="ttname"><a href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">label_type_t::mc</a></div></div>
<div class="ttc" id="structv__array_html_aab10f7f1ac8ad24a8dc0b112fed415ef"><div class="ttname"><a href="structv__array.html#aab10f7f1ac8ad24a8dc0b112fed415ef">v_array::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00086">v_array.h:86</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a6f1e18de5dec701d3cbe87ef47204640"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">memory_tree_ns::memory_tree::nodes</a></div><div class="ttdeci">v_array&lt; node &gt; nodes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00180">memory_tree.cc:180</a></div></div>
<div class="ttc" id="structexample_html"><div class="ttname"><a href="structexample.html">example</a></div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00055">example.h:55</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_aa13cd8947a499ed9c33af3d58fbb4993"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#aa13cd8947a499ed9c33af3d58fbb4993">memory_tree_ns::memory_tree::max_leaf_examples</a></div><div class="ttdeci">size_t max_leaf_examples</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00183">memory_tree.cc:183</a></div></div>
<div class="ttc" id="structexample_html_a0c87f6e82d9c95ae42158bdbdab3acf5"><div class="ttname"><a href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">example::l</a></div><div class="ttdeci">polylabel l</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00058">example.h:58</a></div></div>
<div class="ttc" id="unionpolyprediction_html_a9f6a01eabbe81af8ec89f7af7ff5de3c"><div class="ttname"><a href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">polyprediction::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00050">example.h:50</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a80ed4155bf29ce66809ab34e364c74b8"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">memory_tree_ns::memory_tree::examples</a></div><div class="ttdeci">v_array&lt; example * &gt; examples</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00181">memory_tree.cc:181</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a070cc6088b8fd42530bb96c53e21aca7"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a070cc6088b8fd42530bb96c53e21aca7">memory_tree_ns::memory_tree::max_nodes</a></div><div class="ttdeci">size_t max_nodes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00184">memory_tree.cc:184</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a83fcd57ae88e0cf7551df6a2ea81bb46"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">memory_tree_ns::memory_tree::oas</a></div><div class="ttdeci">bool oas</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00210">memory_tree.cc:210</a></div></div>
<div class="ttc" id="unionpolylabel_html_a999dc75a1e71967c36a817cead6bf3b2"><div class="ttname"><a href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">polylabel::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00034">example.h:34</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
<div class="ttc" id="structMULTICLASS_1_1label__t_html"><div class="ttname"><a href="structMULTICLASS_1_1label__t.html">MULTICLASS::label_t</a></div><div class="ttdef"><b>Definition:</b> <a href="multiclass_8h_source.html#l00012">multiclass.h:12</a></div></div>
<div class="ttc" id="structexample_html_ad1477e890371ed8253f1953d4190ba49"><div class="ttname"><a href="structexample.html#ad1477e890371ed8253f1953d4190ba49">example::pred</a></div><div class="ttdeci">polyprediction pred</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00061">example.h:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aceee1ab2c3c2184c26d2b287edce1bcb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::save_load_example </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> *&#160;</td>
          <td class="paramname"><em>ec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classio__buf.html">io_buf</a> &amp;&#160;</td>
          <td class="paramname"><em>model_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::stringstream &amp;&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>oas</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l01090">1090</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="v__array_8h_source.html#l00086">v_array&lt; T &gt;::clear()</a>, <a class="el" href="feature__group_8h_source.html#l00355">features::clear()</a>, <a class="el" href="v__array_8h_source.html#l00096">v_array&lt; T &gt;::delete_v()</a>, <a class="el" href="example__predict_8h_source.html#l00039">example_predict::feature_space</a>, <a class="el" href="example__predict_8h_source.html#l00040">example_predict::ft_offset</a>, <a class="el" href="example__predict_8h_source.html#l00038">example_predict::indices</a>, <a class="el" href="feature__group_8h_source.html#l00251">features::indicies</a>, <a class="el" href="example_8h_source.html#l00058">example::l</a>, <a class="el" href="multiclass_8h_source.html#l00014">MULTICLASS::label_t::label</a>, <a class="el" href="multilabel_8h_source.html#l00014">MULTILABEL::labels::label_v</a>, <a class="el" href="example_8h_source.html#l00071">example::loss</a>, <a class="el" href="example_8h_source.html#l00028">polylabel::multi</a>, <a class="el" href="example_8h_source.html#l00034">polylabel::multilabels</a>, <a class="el" href="example_8h_source.html#l00068">example::num_features</a>, <a class="el" href="v__array_8h_source.html#l00105">v_array&lt; T &gt;::push_back()</a>, <a class="el" href="feature__group_8h_source.html#l00388">features::push_back()</a>, <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>, <a class="el" href="feature__group_8h_source.html#l00339">features::size()</a>, <a class="el" href="example_8h_source.html#l00064">example::tag</a>, <a class="el" href="example_8h_source.html#l00072">example::total_sum_feat_sq</a>, <a class="el" href="feature__group_8h_source.html#l00250">features::values</a>, <a class="el" href="multiclass_8h_source.html#l00015">MULTICLASS::label_t::weight</a>, <a class="el" href="example_8h_source.html#l00063">example::weight</a>, <a class="el" href="io__buf_8h_source.html#l00347">writeit</a>, and <a class="el" href="io__buf_8h_source.html#l00354">writeitvar</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l01173">save_load_memory_tree()</a>.</p>
<div class="fragment"><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;{  <span class="comment">// deal with tag</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;   <span class="comment">// deal with labels:</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(ec-&gt;<a class="code" href="structexample.html#a35f3ec2680a21f971548cf5bb9f1fda0">num_features</a>, <span class="stringliteral">&quot;num_features&quot;</span>);</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(ec-&gt;<a class="code" href="structexample.html#ad434838ba5443d5f6b5529558d5c1a8c">total_sum_feat_sq</a>, <span class="stringliteral">&quot;total_sum_features&quot;</span>);</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(ec-&gt;<a class="code" href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">weight</a>, <span class="stringliteral">&quot;example_weight&quot;</span>);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(ec-&gt;<a class="code" href="structexample.html#aec82f8fecc8ad2a13e54ecf83dfbc5c9">loss</a>, <span class="stringliteral">&quot;loss&quot;</span>);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(ec-&gt;<a class="code" href="structexample__predict.html#a964a7741ec79edbb2e7e2298ffdd767a">ft_offset</a>, <span class="stringliteral">&quot;ft_offset&quot;</span>);</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="keywordflow">if</span> (oas == <span class="keyword">false</span>)</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  {  <span class="comment">// multi-class</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(ec-&gt;<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">multi</a>.<a class="code" href="structMULTICLASS_1_1label__t.html#aa8b080653e3c08b5363152009728453d">label</a>, <span class="stringliteral">&quot;multiclass_label&quot;</span>);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(ec-&gt;<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">multi</a>.<a class="code" href="structMULTICLASS_1_1label__t.html#a0055ecea2640500fb7c8e88f566142e5">weight</a>, <span class="stringliteral">&quot;multiclass_weight&quot;</span>);</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  }</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  {  <span class="comment">// multi-label</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <a class="code" href="io__buf_8h.html#aa441214d84044fca62cc7341883b7843">writeitvar</a>(ec-&gt;<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>.<a class="code" href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">label_v</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>(), <span class="stringliteral">&quot;label_size&quot;</span>, label_size);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">if</span> (read)</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    {</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      ec-&gt;<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>.<a class="code" href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">label_v</a>.<a class="code" href="structv__array.html#aab10f7f1ac8ad24a8dc0b112fed415ef">clear</a>();</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; label_size; i++) ec-&gt;<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>.<a class="code" href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">label_v</a>.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(0);</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    }</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; label_size; i++) <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(ec-&gt;<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>.<a class="code" href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">label_v</a>[i], <span class="stringliteral">&quot;ec_label&quot;</span>);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  }</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <a class="code" href="io__buf_8h.html#aa441214d84044fca62cc7341883b7843">writeitvar</a>(ec-&gt;<a class="code" href="structexample.html#ae05e98faef8389156ebb6d8f823ca378">tag</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>(), <span class="stringliteral">&quot;tags&quot;</span>, tag_number);</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <span class="keywordflow">if</span> (read)</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  {</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    ec-&gt;<a class="code" href="structexample.html#ae05e98faef8389156ebb6d8f823ca378">tag</a>.<a class="code" href="structv__array.html#aab10f7f1ac8ad24a8dc0b112fed415ef">clear</a>();</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; tag_number; i++) ec-&gt;<a class="code" href="structexample.html#ae05e98faef8389156ebb6d8f823ca378">tag</a>.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(<span class="charliteral">&#39;a&#39;</span>);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  }</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; tag_number; i++) <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(ec-&gt;<a class="code" href="structexample.html#ae05e98faef8389156ebb6d8f823ca378">tag</a>[i], <span class="stringliteral">&quot;tag&quot;</span>);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  <span class="comment">// deal with tag:</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <a class="code" href="io__buf_8h.html#aa441214d84044fca62cc7341883b7843">writeitvar</a>(ec-&gt;<a class="code" href="structexample__predict.html#ab098b66eb3c24b20ca349b7908ef54f3">indices</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>(), <span class="stringliteral">&quot;namespaces&quot;</span>, namespace_size);</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <span class="keywordflow">if</span> (read)</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  {</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    ec-&gt;<a class="code" href="structexample__predict.html#ab098b66eb3c24b20ca349b7908ef54f3">indices</a>.<a class="code" href="structv__array.html#a81c7c9af1948bd97850eb06785f2254f">delete_v</a>();</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; namespace_size; i++)</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    {</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      ec-&gt;<a class="code" href="structexample__predict.html#ab098b66eb3c24b20ca349b7908ef54f3">indices</a>.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(<span class="charliteral">&#39;\0&#39;</span>);</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    }</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  }</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; namespace_size; i++) <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(ec-&gt;<a class="code" href="structexample__predict.html#ab098b66eb3c24b20ca349b7908ef54f3">indices</a>[i], <span class="stringliteral">&quot;namespace_index&quot;</span>);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <span class="comment">// deal with features</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="example__predict_8h.html#a3302327c8e16f985dd6c4474bf279c40">namespace_index</a> nc : ec-&gt;<a class="code" href="structexample__predict.html#ab098b66eb3c24b20ca349b7908ef54f3">indices</a>)</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  {</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <a class="code" href="structfeatures.html">features</a>* fs = &amp;ec-&gt;<a class="code" href="structexample__predict.html#a59f24cbe1603a24ae5812b7d262f3668">feature_space</a>[nc];</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <a class="code" href="io__buf_8h.html#aa441214d84044fca62cc7341883b7843">writeitvar</a>(fs-&gt;<a class="code" href="structfeatures.html#a026320c3cb110571f0c07da05c8dbea3">size</a>(), <span class="stringliteral">&quot;features_&quot;</span>, feat_size);</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keywordflow">if</span> (read)</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    {</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      fs-&gt;<a class="code" href="structfeatures.html#a4bc967f302cfb466681a6b4c331bf33a">clear</a>();</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;      fs-&gt;<a class="code" href="structfeatures.html#a12befb364b2dcda6f052c9e794ac68e4">values</a> = v_init&lt;feature_value&gt;();</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      fs-&gt;<a class="code" href="structfeatures.html#a2d75751cdcc865b5e62031d40a770a6a">indicies</a> = v_init&lt;feature_index&gt;();</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      <span class="keywordflow">for</span> (uint32_t f_i = 0; f_i &lt; feat_size; f_i++)</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      {</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        fs-&gt;<a class="code" href="structfeatures.html#ad204b1a4e0ca9b16b5db3b6261c14423">push_back</a>(0, 0);</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      }</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    }</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="keywordflow">for</span> (uint32_t f_i = 0; f_i &lt; feat_size; f_i++) <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(fs-&gt;<a class="code" href="structfeatures.html#a12befb364b2dcda6f052c9e794ac68e4">values</a>[f_i], <span class="stringliteral">&quot;value&quot;</span>);</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="keywordflow">for</span> (uint32_t f_i = 0; f_i &lt; feat_size; f_i++) <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(fs-&gt;<a class="code" href="structfeatures.html#a2d75751cdcc865b5e62031d40a770a6a">indicies</a>[f_i], <span class="stringliteral">&quot;index&quot;</span>);</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  }</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;}</div><div class="ttc" id="structexample_html_ae05e98faef8389156ebb6d8f823ca378"><div class="ttname"><a href="structexample.html#ae05e98faef8389156ebb6d8f823ca378">example::tag</a></div><div class="ttdeci">v_array&lt; char &gt; tag</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00064">example.h:64</a></div></div>
<div class="ttc" id="structexample__predict_html_ab098b66eb3c24b20ca349b7908ef54f3"><div class="ttname"><a href="structexample__predict.html#ab098b66eb3c24b20ca349b7908ef54f3">example_predict::indices</a></div><div class="ttdeci">v_array&lt; namespace_index &gt; indices</div><div class="ttdef"><b>Definition:</b> <a href="example__predict_8h_source.html#l00038">example_predict.h:38</a></div></div>
<div class="ttc" id="structexample__predict_html_a964a7741ec79edbb2e7e2298ffdd767a"><div class="ttname"><a href="structexample__predict.html#a964a7741ec79edbb2e7e2298ffdd767a">example_predict::ft_offset</a></div><div class="ttdeci">uint64_t ft_offset</div><div class="ttdef"><b>Definition:</b> <a href="example__predict_8h_source.html#l00040">example_predict.h:40</a></div></div>
<div class="ttc" id="structfeatures_html_ad204b1a4e0ca9b16b5db3b6261c14423"><div class="ttname"><a href="structfeatures.html#ad204b1a4e0ca9b16b5db3b6261c14423">features::push_back</a></div><div class="ttdeci">void push_back(feature_value v, feature_index i)</div><div class="ttdef"><b>Definition:</b> <a href="feature__group_8h_source.html#l00388">feature_group.h:388</a></div></div>
<div class="ttc" id="structfeatures_html_a2d75751cdcc865b5e62031d40a770a6a"><div class="ttname"><a href="structfeatures.html#a2d75751cdcc865b5e62031d40a770a6a">features::indicies</a></div><div class="ttdeci">v_array&lt; feature_index &gt; indicies</div><div class="ttdef"><b>Definition:</b> <a href="feature__group_8h_source.html#l00251">feature_group.h:251</a></div></div>
<div class="ttc" id="structfeatures_html"><div class="ttname"><a href="structfeatures.html">features</a></div><div class="ttdoc">the core definition of a set of features. </div><div class="ttdef"><b>Definition:</b> <a href="feature__group_8h_source.html#l00248">feature_group.h:248</a></div></div>
<div class="ttc" id="structfeatures_html_a12befb364b2dcda6f052c9e794ac68e4"><div class="ttname"><a href="structfeatures.html#a12befb364b2dcda6f052c9e794ac68e4">features::values</a></div><div class="ttdeci">v_array&lt; feature_value &gt; values</div><div class="ttdef"><b>Definition:</b> <a href="feature__group_8h_source.html#l00250">feature_group.h:250</a></div></div>
<div class="ttc" id="io__buf_8h_html_ac3dc74ce9e42a7cf9cb19834d4593d57"><div class="ttname"><a href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a></div><div class="ttdeci">#define writeit(what, str)</div><div class="ttdef"><b>Definition:</b> <a href="io__buf_8h_source.html#l00347">io_buf.h:347</a></div></div>
<div class="ttc" id="structexample__predict_html_a59f24cbe1603a24ae5812b7d262f3668"><div class="ttname"><a href="structexample__predict.html#a59f24cbe1603a24ae5812b7d262f3668">example_predict::feature_space</a></div><div class="ttdeci">std::array&lt; features, NUM_NAMESPACES &gt; feature_space</div><div class="ttdef"><b>Definition:</b> <a href="example__predict_8h_source.html#l00039">example_predict.h:39</a></div></div>
<div class="ttc" id="unionpolylabel_html_a68946a978546b21fc85fde38d6147399"><div class="ttname"><a href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">polylabel::multi</a></div><div class="ttdeci">MULTICLASS::label_t multi</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00028">example.h:28</a></div></div>
<div class="ttc" id="structv__array_html_afd6a4614f027ac5f786507552ce13f13"><div class="ttname"><a href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">v_array::push_back</a></div><div class="ttdeci">void push_back(const T &amp;new_ele)</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00105">v_array.h:105</a></div></div>
<div class="ttc" id="structMULTICLASS_1_1label__t_html_a0055ecea2640500fb7c8e88f566142e5"><div class="ttname"><a href="structMULTICLASS_1_1label__t.html#a0055ecea2640500fb7c8e88f566142e5">MULTICLASS::label_t::weight</a></div><div class="ttdeci">float weight</div><div class="ttdef"><b>Definition:</b> <a href="multiclass_8h_source.html#l00015">multiclass.h:15</a></div></div>
<div class="ttc" id="structv__array_html_aab10f7f1ac8ad24a8dc0b112fed415ef"><div class="ttname"><a href="structv__array.html#aab10f7f1ac8ad24a8dc0b112fed415ef">v_array::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00086">v_array.h:86</a></div></div>
<div class="ttc" id="structexample_html_a35f3ec2680a21f971548cf5bb9f1fda0"><div class="ttname"><a href="structexample.html#a35f3ec2680a21f971548cf5bb9f1fda0">example::num_features</a></div><div class="ttdeci">size_t num_features</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00068">example.h:68</a></div></div>
<div class="ttc" id="structfeatures_html_a026320c3cb110571f0c07da05c8dbea3"><div class="ttname"><a href="structfeatures.html#a026320c3cb110571f0c07da05c8dbea3">features::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="feature__group_8h_source.html#l00339">feature_group.h:339</a></div></div>
<div class="ttc" id="example__predict_8h_html_a3302327c8e16f985dd6c4474bf279c40"><div class="ttname"><a href="example__predict_8h.html#a3302327c8e16f985dd6c4474bf279c40">namespace_index</a></div><div class="ttdeci">unsigned char namespace_index</div><div class="ttdef"><b>Definition:</b> <a href="example__predict_8h_source.html#l00006">example_predict.h:6</a></div></div>
<div class="ttc" id="structMULTICLASS_1_1label__t_html_aa8b080653e3c08b5363152009728453d"><div class="ttname"><a href="structMULTICLASS_1_1label__t.html#aa8b080653e3c08b5363152009728453d">MULTICLASS::label_t::label</a></div><div class="ttdeci">uint32_t label</div><div class="ttdef"><b>Definition:</b> <a href="multiclass_8h_source.html#l00014">multiclass.h:14</a></div></div>
<div class="ttc" id="structfeatures_html_a4bc967f302cfb466681a6b4c331bf33a"><div class="ttname"><a href="structfeatures.html#a4bc967f302cfb466681a6b4c331bf33a">features::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="feature__group_8h_source.html#l00355">feature_group.h:355</a></div></div>
<div class="ttc" id="structexample_html_aec82f8fecc8ad2a13e54ecf83dfbc5c9"><div class="ttname"><a href="structexample.html#aec82f8fecc8ad2a13e54ecf83dfbc5c9">example::loss</a></div><div class="ttdeci">float loss</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00071">example.h:71</a></div></div>
<div class="ttc" id="structexample_html_a0c87f6e82d9c95ae42158bdbdab3acf5"><div class="ttname"><a href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">example::l</a></div><div class="ttdeci">polylabel l</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00058">example.h:58</a></div></div>
<div class="ttc" id="structexample_html_ad434838ba5443d5f6b5529558d5c1a8c"><div class="ttname"><a href="structexample.html#ad434838ba5443d5f6b5529558d5c1a8c">example::total_sum_feat_sq</a></div><div class="ttdeci">float total_sum_feat_sq</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00072">example.h:72</a></div></div>
<div class="ttc" id="unionpolylabel_html_a999dc75a1e71967c36a817cead6bf3b2"><div class="ttname"><a href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">polylabel::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00034">example.h:34</a></div></div>
<div class="ttc" id="structMULTILABEL_1_1labels_html_ae9b968050adb2459463cffec3b4c38c4"><div class="ttname"><a href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">MULTILABEL::labels::label_v</a></div><div class="ttdeci">v_array&lt; uint32_t &gt; label_v</div><div class="ttdef"><b>Definition:</b> <a href="multilabel_8h_source.html#l00014">multilabel.h:14</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
<div class="ttc" id="structv__array_html_a81c7c9af1948bd97850eb06785f2254f"><div class="ttname"><a href="structv__array.html#a81c7c9af1948bd97850eb06785f2254f">v_array::delete_v</a></div><div class="ttdeci">void delete_v()</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00096">v_array.h:96</a></div></div>
<div class="ttc" id="structexample_html_a403be75fc4fdd058e4f7c1baf39be11a"><div class="ttname"><a href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">example::weight</a></div><div class="ttdeci">float weight</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00063">example.h:63</a></div></div>
<div class="ttc" id="io__buf_8h_html_aa441214d84044fca62cc7341883b7843"><div class="ttname"><a href="io__buf_8h.html#aa441214d84044fca62cc7341883b7843">writeitvar</a></div><div class="ttdeci">#define writeitvar(what, str, mywhat)</div><div class="ttdef"><b>Definition:</b> <a href="io__buf_8h_source.html#l00354">io_buf.h:354</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a18c2c3b4cf88e6ad4d9addceb244115a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::save_load_memory_tree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classio__buf.html">io_buf</a> &amp;&#160;</td>
          <td class="paramname"><em>model_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>text</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l01173">1173</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00177">memory_tree_ns::memory_tree::all</a>, <a class="el" href="v__array_8h_source.html#l00086">v_array&lt; T &gt;::clear()</a>, <a class="el" href="memory__tree_8cc_source.html#l00181">memory_tree_ns::memory_tree::examples</a>, <a class="el" href="io__buf_8h_source.html#l00062">io_buf::files</a>, <a class="el" href="memory__tree_8cc_source.html#l00202">memory_tree_ns::memory_tree::learn_at_leaf</a>, <a class="el" href="memory__tree_8cc_source.html#l00184">memory_tree_ns::memory_tree::max_nodes</a>, <a class="el" href="memory__tree_8cc_source.html#l00187">memory_tree_ns::memory_tree::max_num_labels</a>, <a class="el" href="memory__tree_8cc_source.html#l00180">memory_tree_ns::memory_tree::nodes</a>, <a class="el" href="memory__tree_8cc_source.html#l00210">memory_tree_ns::memory_tree::oas</a>, <a class="el" href="v__array_8h_source.html#l00105">v_array&lt; T &gt;::push_back()</a>, <a class="el" href="memory__tree_8cc_source.html#l01090">save_load_example()</a>, <a class="el" href="memory__tree_8cc_source.html#l01154">save_load_node()</a>, <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>, <a class="el" href="array__parameters_8h_source.html#l00247">parameters::stride_shift()</a>, <a class="el" href="memory__tree_8cc_source.html#l00204">memory_tree_ns::memory_tree::test_mode</a>, <a class="el" href="global__data_8h_source.html#l00535">vw::weights</a>, <a class="el" href="io__buf_8h_source.html#l00347">writeit</a>, and <a class="el" href="io__buf_8h_source.html#l00354">writeitvar</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l01229">memory_tree_setup()</a>.</p>
<div class="fragment"><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;{</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  std::stringstream msg;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="keywordflow">if</span> (model_file.<a class="code" href="classio__buf.html#a2126363251fc091d8ed2356b7c50f551">files</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() &gt; 0)</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  {</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordflow">if</span> (read)</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a05c9f1597c8bbc63abeb04ee5405bde7">test_mode</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordflow">if</span> (read)</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    {</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      uint32_t ss = 0;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(ss, <span class="stringliteral">&quot;stride_shift&quot;</span>);</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a1973c6606ab20af9f30c58b93410cf03">all</a>-&gt;<a class="code" href="structvw.html#a8c84a43b76ba98653da4377ea827a5b4">weights</a>.<a class="code" href="classparameters.html#acfa565410aa0c9776d6c05552430fd7c">stride_shift</a>(ss);</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    }</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    {</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <span class="keywordtype">size_t</span> ss = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a1973c6606ab20af9f30c58b93410cf03">all</a>-&gt;<a class="code" href="structvw.html#a8c84a43b76ba98653da4377ea827a5b4">weights</a>.<a class="code" href="classparameters.html#acfa565410aa0c9776d6c05552430fd7c">stride_shift</a>();</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(ss, <span class="stringliteral">&quot;stride_shift&quot;</span>);</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    }</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a070cc6088b8fd42530bb96c53e21aca7">max_nodes</a>, <span class="stringliteral">&quot;max_nodes&quot;</span>);</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab6b65098687f9c3bd37c925fd932f32a">learn_at_leaf</a>, <span class="stringliteral">&quot;learn_at_leaf&quot;</span>);</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a>, <span class="stringliteral">&quot;oas&quot;</span>);</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="comment">// writeit(b.leaf_example_multiplier, &quot;leaf_example_multiplier&quot;)</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <a class="code" href="io__buf_8h.html#aa441214d84044fca62cc7341883b7843">writeitvar</a>(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>(), <span class="stringliteral">&quot;nodes&quot;</span>, n_nodes);</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a2842d0be85f1213b5d1b654e2ad1d63e">max_num_labels</a>, <span class="stringliteral">&quot;max_number_of_labels&quot;</span>);</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordflow">if</span> (read)</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    {</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;      b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>.<a class="code" href="structv__array.html#aab10f7f1ac8ad24a8dc0b112fed415ef">clear</a>();</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; n_nodes; i++) b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(<a class="code" href="structmemory__tree__ns_1_1node.html">node</a>());</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    }</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="comment">// node</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; n_nodes; i++)</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    {</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      <a class="code" href="namespacememory__tree__ns.html#ab8c15e175eed413d25967aa1021e594c">save_load_node</a>(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[i], model_file, read, text, msg);</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    }</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="comment">// deal with examples:</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <a class="code" href="io__buf_8h.html#aa441214d84044fca62cc7341883b7843">writeitvar</a>(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>(), <span class="stringliteral">&quot;examples&quot;</span>, n_examples);</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="keywordflow">if</span> (read)</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    {</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>.<a class="code" href="structv__array.html#aab10f7f1ac8ad24a8dc0b112fed415ef">clear</a>();</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; n_examples; i++)</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      {</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        <a class="code" href="structexample.html">example</a>* new_ec = &amp;calloc_or_throw&lt;example&gt;();</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(new_ec);</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      }</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    }</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; n_examples; i++) <a class="code" href="namespacememory__tree__ns.html#aceee1ab2c3c2184c26d2b287edce1bcb">save_load_example</a>(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[i], model_file, read, text, msg, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a>);</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="comment">// std::cout&lt;&lt;&quot;done loading....&quot;&lt;&lt; std::endl;</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  }</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;}</div><div class="ttc" id="structvw_html_a8c84a43b76ba98653da4377ea827a5b4"><div class="ttname"><a href="structvw.html#a8c84a43b76ba98653da4377ea827a5b4">vw::weights</a></div><div class="ttdeci">parameters weights</div><div class="ttdef"><b>Definition:</b> <a href="global__data_8h_source.html#l00535">global_data.h:535</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a05c9f1597c8bbc63abeb04ee5405bde7"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a05c9f1597c8bbc63abeb04ee5405bde7">memory_tree_ns::memory_tree::test_mode</a></div><div class="ttdeci">bool test_mode</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00204">memory_tree.cc:204</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_aceee1ab2c3c2184c26d2b287edce1bcb"><div class="ttname"><a href="namespacememory__tree__ns.html#aceee1ab2c3c2184c26d2b287edce1bcb">memory_tree_ns::save_load_example</a></div><div class="ttdeci">void save_load_example(example *ec, io_buf &amp;model_file, bool &amp;read, bool &amp;text, std::stringstream &amp;msg, bool &amp;oas)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l01090">memory_tree.cc:1090</a></div></div>
<div class="ttc" id="io__buf_8h_html_ac3dc74ce9e42a7cf9cb19834d4593d57"><div class="ttname"><a href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a></div><div class="ttdeci">#define writeit(what, str)</div><div class="ttdef"><b>Definition:</b> <a href="io__buf_8h_source.html#l00347">io_buf.h:347</a></div></div>
<div class="ttc" id="structv__array_html_afd6a4614f027ac5f786507552ce13f13"><div class="ttname"><a href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">v_array::push_back</a></div><div class="ttdeci">void push_back(const T &amp;new_ele)</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00105">v_array.h:105</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1node_html"><div class="ttname"><a href="structmemory__tree__ns_1_1node.html">memory_tree_ns::node</a></div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00144">memory_tree.cc:144</a></div></div>
<div class="ttc" id="classio__buf_html_a2126363251fc091d8ed2356b7c50f551"><div class="ttname"><a href="classio__buf.html#a2126363251fc091d8ed2356b7c50f551">io_buf::files</a></div><div class="ttdeci">v_array&lt; int &gt; files</div><div class="ttdef"><b>Definition:</b> <a href="io__buf_8h_source.html#l00062">io_buf.h:62</a></div></div>
<div class="ttc" id="structv__array_html_aab10f7f1ac8ad24a8dc0b112fed415ef"><div class="ttname"><a href="structv__array.html#aab10f7f1ac8ad24a8dc0b112fed415ef">v_array::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00086">v_array.h:86</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a6f1e18de5dec701d3cbe87ef47204640"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">memory_tree_ns::memory_tree::nodes</a></div><div class="ttdeci">v_array&lt; node &gt; nodes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00180">memory_tree.cc:180</a></div></div>
<div class="ttc" id="structexample_html"><div class="ttname"><a href="structexample.html">example</a></div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00055">example.h:55</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a2842d0be85f1213b5d1b654e2ad1d63e"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a2842d0be85f1213b5d1b654e2ad1d63e">memory_tree_ns::memory_tree::max_num_labels</a></div><div class="ttdeci">size_t max_num_labels</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00187">memory_tree.cc:187</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_ab6b65098687f9c3bd37c925fd932f32a"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#ab6b65098687f9c3bd37c925fd932f32a">memory_tree_ns::memory_tree::learn_at_leaf</a></div><div class="ttdeci">bool learn_at_leaf</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00202">memory_tree.cc:202</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a80ed4155bf29ce66809ab34e364c74b8"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">memory_tree_ns::memory_tree::examples</a></div><div class="ttdeci">v_array&lt; example * &gt; examples</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00181">memory_tree.cc:181</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a070cc6088b8fd42530bb96c53e21aca7"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a070cc6088b8fd42530bb96c53e21aca7">memory_tree_ns::memory_tree::max_nodes</a></div><div class="ttdeci">size_t max_nodes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00184">memory_tree.cc:184</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a83fcd57ae88e0cf7551df6a2ea81bb46"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">memory_tree_ns::memory_tree::oas</a></div><div class="ttdeci">bool oas</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00210">memory_tree.cc:210</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_ab8c15e175eed413d25967aa1021e594c"><div class="ttname"><a href="namespacememory__tree__ns.html#ab8c15e175eed413d25967aa1021e594c">memory_tree_ns::save_load_node</a></div><div class="ttdeci">void save_load_node(node &amp;cn, io_buf &amp;model_file, bool &amp;read, bool &amp;text, std::stringstream &amp;msg)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l01154">memory_tree.cc:1154</a></div></div>
<div class="ttc" id="classparameters_html_acfa565410aa0c9776d6c05552430fd7c"><div class="ttname"><a href="classparameters.html#acfa565410aa0c9776d6c05552430fd7c">parameters::stride_shift</a></div><div class="ttdeci">uint32_t stride_shift()</div><div class="ttdef"><b>Definition:</b> <a href="array__parameters_8h_source.html#l00247">array_parameters.h:247</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a1973c6606ab20af9f30c58b93410cf03"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a1973c6606ab20af9f30c58b93410cf03">memory_tree_ns::memory_tree::all</a></div><div class="ttdeci">vw * all</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00177">memory_tree.cc:177</a></div></div>
<div class="ttc" id="io__buf_8h_html_aa441214d84044fca62cc7341883b7843"><div class="ttname"><a href="io__buf_8h.html#aa441214d84044fca62cc7341883b7843">writeitvar</a></div><div class="ttdeci">#define writeitvar(what, str, mywhat)</div><div class="ttdef"><b>Definition:</b> <a href="io__buf_8h_source.html#l00354">io_buf.h:354</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab8c15e175eed413d25967aa1021e594c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::save_load_node </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1node.html">node</a> &amp;&#160;</td>
          <td class="paramname"><em>cn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classio__buf.html">io_buf</a> &amp;&#160;</td>
          <td class="paramname"><em>model_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::stringstream &amp;&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l01154">1154</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00150">memory_tree_ns::node::base_router</a>, <a class="el" href="v__array_8h_source.html#l00086">v_array&lt; T &gt;::clear()</a>, <a class="el" href="memory__tree_8cc_source.html#l00149">memory_tree_ns::node::depth</a>, <a class="el" href="memory__tree_8cc_source.html#l00157">memory_tree_ns::node::examples_index</a>, <a class="el" href="memory__tree_8cc_source.html#l00147">memory_tree_ns::node::internal</a>, <a class="el" href="memory__tree_8cc_source.html#l00151">memory_tree_ns::node::left</a>, <a class="el" href="memory__tree_8cc_source.html#l00154">memory_tree_ns::node::nl</a>, <a class="el" href="memory__tree_8cc_source.html#l00155">memory_tree_ns::node::nr</a>, <a class="el" href="memory__tree_8cc_source.html#l00146">memory_tree_ns::node::parent</a>, <a class="el" href="v__array_8h_source.html#l00105">v_array&lt; T &gt;::push_back()</a>, <a class="el" href="memory__tree_8cc_source.html#l00152">memory_tree_ns::node::right</a>, <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>, <a class="el" href="io__buf_8h_source.html#l00347">writeit</a>, and <a class="el" href="io__buf_8h_source.html#l00354">writeitvar</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l01173">save_load_memory_tree()</a>.</p>
<div class="fragment"><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;{</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(cn.<a class="code" href="structmemory__tree__ns_1_1node.html#ad67a512141552abfc3dbe1828f03ab62">parent</a>, <span class="stringliteral">&quot;parent&quot;</span>);</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(cn.<a class="code" href="structmemory__tree__ns_1_1node.html#adff56ddd3f52eb7ca8e784dc05c122b9">internal</a>, <span class="stringliteral">&quot;internal&quot;</span>);</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(cn.<a class="code" href="structmemory__tree__ns_1_1node.html#abdaa146360f66755c7c84a1959420392">depth</a>, <span class="stringliteral">&quot;depth&quot;</span>);</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(cn.<a class="code" href="structmemory__tree__ns_1_1node.html#ae1623b1f5cb0732d7184f3d5a6219c2b">base_router</a>, <span class="stringliteral">&quot;base_router&quot;</span>);</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(cn.<a class="code" href="structmemory__tree__ns_1_1node.html#aabe30f1c22342caa41c8ca9b801c383e">left</a>, <span class="stringliteral">&quot;left&quot;</span>);</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(cn.<a class="code" href="structmemory__tree__ns_1_1node.html#ab020d85a089bc9c233aa5f6157d897f9">right</a>, <span class="stringliteral">&quot;right&quot;</span>);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(cn.<a class="code" href="structmemory__tree__ns_1_1node.html#afbdc727abc0305bc7d6294bcc5e62a08">nl</a>, <span class="stringliteral">&quot;nl&quot;</span>);</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(cn.<a class="code" href="structmemory__tree__ns_1_1node.html#a38af2224a12f108dc578f3c69d90cedd">nr</a>, <span class="stringliteral">&quot;nr&quot;</span>);</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <a class="code" href="io__buf_8h.html#aa441214d84044fca62cc7341883b7843">writeitvar</a>(cn.<a class="code" href="structmemory__tree__ns_1_1node.html#a73ad65cd19bf4dc1a1fc09b5dea4ba82">examples_index</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>(), <span class="stringliteral">&quot;leaf_n_examples&quot;</span>, leaf_n_examples);</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="keywordflow">if</span> (read)</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  {</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    cn.<a class="code" href="structmemory__tree__ns_1_1node.html#a73ad65cd19bf4dc1a1fc09b5dea4ba82">examples_index</a>.<a class="code" href="structv__array.html#aab10f7f1ac8ad24a8dc0b112fed415ef">clear</a>();</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordflow">for</span> (uint32_t k = 0; k &lt; leaf_n_examples; k++) cn.<a class="code" href="structmemory__tree__ns_1_1node.html#a73ad65cd19bf4dc1a1fc09b5dea4ba82">examples_index</a>.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(0);</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  }</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="keywordflow">for</span> (uint32_t k = 0; k &lt; leaf_n_examples; k++) <a class="code" href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a>(cn.<a class="code" href="structmemory__tree__ns_1_1node.html#a73ad65cd19bf4dc1a1fc09b5dea4ba82">examples_index</a>[k], <span class="stringliteral">&quot;example_location&quot;</span>);</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;}</div><div class="ttc" id="structmemory__tree__ns_1_1node_html_adff56ddd3f52eb7ca8e784dc05c122b9"><div class="ttname"><a href="structmemory__tree__ns_1_1node.html#adff56ddd3f52eb7ca8e784dc05c122b9">memory_tree_ns::node::internal</a></div><div class="ttdeci">int internal</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00147">memory_tree.cc:147</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1node_html_a73ad65cd19bf4dc1a1fc09b5dea4ba82"><div class="ttname"><a href="structmemory__tree__ns_1_1node.html#a73ad65cd19bf4dc1a1fc09b5dea4ba82">memory_tree_ns::node::examples_index</a></div><div class="ttdeci">v_array&lt; uint32_t &gt; examples_index</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00157">memory_tree.cc:157</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1node_html_afbdc727abc0305bc7d6294bcc5e62a08"><div class="ttname"><a href="structmemory__tree__ns_1_1node.html#afbdc727abc0305bc7d6294bcc5e62a08">memory_tree_ns::node::nl</a></div><div class="ttdeci">double nl</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00154">memory_tree.cc:154</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1node_html_ae1623b1f5cb0732d7184f3d5a6219c2b"><div class="ttname"><a href="structmemory__tree__ns_1_1node.html#ae1623b1f5cb0732d7184f3d5a6219c2b">memory_tree_ns::node::base_router</a></div><div class="ttdeci">uint64_t base_router</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00150">memory_tree.cc:150</a></div></div>
<div class="ttc" id="io__buf_8h_html_ac3dc74ce9e42a7cf9cb19834d4593d57"><div class="ttname"><a href="io__buf_8h.html#ac3dc74ce9e42a7cf9cb19834d4593d57">writeit</a></div><div class="ttdeci">#define writeit(what, str)</div><div class="ttdef"><b>Definition:</b> <a href="io__buf_8h_source.html#l00347">io_buf.h:347</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1node_html_ad67a512141552abfc3dbe1828f03ab62"><div class="ttname"><a href="structmemory__tree__ns_1_1node.html#ad67a512141552abfc3dbe1828f03ab62">memory_tree_ns::node::parent</a></div><div class="ttdeci">uint64_t parent</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00146">memory_tree.cc:146</a></div></div>
<div class="ttc" id="structv__array_html_afd6a4614f027ac5f786507552ce13f13"><div class="ttname"><a href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">v_array::push_back</a></div><div class="ttdeci">void push_back(const T &amp;new_ele)</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00105">v_array.h:105</a></div></div>
<div class="ttc" id="structv__array_html_aab10f7f1ac8ad24a8dc0b112fed415ef"><div class="ttname"><a href="structv__array.html#aab10f7f1ac8ad24a8dc0b112fed415ef">v_array::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00086">v_array.h:86</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1node_html_aabe30f1c22342caa41c8ca9b801c383e"><div class="ttname"><a href="structmemory__tree__ns_1_1node.html#aabe30f1c22342caa41c8ca9b801c383e">memory_tree_ns::node::left</a></div><div class="ttdeci">uint64_t left</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00151">memory_tree.cc:151</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1node_html_a38af2224a12f108dc578f3c69d90cedd"><div class="ttname"><a href="structmemory__tree__ns_1_1node.html#a38af2224a12f108dc578f3c69d90cedd">memory_tree_ns::node::nr</a></div><div class="ttdeci">double nr</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00155">memory_tree.cc:155</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1node_html_ab020d85a089bc9c233aa5f6157d897f9"><div class="ttname"><a href="structmemory__tree__ns_1_1node.html#ab020d85a089bc9c233aa5f6157d897f9">memory_tree_ns::node::right</a></div><div class="ttdeci">uint64_t right</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00152">memory_tree.cc:152</a></div></div>
<div class="ttc" id="io__buf_8h_html_aa441214d84044fca62cc7341883b7843"><div class="ttname"><a href="io__buf_8h.html#aa441214d84044fca62cc7341883b7843">writeitvar</a></div><div class="ttdeci">#define writeitvar(what, str, mywhat)</div><div class="ttdef"><b>Definition:</b> <a href="io__buf_8h_source.html#l00354">io_buf.h:354</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1node_html_abdaa146360f66755c7c84a1959420392"><div class="ttname"><a href="structmemory__tree__ns_1_1node.html#abdaa146360f66755c7c84a1959420392">memory_tree_ns::node::depth</a></div><div class="ttdeci">uint32_t depth</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00149">memory_tree.cc:149</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2765df994178ef7801e1b4b111884f14"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::single_query_and_learn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t &amp;&#160;</td>
          <td class="paramname"><em>ec_array_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> &amp;&#160;</td>
          <td class="paramname"><em>ec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00885">885</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00178">memory_tree_ns::memory_tree::_random_state</a>, <a class="el" href="memory__tree_8cc_source.html#l00188">memory_tree_ns::memory_tree::alpha</a>, <a class="el" href="v__array_8h_source.html#l00096">v_array&lt; T &gt;::delete_v()</a>, <a class="el" href="cache_8cc_source.html#l00039">f</a>, <a class="el" href="example_8h_source.html#l00058">example::l</a>, <a class="el" href="learner_8h_source.html#l00156">LEARNER::learner&lt; T, E &gt;::learn()</a>, <a class="el" href="memory__tree_8cc_source.html#l00202">memory_tree_ns::memory_tree::learn_at_leaf</a>, <a class="el" href="memory__tree_8cc_source.html#l00806">learn_at_leaf_random()</a>, <a class="el" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>, <a class="el" href="example_8h_source.html#l00028">polylabel::multi</a>, <a class="el" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>, <a class="el" href="example_8h_source.html#l00034">polylabel::multilabels</a>, <a class="el" href="example_8h_source.html#l00050">polyprediction::multilabels</a>, <a class="el" href="memory__tree_8cc_source.html#l00180">memory_tree_ns::memory_tree::nodes</a>, <a class="el" href="memory__tree_8cc_source.html#l00210">memory_tree_ns::memory_tree::oas</a>, <a class="el" href="example_8h_source.html#l00061">example::pred</a>, <a class="el" href="memory__tree_8cc_source.html#l00739">return_reward_from_node()</a>, <a class="el" href="memory__tree_8cc_source.html#l00830">route_to_leaf()</a>, <a class="el" href="example_8h_source.html#l00027">polylabel::simple</a>, <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>, <a class="el" href="memory__tree_8cc_source.html#l00576">train_one_against_some_at_leaf()</a>, and <a class="el" href="example_8h_source.html#l00063">example::weight</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00960">update_rew()</a>.</p>
<div class="fragment"><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;{</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <a class="code" href="structv__array.html">v_array&lt;uint64_t&gt;</a> path_to_leaf = v_init&lt;uint64_t&gt;();</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <a class="code" href="namespacememory__tree__ns.html#a28b68857ebf69c2e6cf472da206808ca">route_to_leaf</a>(b, base, ec_array_index, 0, path_to_leaf, <span class="keyword">false</span>);  <span class="comment">// no insertion happens here.</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="keywordflow">if</span> (path_to_leaf.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() &gt; 1)</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  {</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="comment">// uint32_t random_pos = merand48(b._random_state-&gt;get_current_state())*(path_to_leaf.size()-1);</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    uint32_t random_pos = (uint32_t)(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a43960ae6e6fe6bca0b4d94ec783d658b">_random_state</a>-&gt;get_and_update_random() * (path_to_leaf.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>()));  <span class="comment">// include leaf</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    uint64_t cn = path_to_leaf[random_pos];</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].internal != -1)</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    {  <span class="comment">// if it&#39;s an internal node:&#39;</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <span class="keywordtype">float</span> objective = 0.f;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      <span class="keywordtype">float</span> prob_right = 0.5;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <span class="keywordtype">float</span> coin = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a43960ae6e6fe6bca0b4d94ec783d658b">_random_state</a>-&gt;get_and_update_random() &lt; prob_right ? 1.f : -1.f;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <span class="keywordtype">float</span> <a class="code" href="array__parameters__dense_8h.html#a4d04a2043fa7480d905108e63adb0bab">weight</a> = path_to_leaf.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() * 1.f / (path_to_leaf.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>() - 1.f);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      <span class="keywordflow">if</span> (coin == -1.<a class="code" href="cache_8cc.html#af900396d7b72ff2a7002e8befe8cf8f1">f</a>)</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      {  <span class="comment">// go left</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="keywordtype">float</span> reward_left_subtree = <a class="code" href="namespacememory__tree__ns.html#a37334ee454f980c3f87ad853ecb61413">return_reward_from_node</a>(b, base, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].left, ec, weight);</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        objective = (float)((1. - b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a1c9d530daed57df3ac59e5419f829cdf">alpha</a>) * log(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nl / b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nr) +</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a1c9d530daed57df3ac59e5419f829cdf">alpha</a> * (-reward_left_subtree / (1. - prob_right)) / 2.);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      }</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      {  <span class="comment">// go right:</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="keywordtype">float</span> reward_right_subtree = <a class="code" href="namespacememory__tree__ns.html#a37334ee454f980c3f87ad853ecb61413">return_reward_from_node</a>(b, base, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].right, ec, weight);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        objective = (float)((1. - b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a1c9d530daed57df3ac59e5419f829cdf">alpha</a>) * log(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nl / b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nr) +</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a1c9d530daed57df3ac59e5419f829cdf">alpha</a> * (reward_right_subtree / prob_right) / 2.);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      }</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keywordtype">float</span> ec_input_weight = ec.<a class="code" href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">weight</a>;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <a class="code" href="structMULTICLASS_1_1label__t.html">MULTICLASS::label_t</a> <a class="code" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      <a class="code" href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a> <a class="code" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <a class="code" href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a> preds;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        mc = ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">multi</a>;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      {</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        multilabels = ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        preds = ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">multilabels</a>;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      }</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      ec.<a class="code" href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">weight</a> = fabs(objective);</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      <span class="keywordflow">if</span> (ec.<a class="code" href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">weight</a> &gt;= 100.f)  <span class="comment">// crop the weight, otherwise sometimes cause NAN outputs.</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        ec.<a class="code" href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">weight</a> = 100.f;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ec.<a class="code" href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">weight</a> &lt; .01f)</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        ec.<a class="code" href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">weight</a> = 0.01f;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">simple</a> = {objective &lt; 0. ? -1.f : 1.f, 1.f, 0.};</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      base.<a class="code" href="structLEARNER_1_1learner.html#a9984332080a6ee4730a5762e9be3a3f6">learn</a>(ec, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].base_router);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">multi</a> = <a class="code" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      {</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">multilabels</a> = preds;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a> = <a class="code" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      }</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      ec.<a class="code" href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">weight</a> = ec_input_weight;  <span class="comment">// restore the original weight</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    }</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    {                      <span class="comment">// if it&#39;s a leaf node:</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <span class="keywordtype">float</span> weight = 1.f;  <span class="comment">// float(path_to_leaf.size());</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab6b65098687f9c3bd37c925fd932f32a">learn_at_leaf</a> == <span class="keyword">true</span>)</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        <a class="code" href="namespacememory__tree__ns.html#a049fec021123c5ddfc9989582c24fa6e">learn_at_leaf_random</a>(</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            b, base, cn, ec, weight);  <span class="comment">// randomly sample one example, query reward, and update leaf learner</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">true</span>)</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <a class="code" href="namespacememory__tree__ns.html#a27aad0e7fea7b74c8efa7961a6fd5a17">train_one_against_some_at_leaf</a>(b, base, cn, ec);</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    }</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  }</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  path_to_leaf.<a class="code" href="structv__array.html#a81c7c9af1948bd97850eb06785f2254f">delete_v</a>();</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;}</div><div class="ttc" id="namespacememory__tree__ns_html_a049fec021123c5ddfc9989582c24fa6e"><div class="ttname"><a href="namespacememory__tree__ns.html#a049fec021123c5ddfc9989582c24fa6e">memory_tree_ns::learn_at_leaf_random</a></div><div class="ttdeci">void learn_at_leaf_random(memory_tree &amp;b, single_learner &amp;base, const uint64_t &amp;leaf_id, example &amp;ec, const float &amp;weight)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00806">memory_tree.cc:806</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a1c9d530daed57df3ac59e5419f829cdf"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a1c9d530daed57df3ac59e5419f829cdf">memory_tree_ns::memory_tree::alpha</a></div><div class="ttdeci">float alpha</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00188">memory_tree.cc:188</a></div></div>
<div class="ttc" id="learner_8h_html_a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2"><div class="ttname"><a href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">prediction_type_t::multilabels</a></div></div>
<div class="ttc" id="unionpolylabel_html_a80ff268cb4e29afddaac58174d316297"><div class="ttname"><a href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">polylabel::simple</a></div><div class="ttdeci">label_data simple</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00027">example.h:27</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a37334ee454f980c3f87ad853ecb61413"><div class="ttname"><a href="namespacememory__tree__ns.html#a37334ee454f980c3f87ad853ecb61413">memory_tree_ns::return_reward_from_node</a></div><div class="ttdeci">float return_reward_from_node(memory_tree &amp;b, single_learner &amp;base, uint64_t cn, example &amp;ec, float weight=1.f)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00739">memory_tree.cc:739</a></div></div>
<div class="ttc" id="unionpolylabel_html_a68946a978546b21fc85fde38d6147399"><div class="ttname"><a href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">polylabel::multi</a></div><div class="ttdeci">MULTICLASS::label_t multi</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00028">example.h:28</a></div></div>
<div class="ttc" id="structMULTILABEL_1_1labels_html"><div class="ttname"><a href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a></div><div class="ttdef"><b>Definition:</b> <a href="multilabel_8h_source.html#l00012">multilabel.h:12</a></div></div>
<div class="ttc" id="global__data_8h_html_ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567"><div class="ttname"><a href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">label_type_t::mc</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a6f1e18de5dec701d3cbe87ef47204640"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">memory_tree_ns::memory_tree::nodes</a></div><div class="ttdeci">v_array&lt; node &gt; nodes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00180">memory_tree.cc:180</a></div></div>
<div class="ttc" id="array__parameters__dense_8h_html_a4d04a2043fa7480d905108e63adb0bab"><div class="ttname"><a href="array__parameters__dense_8h.html#a4d04a2043fa7480d905108e63adb0bab">weight</a></div><div class="ttdeci">float weight</div><div class="ttdef"><b>Definition:</b> <a href="array__parameters__dense_8h_source.html#l00010">array_parameters_dense.h:10</a></div></div>
<div class="ttc" id="structexample_html_a0c87f6e82d9c95ae42158bdbdab3acf5"><div class="ttname"><a href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">example::l</a></div><div class="ttdeci">polylabel l</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00058">example.h:58</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_ab6b65098687f9c3bd37c925fd932f32a"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#ab6b65098687f9c3bd37c925fd932f32a">memory_tree_ns::memory_tree::learn_at_leaf</a></div><div class="ttdeci">bool learn_at_leaf</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00202">memory_tree.cc:202</a></div></div>
<div class="ttc" id="unionpolyprediction_html_a9f6a01eabbe81af8ec89f7af7ff5de3c"><div class="ttname"><a href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">polyprediction::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00050">example.h:50</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a83fcd57ae88e0cf7551df6a2ea81bb46"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">memory_tree_ns::memory_tree::oas</a></div><div class="ttdeci">bool oas</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00210">memory_tree.cc:210</a></div></div>
<div class="ttc" id="unionpolylabel_html_a999dc75a1e71967c36a817cead6bf3b2"><div class="ttname"><a href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">polylabel::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00034">example.h:34</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a27aad0e7fea7b74c8efa7961a6fd5a17"><div class="ttname"><a href="namespacememory__tree__ns.html#a27aad0e7fea7b74c8efa7961a6fd5a17">memory_tree_ns::train_one_against_some_at_leaf</a></div><div class="ttdeci">void train_one_against_some_at_leaf(memory_tree &amp;b, single_learner &amp;base, const uint64_t cn, example &amp;ec)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00576">memory_tree.cc:576</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a43960ae6e6fe6bca0b4d94ec783d658b"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a43960ae6e6fe6bca0b4d94ec783d658b">memory_tree_ns::memory_tree::_random_state</a></div><div class="ttdeci">std::shared_ptr&lt; rand_state &gt; _random_state</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00178">memory_tree.cc:178</a></div></div>
<div class="ttc" id="structMULTICLASS_1_1label__t_html"><div class="ttname"><a href="structMULTICLASS_1_1label__t.html">MULTICLASS::label_t</a></div><div class="ttdef"><b>Definition:</b> <a href="multiclass_8h_source.html#l00012">multiclass.h:12</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a28b68857ebf69c2e6cf472da206808ca"><div class="ttname"><a href="namespacememory__tree__ns.html#a28b68857ebf69c2e6cf472da206808ca">memory_tree_ns::route_to_leaf</a></div><div class="ttdeci">void route_to_leaf(memory_tree &amp;b, single_learner &amp;base, const uint32_t &amp;ec_array_index, uint64_t cn, v_array&lt; uint64_t &gt; &amp;path, bool insertion)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00830">memory_tree.cc:830</a></div></div>
<div class="ttc" id="structexample_html_ad1477e890371ed8253f1953d4190ba49"><div class="ttname"><a href="structexample.html#ad1477e890371ed8253f1953d4190ba49">example::pred</a></div><div class="ttdeci">polyprediction pred</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00061">example.h:61</a></div></div>
<div class="ttc" id="structv__array_html_a81c7c9af1948bd97850eb06785f2254f"><div class="ttname"><a href="structv__array.html#a81c7c9af1948bd97850eb06785f2254f">v_array::delete_v</a></div><div class="ttdeci">void delete_v()</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00096">v_array.h:96</a></div></div>
<div class="ttc" id="structLEARNER_1_1learner_html_a9984332080a6ee4730a5762e9be3a3f6"><div class="ttname"><a href="structLEARNER_1_1learner.html#a9984332080a6ee4730a5762e9be3a3f6">LEARNER::learner::learn</a></div><div class="ttdeci">void learn(E &amp;ec, size_t i=0)</div><div class="ttdef"><b>Definition:</b> <a href="learner_8h_source.html#l00156">learner.h:156</a></div></div>
<div class="ttc" id="structexample_html_a403be75fc4fdd058e4f7c1baf39be11a"><div class="ttname"><a href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">example::weight</a></div><div class="ttdeci">float weight</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00063">example.h:63</a></div></div>
<div class="ttc" id="structv__array_html"><div class="ttname"><a href="structv__array.html">v_array&lt; uint64_t &gt;</a></div></div>
<div class="ttc" id="cache_8cc_html_af900396d7b72ff2a7002e8befe8cf8f1"><div class="ttname"><a href="cache_8cc.html#af900396d7b72ff2a7002e8befe8cf8f1">f</a></div><div class="ttdeci">float f</div><div class="ttdef"><b>Definition:</b> <a href="cache_8cc_source.html#l00039">cache.cc:39</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a86e4abca95dc1304004eac3b4648bd05"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::split_leaf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>cn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00437">437</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="v__array_8h_source.html#l00096">v_array&lt; T &gt;::delete_v()</a>, <a class="el" href="memory__tree_8cc_source.html#l00181">memory_tree_ns::memory_tree::examples</a>, <a class="el" href="memory__tree_8cc_source.html#l00322">insert_descent()</a>, <a class="el" href="memory__tree_8cc_source.html#l00195">memory_tree_ns::memory_tree::max_depth</a>, <a class="el" href="memory__tree_8cc_source.html#l00196">memory_tree_ns::memory_tree::max_ex_in_leaf</a>, <a class="el" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>, <a class="el" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>, <a class="el" href="memory__tree_8cc_source.html#l00180">memory_tree_ns::memory_tree::nodes</a>, <a class="el" href="memory__tree_8cc_source.html#l00210">memory_tree_ns::memory_tree::oas</a>, <a class="el" href="learner_8h_source.html#l00165">LEARNER::learner&lt; T, E &gt;::predict()</a>, <a class="el" href="v__array_8h_source.html#l00105">v_array&lt; T &gt;::push_back()</a>, <a class="el" href="memory__tree_8cc_source.html#l00189">memory_tree_ns::memory_tree::routers_used</a>, <a class="el" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aa27a6549ade38cc036f7b8c58a840510">scalar</a>, <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>, and <a class="el" href="log__multi_8cc_source.html#l00250">train_node()</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00967">insert_example()</a>, and <a class="el" href="memory__tree_8cc_source.html#l00830">route_to_leaf()</a>.</p>
<div class="fragment"><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;{</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="comment">// create two children</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].internal = 1;  <span class="comment">// swith to internal node.</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  uint32_t left_child = (uint32_t)b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>();</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(<a class="code" href="structmemory__tree__ns_1_1node.html">node</a>());</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[left_child].internal = -1;  <span class="comment">// left leaf</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[left_child].base_router = (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a97c53589756df3c45f9d32d3719a1925">routers_used</a>++);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  uint32_t right_child = (uint32_t)b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>();</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(<a class="code" href="structmemory__tree__ns_1_1node.html">node</a>());</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[right_child].internal = -1;  <span class="comment">// right leaf</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[right_child].base_router = (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a97c53589756df3c45f9d32d3719a1925">routers_used</a>++);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].depth + 1 &gt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab51886feb1c63d2833d5db801938a59a">max_depth</a>)</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  {</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab51886feb1c63d2833d5db801938a59a">max_depth</a> = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].depth + 1;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;depth &quot;</span> &lt;&lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab51886feb1c63d2833d5db801938a59a">max_depth</a> &lt;&lt; std::endl;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  }</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].left = left_child;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].right = right_child;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[left_child].parent = cn;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[right_child].parent = cn;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[left_child].depth = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].depth + 1;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[right_child].depth = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].depth + 1;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[left_child].depth &gt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab51886feb1c63d2833d5db801938a59a">max_depth</a>)</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#ab51886feb1c63d2833d5db801938a59a">max_depth</a> = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[left_child].depth;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="comment">// rout the examples stored in the node to the left and right</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ec_id = 0; ec_id &lt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>(); ec_id++)  <span class="comment">// scan all examples stored in the cn</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  {</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    uint32_t ec_pos = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index[ec_id];</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <a class="code" href="structMULTICLASS_1_1label__t.html">MULTICLASS::label_t</a> <a class="code" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    uint32_t save_multi_pred = 0;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <a class="code" href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a> <a class="code" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a> preds;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    {</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      mc = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_pos]-&gt;l.multi;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      save_multi_pred = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_pos]-&gt;pred.multiclass;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    }</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      multilabels = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_pos]-&gt;l.multilabels;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      preds = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_pos]-&gt;pred.multilabels;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_pos]-&gt;l.simple = {1.f, 1.f, 0.f};</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    base.<a class="code" href="structLEARNER_1_1learner.html#a8b4f75763c0ec9a26eb5255780e782a8">predict</a>(*b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_pos], b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].base_router);  <span class="comment">// re-predict</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aa27a6549ade38cc036f7b8c58a840510">scalar</a> = b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_pos]-&gt;pred.scalar;              <span class="comment">// this is spliting the leaf.</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">if</span> (scalar &lt; 0)</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[left_child].examples_index.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(ec_pos);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="keywordtype">float</span> leaf_pred = <a class="code" href="log__multi_8cc.html#a968fdae7c02e90fe10245115a53aa640">train_node</a>(b, base, *b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_pos], left_child);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <a class="code" href="namespacememory__tree__ns.html#aa544f428dd64b385a63b962e9b1ed2a8">insert_descent</a>(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[left_child], leaf_pred);  <span class="comment">// fake descent, only for update nl and nr</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    }</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[right_child].examples_index.<a class="code" href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">push_back</a>(ec_pos);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <span class="keywordtype">float</span> leaf_pred = <a class="code" href="log__multi_8cc.html#a968fdae7c02e90fe10245115a53aa640">train_node</a>(b, base, *b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_pos], right_child);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <a class="code" href="namespacememory__tree__ns.html#aa544f428dd64b385a63b962e9b1ed2a8">insert_descent</a>(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[right_child], leaf_pred);  <span class="comment">// fake descent. for update nr and nl</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    }</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_pos]-&gt;l.multi = <a class="code" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_pos]-&gt;pred.multiclass = save_multi_pred;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    {</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_pos]-&gt;pred.multilabels = preds;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">examples</a>[ec_pos]-&gt;l.multilabels = <a class="code" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    }</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].examples_index.<a class="code" href="structv__array.html#a81c7c9af1948bd97850eb06785f2254f">delete_v</a>();                                                 <span class="comment">// empty the cn&#39;s example list</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nl = std::max(<span class="keywordtype">double</span>(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[left_child].examples_index.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>()), 0.001);   <span class="comment">// avoid to set nl to zero</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nr = std::max(<span class="keywordtype">double</span>(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[right_child].examples_index.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>()), 0.001);  <span class="comment">// avoid to set nr to zero</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="keywordflow">if</span> (std::max(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nl, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nr) &gt; b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a61be1b7f33cb7a845fd5455b07d8f290">max_ex_in_leaf</a>)</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  {</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a61be1b7f33cb7a845fd5455b07d8f290">max_ex_in_leaf</a> = (size_t)std::max(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nl, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nr);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">// std::cout&lt;&lt;b.max_ex_in_leaf&lt;&lt; std::endl;</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  }</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;}</div><div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a97c53589756df3c45f9d32d3719a1925"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a97c53589756df3c45f9d32d3719a1925">memory_tree_ns::memory_tree::routers_used</a></div><div class="ttdeci">uint64_t routers_used</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00189">memory_tree.cc:189</a></div></div>
<div class="ttc" id="structLEARNER_1_1learner_html_a8b4f75763c0ec9a26eb5255780e782a8"><div class="ttname"><a href="structLEARNER_1_1learner.html#a8b4f75763c0ec9a26eb5255780e782a8">LEARNER::learner::predict</a></div><div class="ttdeci">void predict(E &amp;ec, size_t i=0)</div><div class="ttdef"><b>Definition:</b> <a href="learner_8h_source.html#l00165">learner.h:165</a></div></div>
<div class="ttc" id="learner_8h_html_a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2"><div class="ttname"><a href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">prediction_type_t::multilabels</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_aa544f428dd64b385a63b962e9b1ed2a8"><div class="ttname"><a href="namespacememory__tree__ns.html#aa544f428dd64b385a63b962e9b1ed2a8">memory_tree_ns::insert_descent</a></div><div class="ttdeci">uint64_t insert_descent(node &amp;n, const float prediction)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00322">memory_tree.cc:322</a></div></div>
<div class="ttc" id="log__multi_8cc_html_a968fdae7c02e90fe10245115a53aa640"><div class="ttname"><a href="log__multi_8cc.html#a968fdae7c02e90fe10245115a53aa640">train_node</a></div><div class="ttdeci">void train_node(log_multi &amp;b, single_learner &amp;base, example &amp;ec, uint32_t &amp;current, uint32_t &amp;class_index, uint32_t)</div><div class="ttdef"><b>Definition:</b> <a href="log__multi_8cc_source.html#l00250">log_multi.cc:250</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_ab51886feb1c63d2833d5db801938a59a"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#ab51886feb1c63d2833d5db801938a59a">memory_tree_ns::memory_tree::max_depth</a></div><div class="ttdeci">size_t max_depth</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00195">memory_tree.cc:195</a></div></div>
<div class="ttc" id="structMULTILABEL_1_1labels_html"><div class="ttname"><a href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a></div><div class="ttdef"><b>Definition:</b> <a href="multilabel_8h_source.html#l00012">multilabel.h:12</a></div></div>
<div class="ttc" id="structv__array_html_afd6a4614f027ac5f786507552ce13f13"><div class="ttname"><a href="structv__array.html#afd6a4614f027ac5f786507552ce13f13">v_array::push_back</a></div><div class="ttdeci">void push_back(const T &amp;new_ele)</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00105">v_array.h:105</a></div></div>
<div class="ttc" id="global__data_8h_html_ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567"><div class="ttname"><a href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">label_type_t::mc</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1node_html"><div class="ttname"><a href="structmemory__tree__ns_1_1node.html">memory_tree_ns::node</a></div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00144">memory_tree.cc:144</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a6f1e18de5dec701d3cbe87ef47204640"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">memory_tree_ns::memory_tree::nodes</a></div><div class="ttdeci">v_array&lt; node &gt; nodes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00180">memory_tree.cc:180</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a61be1b7f33cb7a845fd5455b07d8f290"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a61be1b7f33cb7a845fd5455b07d8f290">memory_tree_ns::memory_tree::max_ex_in_leaf</a></div><div class="ttdeci">size_t max_ex_in_leaf</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00196">memory_tree.cc:196</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a80ed4155bf29ce66809ab34e364c74b8"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a80ed4155bf29ce66809ab34e364c74b8">memory_tree_ns::memory_tree::examples</a></div><div class="ttdeci">v_array&lt; example * &gt; examples</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00181">memory_tree.cc:181</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a83fcd57ae88e0cf7551df6a2ea81bb46"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">memory_tree_ns::memory_tree::oas</a></div><div class="ttdeci">bool oas</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00210">memory_tree.cc:210</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
<div class="ttc" id="structMULTICLASS_1_1label__t_html"><div class="ttname"><a href="structMULTICLASS_1_1label__t.html">MULTICLASS::label_t</a></div><div class="ttdef"><b>Definition:</b> <a href="multiclass_8h_source.html#l00012">multiclass.h:12</a></div></div>
<div class="ttc" id="learner_8h_html_a5514b4a9448315c23ec344ca2d139e24aa27a6549ade38cc036f7b8c58a840510"><div class="ttname"><a href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aa27a6549ade38cc036f7b8c58a840510">prediction_type_t::scalar</a></div></div>
<div class="ttc" id="structv__array_html_a81c7c9af1948bd97850eb06785f2254f"><div class="ttname"><a href="structv__array.html#a81c7c9af1948bd97850eb06785f2254f">v_array::delete_v</a></div><div class="ttdeci">void delete_v()</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00096">v_array.h:96</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a393a4fb5d4ccfcdfb78af85c6cb79bc7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float memory_tree_ns::train_node </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> &amp;&#160;</td>
          <td class="paramname"><em>ec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>cn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00383">383</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00188">memory_tree_ns::memory_tree::alpha</a>, <a class="el" href="example_8h_source.html#l00058">example::l</a>, <a class="el" href="learner_8h_source.html#l00156">LEARNER::learner&lt; T, E &gt;::learn()</a>, <a class="el" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>, <a class="el" href="example_8h_source.html#l00028">polylabel::multi</a>, <a class="el" href="example_8h_source.html#l00049">polyprediction::multiclass</a>, <a class="el" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>, <a class="el" href="example_8h_source.html#l00034">polylabel::multilabels</a>, <a class="el" href="example_8h_source.html#l00050">polyprediction::multilabels</a>, <a class="el" href="memory__tree_8cc_source.html#l00180">memory_tree_ns::memory_tree::nodes</a>, <a class="el" href="memory__tree_8cc_source.html#l00210">memory_tree_ns::memory_tree::oas</a>, <a class="el" href="example_8h_source.html#l00061">example::pred</a>, <a class="el" href="learner_8h_source.html#l00165">LEARNER::learner&lt; T, E &gt;::predict()</a>, <a class="el" href="example_8h_source.html#l00045">polyprediction::scalar</a>, <a class="el" href="example_8h_source.html#l00027">polylabel::simple</a>, and <a class="el" href="example_8h_source.html#l00063">example::weight</a>.</p>
<div class="fragment"><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;{</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">// predict, learn and predict</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">// note: here we first train the router and then predict.</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <a class="code" href="structMULTICLASS_1_1label__t.html">MULTICLASS::label_t</a> <a class="code" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  uint32_t save_multi_pred = 0;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <a class="code" href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a> <a class="code" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <a class="code" href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a> preds;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    mc = ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">multi</a>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    save_multi_pred = ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#abc57dae8f83df4756ff4f8ec910f0fd1">multiclass</a>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    multilabels = ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    preds = ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">multilabels</a>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">simple</a> = {1.f, 1.f, 0.};</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  base.<a class="code" href="structLEARNER_1_1learner.html#a8b4f75763c0ec9a26eb5255780e782a8">predict</a>(ec, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].base_router);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordtype">float</span> prediction = ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#ae29f42559acac5a2b08322a7fe887f04">scalar</a>;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// float imp_weight = 1.f; //no importance weight.</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordtype">float</span> weighted_value =</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      (float)((1. - b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a1c9d530daed57df3ac59e5419f829cdf">alpha</a>) * log(b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nl / (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].nr + 1e-1)) / log(2.) + b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a1c9d530daed57df3ac59e5419f829cdf">alpha</a> * prediction);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordtype">float</span> route_label = weighted_value &lt; 0.f ? -1.f : 1.f;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">// ec.l.simple = {route_label, imp_weight, 0.f};</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordtype">float</span> ec_input_weight = ec.<a class="code" href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">weight</a>;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  ec.<a class="code" href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">weight</a> = 1.f;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">simple</a> = {route_label, 1., 0.f};</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  base.<a class="code" href="structLEARNER_1_1learner.html#a9984332080a6ee4730a5762e9be3a3f6">learn</a>(ec, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].base_router);  <span class="comment">// update the router according to the new example.</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  base.<a class="code" href="structLEARNER_1_1learner.html#a8b4f75763c0ec9a26eb5255780e782a8">predict</a>(ec, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">nodes</a>[cn].base_router);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordtype">float</span> save_binary_scalar = ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#ae29f42559acac5a2b08322a7fe887f04">scalar</a>;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">if</span> (b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">oas</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  {</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">multi</a> = <a class="code" href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">mc</a>;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#abc57dae8f83df4756ff4f8ec910f0fd1">multiclass</a> = save_multi_pred;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  }</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  {</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">multilabels</a> = preds;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a> = <a class="code" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  }</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  ec.<a class="code" href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">weight</a> = ec_input_weight;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordflow">return</span> save_binary_scalar;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;}</div><div class="ttc" id="unionpolyprediction_html_abc57dae8f83df4756ff4f8ec910f0fd1"><div class="ttname"><a href="unionpolyprediction.html#abc57dae8f83df4756ff4f8ec910f0fd1">polyprediction::multiclass</a></div><div class="ttdeci">uint32_t multiclass</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00049">example.h:49</a></div></div>
<div class="ttc" id="structLEARNER_1_1learner_html_a8b4f75763c0ec9a26eb5255780e782a8"><div class="ttname"><a href="structLEARNER_1_1learner.html#a8b4f75763c0ec9a26eb5255780e782a8">LEARNER::learner::predict</a></div><div class="ttdeci">void predict(E &amp;ec, size_t i=0)</div><div class="ttdef"><b>Definition:</b> <a href="learner_8h_source.html#l00165">learner.h:165</a></div></div>
<div class="ttc" id="unionpolyprediction_html_ae29f42559acac5a2b08322a7fe887f04"><div class="ttname"><a href="unionpolyprediction.html#ae29f42559acac5a2b08322a7fe887f04">polyprediction::scalar</a></div><div class="ttdeci">float scalar</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00045">example.h:45</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a1c9d530daed57df3ac59e5419f829cdf"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a1c9d530daed57df3ac59e5419f829cdf">memory_tree_ns::memory_tree::alpha</a></div><div class="ttdeci">float alpha</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00188">memory_tree.cc:188</a></div></div>
<div class="ttc" id="learner_8h_html_a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2"><div class="ttname"><a href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">prediction_type_t::multilabels</a></div></div>
<div class="ttc" id="unionpolylabel_html_a80ff268cb4e29afddaac58174d316297"><div class="ttname"><a href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">polylabel::simple</a></div><div class="ttdeci">label_data simple</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00027">example.h:27</a></div></div>
<div class="ttc" id="unionpolylabel_html_a68946a978546b21fc85fde38d6147399"><div class="ttname"><a href="unionpolylabel.html#a68946a978546b21fc85fde38d6147399">polylabel::multi</a></div><div class="ttdeci">MULTICLASS::label_t multi</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00028">example.h:28</a></div></div>
<div class="ttc" id="structMULTILABEL_1_1labels_html"><div class="ttname"><a href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a></div><div class="ttdef"><b>Definition:</b> <a href="multilabel_8h_source.html#l00012">multilabel.h:12</a></div></div>
<div class="ttc" id="global__data_8h_html_ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567"><div class="ttname"><a href="global__data_8h.html#ac55dd8dc7400242f299d4b6f245f8acdad6fd0924e324f50669ae0295adf59567">label_type_t::mc</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a6f1e18de5dec701d3cbe87ef47204640"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a6f1e18de5dec701d3cbe87ef47204640">memory_tree_ns::memory_tree::nodes</a></div><div class="ttdeci">v_array&lt; node &gt; nodes</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00180">memory_tree.cc:180</a></div></div>
<div class="ttc" id="structexample_html_a0c87f6e82d9c95ae42158bdbdab3acf5"><div class="ttname"><a href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">example::l</a></div><div class="ttdeci">polylabel l</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00058">example.h:58</a></div></div>
<div class="ttc" id="unionpolyprediction_html_a9f6a01eabbe81af8ec89f7af7ff5de3c"><div class="ttname"><a href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">polyprediction::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00050">example.h:50</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_a83fcd57ae88e0cf7551df6a2ea81bb46"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#a83fcd57ae88e0cf7551df6a2ea81bb46">memory_tree_ns::memory_tree::oas</a></div><div class="ttdeci">bool oas</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00210">memory_tree.cc:210</a></div></div>
<div class="ttc" id="unionpolylabel_html_a999dc75a1e71967c36a817cead6bf3b2"><div class="ttname"><a href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">polylabel::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00034">example.h:34</a></div></div>
<div class="ttc" id="structMULTICLASS_1_1label__t_html"><div class="ttname"><a href="structMULTICLASS_1_1label__t.html">MULTICLASS::label_t</a></div><div class="ttdef"><b>Definition:</b> <a href="multiclass_8h_source.html#l00012">multiclass.h:12</a></div></div>
<div class="ttc" id="structexample_html_ad1477e890371ed8253f1953d4190ba49"><div class="ttname"><a href="structexample.html#ad1477e890371ed8253f1953d4190ba49">example::pred</a></div><div class="ttdeci">polyprediction pred</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00061">example.h:61</a></div></div>
<div class="ttc" id="structLEARNER_1_1learner_html_a9984332080a6ee4730a5762e9be3a3f6"><div class="ttname"><a href="structLEARNER_1_1learner.html#a9984332080a6ee4730a5762e9be3a3f6">LEARNER::learner::learn</a></div><div class="ttdeci">void learn(E &amp;ec, size_t i=0)</div><div class="ttdef"><b>Definition:</b> <a href="learner_8h_source.html#l00156">learner.h:156</a></div></div>
<div class="ttc" id="structexample_html_a403be75fc4fdd058e4f7c1baf39be11a"><div class="ttname"><a href="structexample.html#a403be75fc4fdd058e4f7c1baf39be11a">example::weight</a></div><div class="ttdeci">float weight</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00063">example.h:63</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a27aad0e7fea7b74c8efa7961a6fd5a17"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::train_one_against_some_at_leaf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>cn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> &amp;&#160;</td>
          <td class="paramname"><em>ec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00576">576</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00559">collect_labels_from_leaf()</a>, <a class="el" href="example_8h_source.html#l00058">example::l</a>, <a class="el" href="simple__label_8h_source.html#l00012">label_data::label</a>, <a class="el" href="multilabel_8h_source.html#l00014">MULTILABEL::labels::label_v</a>, <a class="el" href="learner_8h_source.html#l00156">LEARNER::learner&lt; T, E &gt;::learn()</a>, <a class="el" href="memory__tree_8cc_source.html#l00186">memory_tree_ns::memory_tree::max_routers</a>, <a class="el" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>, <a class="el" href="example_8h_source.html#l00034">polylabel::multilabels</a>, <a class="el" href="example_8h_source.html#l00050">polyprediction::multilabels</a>, <a class="el" href="example_8h_source.html#l00061">example::pred</a>, <a class="el" href="example_8h_source.html#l00027">polylabel::simple</a>, <a class="el" href="v__array_8h_source.html#l00066">v_array&lt; T &gt;::size()</a>, and <a class="el" href="v__array_8h_source.html#l00244">v_array_contains()</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l00967">insert_example()</a>, <a class="el" href="memory__tree_8cc_source.html#l00739">return_reward_from_node()</a>, and <a class="el" href="memory__tree_8cc_source.html#l00885">single_query_and_learn()</a>.</p>
<div class="fragment"><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;{</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <a class="code" href="structv__array.html">v_array&lt;uint32_t&gt;</a> leaf_labs = v_init&lt;uint32_t&gt;();</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <a class="code" href="namespacememory__tree__ns.html#a5bcd8088fe4370c98134f0171a3bdc4d">collect_labels_from_leaf</a>(b, cn, leaf_labs);  <span class="comment">// unique labels from the leaf.</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <a class="code" href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a> <a class="code" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a> = ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a>;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <a class="code" href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a> preds = ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">multilabels</a>;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">simple</a> = {FLT_MAX, 1.f, 0.f};</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; leaf_labs.<a class="code" href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">size</a>(); i++)</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  {</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">simple</a>.<a class="code" href="structlabel__data.html#a09103f622b965d8c14f0047b53ba7fe1">label</a> = -1.f;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="v__array_8h.html#a37ba1a7ee0f3f63f82e152532b9d3353">v_array_contains</a>(multilabels.<a class="code" href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">label_v</a>, leaf_labs[i]))</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">simple</a>.<a class="code" href="structlabel__data.html#a09103f622b965d8c14f0047b53ba7fe1">label</a> = 1.f;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    base.<a class="code" href="structLEARNER_1_1learner.html#a9984332080a6ee4730a5762e9be3a3f6">learn</a>(ec, b.<a class="code" href="structmemory__tree__ns_1_1memory__tree.html#aee12725de055582f62c270a2d5b4d7b3">max_routers</a> + 1 + leaf_labs[i]);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  }</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  ec.<a class="code" href="structexample.html#ad1477e890371ed8253f1953d4190ba49">pred</a>.<a class="code" href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">multilabels</a> = preds;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  ec.<a class="code" href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">l</a>.<a class="code" href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">multilabels</a> = <a class="code" href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">multilabels</a>;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;}</div><div class="ttc" id="structlabel__data_html_a09103f622b965d8c14f0047b53ba7fe1"><div class="ttname"><a href="structlabel__data.html#a09103f622b965d8c14f0047b53ba7fe1">label_data::label</a></div><div class="ttdeci">float label</div><div class="ttdef"><b>Definition:</b> <a href="simple__label_8h_source.html#l00012">simple_label.h:12</a></div></div>
<div class="ttc" id="learner_8h_html_a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2"><div class="ttname"><a href="learner_8h.html#a5514b4a9448315c23ec344ca2d139e24aaf52dc7962379f4397484a51c3a8c6a2">prediction_type_t::multilabels</a></div></div>
<div class="ttc" id="unionpolylabel_html_a80ff268cb4e29afddaac58174d316297"><div class="ttname"><a href="unionpolylabel.html#a80ff268cb4e29afddaac58174d316297">polylabel::simple</a></div><div class="ttdeci">label_data simple</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00027">example.h:27</a></div></div>
<div class="ttc" id="structMULTILABEL_1_1labels_html"><div class="ttname"><a href="structMULTILABEL_1_1labels.html">MULTILABEL::labels</a></div><div class="ttdef"><b>Definition:</b> <a href="multilabel_8h_source.html#l00012">multilabel.h:12</a></div></div>
<div class="ttc" id="namespacememory__tree__ns_html_a5bcd8088fe4370c98134f0171a3bdc4d"><div class="ttname"><a href="namespacememory__tree__ns.html#a5bcd8088fe4370c98134f0171a3bdc4d">memory_tree_ns::collect_labels_from_leaf</a></div><div class="ttdeci">void collect_labels_from_leaf(memory_tree &amp;b, const uint64_t cn, v_array&lt; uint32_t &gt; &amp;leaf_labs)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00559">memory_tree.cc:559</a></div></div>
<div class="ttc" id="structexample_html_a0c87f6e82d9c95ae42158bdbdab3acf5"><div class="ttname"><a href="structexample.html#a0c87f6e82d9c95ae42158bdbdab3acf5">example::l</a></div><div class="ttdeci">polylabel l</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00058">example.h:58</a></div></div>
<div class="ttc" id="unionpolyprediction_html_a9f6a01eabbe81af8ec89f7af7ff5de3c"><div class="ttname"><a href="unionpolyprediction.html#a9f6a01eabbe81af8ec89f7af7ff5de3c">polyprediction::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00050">example.h:50</a></div></div>
<div class="ttc" id="unionpolylabel_html_a999dc75a1e71967c36a817cead6bf3b2"><div class="ttname"><a href="unionpolylabel.html#a999dc75a1e71967c36a817cead6bf3b2">polylabel::multilabels</a></div><div class="ttdeci">MULTILABEL::labels multilabels</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00034">example.h:34</a></div></div>
<div class="ttc" id="structMULTILABEL_1_1labels_html_ae9b968050adb2459463cffec3b4c38c4"><div class="ttname"><a href="structMULTILABEL_1_1labels.html#ae9b968050adb2459463cffec3b4c38c4">MULTILABEL::labels::label_v</a></div><div class="ttdeci">v_array&lt; uint32_t &gt; label_v</div><div class="ttdef"><b>Definition:</b> <a href="multilabel_8h_source.html#l00014">multilabel.h:14</a></div></div>
<div class="ttc" id="structv__array_html_a903166906624e9e31efe5d1df9bcb092"><div class="ttname"><a href="structv__array.html#a903166906624e9e31efe5d1df9bcb092">v_array::size</a></div><div class="ttdeci">size_t size() const </div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00066">v_array.h:66</a></div></div>
<div class="ttc" id="structexample_html_ad1477e890371ed8253f1953d4190ba49"><div class="ttname"><a href="structexample.html#ad1477e890371ed8253f1953d4190ba49">example::pred</a></div><div class="ttdeci">polyprediction pred</div><div class="ttdef"><b>Definition:</b> <a href="example_8h_source.html#l00061">example.h:61</a></div></div>
<div class="ttc" id="structLEARNER_1_1learner_html_a9984332080a6ee4730a5762e9be3a3f6"><div class="ttname"><a href="structLEARNER_1_1learner.html#a9984332080a6ee4730a5762e9be3a3f6">LEARNER::learner::learn</a></div><div class="ttdeci">void learn(E &amp;ec, size_t i=0)</div><div class="ttdef"><b>Definition:</b> <a href="learner_8h_source.html#l00156">learner.h:156</a></div></div>
<div class="ttc" id="v__array_8h_html_a37ba1a7ee0f3f63f82e152532b9d3353"><div class="ttname"><a href="v__array_8h.html#a37ba1a7ee0f3f63f82e152532b9d3353">v_array_contains</a></div><div class="ttdeci">bool v_array_contains(v_array&lt; T &gt; &amp;A, T x)</div><div class="ttdef"><b>Definition:</b> <a href="v__array_8h_source.html#l00244">v_array.h:244</a></div></div>
<div class="ttc" id="structv__array_html"><div class="ttname"><a href="structv__array.html">v_array&lt; uint32_t &gt;</a></div></div>
<div class="ttc" id="structmemory__tree__ns_1_1memory__tree_html_aee12725de055582f62c270a2d5b4d7b3"><div class="ttname"><a href="structmemory__tree__ns_1_1memory__tree.html#aee12725de055582f62c270a2d5b4d7b3">memory_tree_ns::memory_tree::max_routers</a></div><div class="ttdeci">size_t max_routers</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00186">memory_tree.cc:186</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4ab3b6859145c6e6dd81a902ccd05aad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void memory_tree_ns::update_rew </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tree__ns_1_1memory__tree.html">memory_tree</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceLEARNER.html#a43eb8cec4287b4ad02967d7012bbf0a3">single_learner</a> &amp;&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t &amp;&#160;</td>
          <td class="paramname"><em>ec_array_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structexample.html">example</a> &amp;&#160;</td>
          <td class="paramname"><em>ec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="memory__tree_8cc_source.html#l00960">960</a> of file <a class="el" href="memory__tree_8cc_source.html">memory_tree.cc</a>.</p>

<p>References <a class="el" href="memory__tree_8cc_source.html#l00885">single_query_and_learn()</a>.</p>

<p>Referenced by <a class="el" href="memory__tree_8cc_source.html#l01026">learn()</a>.</p>
<div class="fragment"><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;{</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  <a class="code" href="namespacememory__tree__ns.html#a2765df994178ef7801e1b4b111884f14">single_query_and_learn</a>(b, base, ec_array_index, ec);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;}</div><div class="ttc" id="namespacememory__tree__ns_html_a2765df994178ef7801e1b4b111884f14"><div class="ttname"><a href="namespacememory__tree__ns.html#a2765df994178ef7801e1b4b111884f14">memory_tree_ns::single_query_and_learn</a></div><div class="ttdeci">void single_query_and_learn(memory_tree &amp;b, single_learner &amp;base, const uint32_t &amp;ec_array_index, example &amp;ec)</div><div class="ttdef"><b>Definition:</b> <a href="memory__tree_8cc_source.html#l00885">memory_tree.cc:885</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Mar 27 2020 12:41:15 for Vowpal Wabbit by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
